{
    "type": "bundle",
    "id": "bundle--9ff65b50-91d7-4413-baa9-6605fa82b506",
    "objects": [
        {
            "type": "identity",
            "spec_version": "2.1",
            "id": "identity--a51ee370-82f5-4711-83be-a8c62e990098",
            "created": "2025-10-12T21:57:22.827326Z",
            "modified": "2025-10-12T21:57:22.827326Z",
            "name": "NCSC",
            "description": "National Cyber Security Centre (author/publishing organisation of this report; also credited as the author in embedded YARA meta and referenced in the disclaimer).",
            "identity_class": "organization"
        },
        {
            "type": "marking-definition",
            "spec_version": "2.1",
            "id": "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9",
            "created": "2017-01-20T00:00:00.000Z",
            "definition_type": "tlp",
            "name": "TLP:WHITE",
            "definition": {
                "tlp": "white"
            }
        },
        {
            "type": "ipv4-addr",
            "spec_version": "2.1",
            "id": "ipv4-addr--66428526-535a-56a6-aec4-b24a03bb3980",
            "value": "192.168.6.1"
        },
        {
            "type": "indicator",
            "spec_version": "2.1",
            "id": "indicator--90fe58e1-ec22-4e1b-9348-abb2500cce5d",
            "created": "2025-10-12T21:56:15.223702Z",
            "modified": "2025-10-12T21:56:15.223702Z",
            "name": "Example C2 IPv4 (decrypted ICMP example)",
            "description": "Example IPv4 address extracted from decrypted ICMP packet in the report (used in virtual test environment examples to show how C2 IP and port are conveyed).",
            "pattern": "[ipv4-addr:value = '192.168.6.1']",
            "pattern_type": "stix",
            "pattern_version": "2.1",
            "valid_from": "2025-10-12T21:56:15.223682Z"
        },
        {
            "type": "indicator",
            "spec_version": "2.1",
            "id": "indicator--031ffaa3-5254-433b-8b59-4c526031f3ef",
            "created": "2025-10-12T21:56:15.226876Z",
            "modified": "2025-10-12T21:56:15.226876Z",
            "name": "Indicator for libsophos.so (sample) (MD5)",
            "description": "MD5 hash of the Pygmy Goat libsophos.so sample (malicious shared object).",
            "pattern": "[file:hashes.'MD5' = 'c71cd27efcdb8c44ab8c29d51f033a22']",
            "pattern_type": "stix",
            "pattern_version": "2.1",
            "valid_from": "2025-10-12T21:56:15.226861Z"
        },
        {
            "type": "indicator",
            "spec_version": "2.1",
            "id": "indicator--c1f3d9e3-574f-4243-b343-003d8536c549",
            "created": "2025-10-12T21:56:15.228388Z",
            "modified": "2025-10-12T21:56:15.228388Z",
            "name": "Indicator for libsophos.so (sample) (SHA1)",
            "description": "SHA-1 of the Pygmy Goat libsophos.so sample (malicious shared object).",
            "pattern": "[file:hashes.'SHA1' = '71f70d61af00542b2e9ad64abd2dda7e437536ff']",
            "pattern_type": "stix",
            "pattern_version": "2.1",
            "valid_from": "2025-10-12T21:56:15.228375Z"
        },
        {
            "type": "indicator",
            "spec_version": "2.1",
            "id": "indicator--04b9a989-a421-41db-afd7-445f5eb3c06b",
            "created": "2025-10-12T21:56:15.229661Z",
            "modified": "2025-10-12T21:56:15.229661Z",
            "name": "Indicator for libsophos.so (sample) (SHA256)",
            "description": "SHA-256 of the Pygmy Goat libsophos.so sample (malicious shared object).",
            "pattern": "[file:hashes.'SHA256' = '6455de74ae15071fa98f18cdbc3148c967755e69df7dee747bc31d0387751162']",
            "pattern_type": "stix",
            "pattern_version": "2.1",
            "valid_from": "2025-10-12T21:56:15.22965Z"
        },
        {
            "type": "indicator",
            "spec_version": "2.1",
            "id": "indicator--e83ef68e-3c24-45a6-83f2-0329c1b920be",
            "created": "2025-10-12T21:56:15.230911Z",
            "modified": "2025-10-12T21:56:15.230911Z",
            "name": "Indicator for libsophos.so (earlier variant) (MD5)",
            "description": "MD5 of an earlier variant of libsophos.so (missing reverse proxy functionality, VMProtect-obfuscated).",
            "pattern": "[file:hashes.'MD5' = '3f28196675dc8cb20cf5b5f80ea29310']",
            "pattern_type": "stix",
            "pattern_version": "2.1",
            "valid_from": "2025-10-12T21:56:15.230901Z"
        },
        {
            "type": "indicator",
            "spec_version": "2.1",
            "id": "indicator--5f879b1d-6e05-4878-a358-e8089e028ea3",
            "created": "2025-10-12T21:56:15.232068Z",
            "modified": "2025-10-12T21:56:15.232068Z",
            "name": "Indicator for libsophos.so (earlier variant) (SHA1)",
            "description": "SHA-1 of an earlier variant of libsophos.so (malicious).",
            "pattern": "[file:hashes.'SHA1' = '7ace663c22b3e800fc17c1477d54b533f7002833']",
            "pattern_type": "stix",
            "pattern_version": "2.1",
            "valid_from": "2025-10-12T21:56:15.232057Z"
        },
        {
            "type": "indicator",
            "spec_version": "2.1",
            "id": "indicator--66479db4-339d-4336-8ec6-d33aecb39e61",
            "created": "2025-10-12T21:56:15.233217Z",
            "modified": "2025-10-12T21:56:15.233217Z",
            "name": "Indicator for libsophos.so (earlier variant) (SHA256)",
            "description": "SHA-256 of an earlier variant of libsophos.so (malicious).",
            "pattern": "[file:hashes.'SHA256' = '823b079c75f4e6a5905d9eea9a60c62e1f0995bfc25764d1ba0407a5bd78c962']",
            "pattern_type": "stix",
            "pattern_version": "2.1",
            "valid_from": "2025-10-12T21:56:15.233208Z"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--b9585aaa-164b-44a3-a05c-3d48133229d4",
            "created": "2025-10-12T21:56:15.23449Z",
            "modified": "2025-10-12T21:56:15.23449Z",
            "relationship_type": "derived-from",
            "source_ref": "indicator--031ffaa3-5254-433b-8b59-4c526031f3ef",
            "target_ref": "indicator--c1f3d9e3-574f-4243-b343-003d8536c549"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--0810e246-e8b3-4cbf-853f-ff181dda8ef6",
            "created": "2025-10-12T21:56:15.234911Z",
            "modified": "2025-10-12T21:56:15.234911Z",
            "relationship_type": "derived-from",
            "source_ref": "indicator--031ffaa3-5254-433b-8b59-4c526031f3ef",
            "target_ref": "indicator--04b9a989-a421-41db-afd7-445f5eb3c06b"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--ff4b2928-1afb-48e9-a49f-72da2b20abff",
            "created": "2025-10-12T21:56:15.235239Z",
            "modified": "2025-10-12T21:56:15.235239Z",
            "relationship_type": "derived-from",
            "source_ref": "indicator--c1f3d9e3-574f-4243-b343-003d8536c549",
            "target_ref": "indicator--04b9a989-a421-41db-afd7-445f5eb3c06b"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--fb051299-b1e0-437c-92ce-a0b035a88542",
            "created": "2025-10-12T21:56:15.235573Z",
            "modified": "2025-10-12T21:56:15.235573Z",
            "relationship_type": "derived-from",
            "source_ref": "indicator--e83ef68e-3c24-45a6-83f2-0329c1b920be",
            "target_ref": "indicator--5f879b1d-6e05-4878-a358-e8089e028ea3"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--87c6b92f-437e-4308-a735-c284b6453aa4",
            "created": "2025-10-12T21:56:15.23588Z",
            "modified": "2025-10-12T21:56:15.23588Z",
            "relationship_type": "derived-from",
            "source_ref": "indicator--e83ef68e-3c24-45a6-83f2-0329c1b920be",
            "target_ref": "indicator--66479db4-339d-4336-8ec6-d33aecb39e61"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--39858bb0-396a-48ed-af44-5d54a0f045ad",
            "created": "2025-10-12T21:56:15.236173Z",
            "modified": "2025-10-12T21:56:15.236173Z",
            "relationship_type": "derived-from",
            "source_ref": "indicator--5f879b1d-6e05-4878-a358-e8089e028ea3",
            "target_ref": "indicator--66479db4-339d-4336-8ec6-d33aecb39e61"
        },
        {
            "type": "malware",
            "spec_version": "2.1",
            "id": "malware--513d3a50-f8c6-4558-9bc7-20af50c0870b",
            "created_by_ref": "identity--a51ee370-82f5-4711-83be-a8c62e990098",
            "created": "2025-10-12T21:57:22.827881Z",
            "modified": "2025-10-12T21:57:22.827881Z",
            "name": "pygmy goat",
            "description": "Pygmy Goat is a native x86-32 ELF shared object (libsophos.so) designed as a network device backdoor discovered on Sophos XG firewall devices. It uses LD_PRELOAD to load into /bin/sshd and hook the accept function, and provides multiple on-demand C2 wake mechanisms including listening on a raw ICMP socket for encrypted packets and using a hooked SSH accept to detect magic bytes. It verifies a C2 TLS certificate against a hardcoded Root CA, supports remote shells (/bin/sh and /bin/csh), packet capture via libpcap, creating cron tasks (via an embedded BusyBox), and launching a reverse SOCKS5 proxy implemented by calling embedded EarthWorm code. Samples are distributed as libsophos.so with associated hashes documented in the report.",
            "malware_types": [
                "backdoor",
                "remote-access-trojan"
            ],
            "is_family": true
        },
        {
            "type": "identity",
            "spec_version": "2.1",
            "id": "identity--08fd3498-1037-4696-b078-7150db062bf7",
            "created": "2025-10-12T21:57:22.828309Z",
            "modified": "2025-10-12T21:57:22.828309Z",
            "name": "Mandiant",
            "description": "Industry intelligence vendor referenced in the report for prior reporting on FortiGate-related activity and similar TTPs (used to contextualise similarities such as encrypted ICMP C2 signaling).",
            "identity_class": "organization"
        },
        {
            "type": "identity",
            "spec_version": "2.1",
            "id": "identity--b730fb96-93d6-4ff6-9667-0110f8cfab83",
            "created": "2025-10-12T21:57:22.828563Z",
            "modified": "2025-10-12T21:57:22.828563Z",
            "name": "CrowdStrike",
            "description": "Industry intelligence vendor cited in the report as prior reporting referencing EarthWorm use by adversaries.",
            "identity_class": "organization"
        },
        {
            "type": "identity",
            "spec_version": "2.1",
            "id": "identity--5f46ae50-88e1-4a9b-8b3a-7863ab7421ff",
            "created": "2025-10-12T21:57:22.8288Z",
            "modified": "2025-10-12T21:57:22.8288Z",
            "name": "Fortinet Ltd.",
            "description": "Network device vendor named in the embedded Root CA certificate ('FortiGate, Fortinet Ltd.'), used by the malware as a masqueraded CA name for C2 certificate validation.",
            "identity_class": "organization"
        },
        {
            "type": "identity",
            "spec_version": "2.1",
            "id": "identity--f20de1ec-3738-4df8-aad3-4bba000861d8",
            "created": "2025-10-12T21:57:22.829024Z",
            "modified": "2025-10-12T21:57:22.829024Z",
            "name": "Sophos",
            "description": "Vendor of the affected product family; Pygmy Goat was discovered on Sophos XG firewall devices (the report identifies Sophos XG as the infected device platform).",
            "identity_class": "organization"
        },
        {
            "type": "threat-actor",
            "spec_version": "2.1",
            "id": "threat-actor--ff7f7720-61e3-4dbd-94c6-43e3b4f36ed8",
            "created_by_ref": "identity--a51ee370-82f5-4711-83be-a8c62e990098",
            "created": "2025-10-12T21:57:22.829256Z",
            "modified": "2025-10-12T21:57:22.829256Z",
            "name": "CASTLETAP",
            "description": "Named threat actor referenced in the report whose reported activity against FortiGate devices shares similar TTPs to Pygmy Goat (for example, use of encrypted ICMP packets containing C2 information and reverse SSL connections). CASTLETAP is mentioned to provide contextual similarity; the report suggests overlaps in traffic-signalling and C2 techniques."
        },
        {
            "type": "indicator",
            "spec_version": "2.1",
            "id": "indicator--30eb41fb-ace7-4392-95f1-c35ff78a695c",
            "created_by_ref": "identity--a51ee370-82f5-4711-83be-a8c62e990098",
            "created": "2025-10-12T21:57:22.829627Z",
            "modified": "2025-10-12T21:57:22.829627Z",
            "name": "pygmy_goat_aes_key",
            "description": "YARA rule to detect related activity.",
            "pattern": "rule pygmy_goat_aes_key\n{\n\nmeta:\n\n        author = \"NCSC\"\n        description = \"Pygmy Goat AES key built on the stack or in data\"\n        date = \"2024-11-07\"\n        hash1 = \"71f70d61af00542b2e9ad64abd2dda7e437536ff\"\n\nstrings:\n\n$dword_1 = { 59 4b 6e 77 }\n$dword_2 = { 51 6a 6d 41 }\n$dword_3 = { 54 62 41 6e }\n$dword_4 = { 52 6f 5a 6d }\n$dword_5 = { 30 66 47 37 }\n$dword_6 = { 55 5a 57 62 }\n$dword_7 = { 32 59 55 78 }\n$dword_8 = { 55 51 50 77 }\n\ncondition:\n\n(uint32(0) == 0x464c457f) and filesize < 5MB and all of them\n\n}",
            "pattern_type": "yara",
            "valid_from": "2025-10-12T21:57:22.829606Z"
        },
        {
            "type": "indicator",
            "spec_version": "2.1",
            "id": "indicator--f608a612-5d8f-4f48-baa1-8581a2a396a6",
            "created_by_ref": "identity--a51ee370-82f5-4711-83be-a8c62e990098",
            "created": "2025-10-12T21:57:22.829941Z",
            "modified": "2025-10-12T21:57:22.829941Z",
            "name": "pygmy_goat_magic_strings",
            "description": "YARA rule to detect related activity.",
            "pattern": "rule pygmy_goat_magic_strings\n{\n\nmeta:\n\n        author = \"NCSC\"\n        description = \"Pygmy Goat magic byte sequences used in C2 comms\"\n        date = \"2024-10-22\"\n        hash1 = \"71f70d61af00542b2e9ad64abd2dda7e437536ff\"\n\nstrings:\n\n$c2_magic_handshake = \",bEB3?=o\"\n$fake_ssh_banner = \"SSH-2.0-D8pjE\"\n$fake_ed25519_key = { 29 cc f0 cc 16 c5 46 6e 52 19 82 8e 86\n\n65 42 8c 1f 1a d4 c3 a5 b1 cb fc c0 26 6c 31 3c 5c 90 3a 24 7d e4 d3 57\n6d da 8e cb f4 66 d1 cb 81 4f 63 fd 4a fa 06 e4 7e 4c a0 95 91 bd cb 97\na4 b3 0f }\n\ncondition:\n\n(uint32(0) == 0x464c457f) and any of them\n\n}",
            "pattern_type": "yara",
            "valid_from": "2025-10-12T21:57:22.829935Z"
        },
        {
            "type": "indicator",
            "spec_version": "2.1",
            "id": "indicator--c00bfd62-cdd5-4a13-b277-9b119dee6de0",
            "created_by_ref": "identity--a51ee370-82f5-4711-83be-a8c62e990098",
            "created": "2025-10-12T21:57:22.830234Z",
            "modified": "2025-10-12T21:57:22.830234Z",
            "name": "earthworm_id_generation_x86",
            "description": "YARA rule to detect related activity.",
            "pattern": "rule earthworm_id_generation_x86\n{\n\nmeta:\n\n        author = \"NCSC\"\n        description = \"EarthWorm pool num generation x86 assembly\"\n        date = \"2024-10-22\"\n        hash1 = \"71f70d61af00542b2e9ad64abd2dda7e437536ff\"\n\nstrings:\n\n$chartoi = {\n\n8b 45 ??        // MOV\nc1 e0 07        // SHL\n89 c1           // MOV\n8b 55 ??        // MOV\n8b 45 ??        // MOV\n01 d0           // ADD\n0f b6 00        // MOVZX\n0f be c0        // MOVSX\n01 c8           // ADD\n89 45 ??        // MOV\n83 6d ?? 01     // SUB\n\nEAX,dword ptr [EBP + ??]\nEAX,0x7\nECX,EAX\nEDX,dword ptr [EBP + ??]\nEAX,dword ptr [EBP + ??]\nEAX,EDX\nEAX,byte ptr [EAX]\nEAX,AL\nEAX,ECX\ndword ptr [EBP + ??],EAX\ndword ptr [EBP + ??],0x1\n\n}\n\ncondition:\n\n}\n\n(uint32(0) == 0x464c457f) and all of them",
            "pattern_type": "yara",
            "valid_from": "2025-10-12T21:57:22.830227Z"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--fac6373b-7ee5-4773-a543-2bab23a80028",
            "created_by_ref": "identity--a51ee370-82f5-4711-83be-a8c62e990098",
            "created": "2025-10-12T21:57:22.830543Z",
            "modified": "2025-10-12T21:57:22.830543Z",
            "name": "Dynamic Linker Hijacking",
            "description": "Pygmy Goat uses the LD_PRELOAD environment variable to inject the malicious shared object into the sshd process, replacing the accept function and executing before the legitimate sshd logic.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "persistence"
                }
            ],
            "external_references": [
                {
                    "source_name": "mitre-attack",
                    "url": "https://attack.mitre.org/techniques/T1574/006",
                    "external_id": "T1574.006"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--ea88f51c-32f6-4dc4-8e55-01e3905c8f91",
            "created_by_ref": "identity--a51ee370-82f5-4711-83be-a8c62e990098",
            "created": "2025-10-12T21:57:22.831033Z",
            "modified": "2025-10-12T21:57:22.831033Z",
            "name": "Command and Scripting Interpreter: Unix Shell",
            "description": "Pygmy Goat can spawn interactive remote shells by forking and launching /bin/sh or /bin/csh, relaying I/O over the C2 channel.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "execution"
                }
            ],
            "external_references": [
                {
                    "source_name": "mitre-attack",
                    "url": "https://attack.mitre.org/techniques/T1059/004",
                    "external_id": "T1059.004"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--f4d8b195-b833-4178-b40b-891214088a24",
            "created_by_ref": "identity--a51ee370-82f5-4711-83be-a8c62e990098",
            "created": "2025-10-12T21:57:22.831472Z",
            "modified": "2025-10-12T21:57:22.831472Z",
            "name": "Scheduled Task/Job: Cron",
            "description": "Pygmy Goat can create arbitrary cron tasks using crontab (via a statically embedded BusyBox instance) to achieve persistent or delayed execution of actor tasks.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "execution"
                }
            ],
            "external_references": [
                {
                    "source_name": "mitre-attack",
                    "url": "https://attack.mitre.org/techniques/T1053/003",
                    "external_id": "T1053.003"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--6eafe444-78df-4584-80d0-dbf5923a6581",
            "created_by_ref": "identity--a51ee370-82f5-4711-83be-a8c62e990098",
            "created": "2025-10-12T21:57:22.831888Z",
            "modified": "2025-10-12T21:57:22.831888Z",
            "name": "Inter-Process Communication",
            "description": "Pygmy Goat uses Unix domain sockets (for example /tmp/.sshd.ipc and /tmp/.fgmon_cli.ipc) for communication between parent and forked child processes, enabling delegation of backdoor connections and internal coordination.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "execution"
                }
            ],
            "external_references": [
                {
                    "source_name": "mitre-attack",
                    "url": "https://attack.mitre.org/techniques/T1559",
                    "external_id": "T1559"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--26922eea-8bda-4923-a527-14311f18241e",
            "created_by_ref": "identity--a51ee370-82f5-4711-83be-a8c62e990098",
            "created": "2025-10-12T21:57:22.832306Z",
            "modified": "2025-10-12T21:57:22.832306Z",
            "name": "Network Sniffing",
            "description": "Pygmy Goat uses libpcap to sniff network traffic according to a BPF filter and can exfiltrate captured packets to C2.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "discovery"
                }
            ],
            "external_references": [
                {
                    "source_name": "mitre-attack",
                    "url": "https://attack.mitre.org/techniques/T1040",
                    "external_id": "T1040"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--26346e2f-0e26-464c-ba20-79c56dd411b9",
            "created_by_ref": "identity--a51ee370-82f5-4711-83be-a8c62e990098",
            "created": "2025-10-12T21:57:22.832727Z",
            "modified": "2025-10-12T21:57:22.832727Z",
            "name": "Traffic Signaling: Port Knocking",
            "description": "Pygmy Goat listens on an ICMP raw socket for encrypted packets containing magic bytes and a C2 address/port (an ICMP-based port-knocking mechanism) and uses the decrypted contents to connect back to C2.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "command"
                }
            ],
            "external_references": [
                {
                    "source_name": "mitre-attack",
                    "url": "https://attack.mitre.org/techniques/T1205/001",
                    "external_id": "T1205.001"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--89c15e99-fe0d-4200-a11b-97eed5120945",
            "created_by_ref": "identity--a51ee370-82f5-4711-83be-a8c62e990098",
            "created": "2025-10-12T21:57:22.833132Z",
            "modified": "2025-10-12T21:57:22.833132Z",
            "name": "Data Obfuscation: Protocol Impersonation",
            "description": "Pygmy Goat responds to SSH protocol connections that send specific magic bytes by performing a fake SSH handshake and tunnelling a TLS connection over the fake SSH connection (protocol impersonation to hide C2 traffic).",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "command"
                }
            ],
            "external_references": [
                {
                    "source_name": "mitre-attack",
                    "url": "https://attack.mitre.org/techniques/T1001/003",
                    "external_id": "T1001.003"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--68e73c3d-3e23-445a-b34c-5ce00adad266",
            "created_by_ref": "identity--a51ee370-82f5-4711-83be-a8c62e990098",
            "created": "2025-10-12T21:57:22.833562Z",
            "modified": "2025-10-12T21:57:22.833562Z",
            "name": "Encrypted Channel: Asymmetric Cryptography",
            "description": "Pygmy Goat establishes TLS-encrypted C2 channels and verifies the server certificate against a Root CA certificate embedded in the binary (embedded CA masquerading as FortiGate/Fortinet).",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "command"
                }
            ],
            "external_references": [
                {
                    "source_name": "mitre-attack",
                    "url": "https://attack.mitre.org/techniques/T1573/002",
                    "external_id": "T1573.002"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--861a15fb-96ba-41f9-86e6-cee69cefe74f",
            "created_by_ref": "identity--a51ee370-82f5-4711-83be-a8c62e990098",
            "created": "2025-10-12T21:57:22.83398Z",
            "modified": "2025-10-12T21:57:22.83398Z",
            "name": "Protocol Tunneling",
            "description": "Pygmy Goat can create a reverse SOCKS5 proxy (using embedded EarthWorm code) to tunnel traffic through the compromised device, enabling lateral or external connectivity via the device.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "command"
                }
            ],
            "external_references": [
                {
                    "source_name": "mitre-attack",
                    "url": "https://attack.mitre.org/techniques/T1572",
                    "external_id": "T1572"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--2c38ada1-0f6f-4d74-aa02-eab9d73c76aa",
            "created_by_ref": "identity--a51ee370-82f5-4711-83be-a8c62e990098",
            "created": "2025-10-12T21:57:22.834396Z",
            "modified": "2025-10-12T21:57:22.834396Z",
            "name": "Archive Collected Data: Archive via LZO1X Library",
            "description": "Pygmy Goat compresses C2 communications and payloads using the LZO1X compression library as part of its command and data transport.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "collection"
                }
            ],
            "external_references": [
                {
                    "source_name": "mitre-attack",
                    "url": "https://attack.mitre.org/techniques/T1560/002",
                    "external_id": "T1560.002"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--7c370eb3-2193-4e19-87a3-de0d3e9e35ae",
            "created_by_ref": "identity--a51ee370-82f5-4711-83be-a8c62e990098",
            "created": "2025-10-12T21:57:22.834811Z",
            "modified": "2025-10-12T21:57:22.834811Z",
            "name": "Exfiltration Over C2 Channel",
            "description": "Pygmy Goat exfiltrates data (such as captured packets or command results) over its established TLS C2 channel.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "exfiltration"
                }
            ],
            "external_references": [
                {
                    "source_name": "mitre-attack",
                    "url": "https://attack.mitre.org/techniques/T1041",
                    "external_id": "T1041"
                }
            ]
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--30450289-def1-45ed-acea-f5be77c9da56",
            "created_by_ref": "identity--a51ee370-82f5-4711-83be-a8c62e990098",
            "created": "2025-10-12T21:57:22.835359Z",
            "modified": "2025-10-12T21:57:22.835359Z",
            "relationship_type": "uses",
            "source_ref": "malware--513d3a50-f8c6-4558-9bc7-20af50c0870b",
            "target_ref": "attack-pattern--fac6373b-7ee5-4773-a543-2bab23a80028"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--5156ee07-0e5a-4d7e-9172-9612b976075e",
            "created_by_ref": "identity--a51ee370-82f5-4711-83be-a8c62e990098",
            "created": "2025-10-12T21:57:22.835699Z",
            "modified": "2025-10-12T21:57:22.835699Z",
            "relationship_type": "uses",
            "source_ref": "malware--513d3a50-f8c6-4558-9bc7-20af50c0870b",
            "target_ref": "attack-pattern--ea88f51c-32f6-4dc4-8e55-01e3905c8f91"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--ceeaedf9-334a-45b7-9ac8-bc70ce8f0476",
            "created_by_ref": "identity--a51ee370-82f5-4711-83be-a8c62e990098",
            "created": "2025-10-12T21:57:22.835976Z",
            "modified": "2025-10-12T21:57:22.835976Z",
            "relationship_type": "uses",
            "source_ref": "malware--513d3a50-f8c6-4558-9bc7-20af50c0870b",
            "target_ref": "attack-pattern--f4d8b195-b833-4178-b40b-891214088a24"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--ec48557f-e9bd-438f-bb1a-45f0cf304316",
            "created_by_ref": "identity--a51ee370-82f5-4711-83be-a8c62e990098",
            "created": "2025-10-12T21:57:22.836243Z",
            "modified": "2025-10-12T21:57:22.836243Z",
            "relationship_type": "uses",
            "source_ref": "malware--513d3a50-f8c6-4558-9bc7-20af50c0870b",
            "target_ref": "attack-pattern--6eafe444-78df-4584-80d0-dbf5923a6581"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--8a0a5e65-f864-4d25-8671-35d114283b4a",
            "created_by_ref": "identity--a51ee370-82f5-4711-83be-a8c62e990098",
            "created": "2025-10-12T21:57:22.836523Z",
            "modified": "2025-10-12T21:57:22.836523Z",
            "relationship_type": "uses",
            "source_ref": "malware--513d3a50-f8c6-4558-9bc7-20af50c0870b",
            "target_ref": "attack-pattern--26922eea-8bda-4923-a527-14311f18241e"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--e20dc4e0-3f7a-4634-bc10-3a9c31d90284",
            "created_by_ref": "identity--a51ee370-82f5-4711-83be-a8c62e990098",
            "created": "2025-10-12T21:57:22.836795Z",
            "modified": "2025-10-12T21:57:22.836795Z",
            "relationship_type": "uses",
            "source_ref": "malware--513d3a50-f8c6-4558-9bc7-20af50c0870b",
            "target_ref": "attack-pattern--26346e2f-0e26-464c-ba20-79c56dd411b9"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--63acc061-2234-4e0f-82d6-3161b41987cc",
            "created_by_ref": "identity--a51ee370-82f5-4711-83be-a8c62e990098",
            "created": "2025-10-12T21:57:22.837055Z",
            "modified": "2025-10-12T21:57:22.837055Z",
            "relationship_type": "uses",
            "source_ref": "malware--513d3a50-f8c6-4558-9bc7-20af50c0870b",
            "target_ref": "attack-pattern--89c15e99-fe0d-4200-a11b-97eed5120945"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--13b3f14f-fa57-42be-9cd5-d7f43b5a4c39",
            "created_by_ref": "identity--a51ee370-82f5-4711-83be-a8c62e990098",
            "created": "2025-10-12T21:57:22.837339Z",
            "modified": "2025-10-12T21:57:22.837339Z",
            "relationship_type": "uses",
            "source_ref": "malware--513d3a50-f8c6-4558-9bc7-20af50c0870b",
            "target_ref": "attack-pattern--68e73c3d-3e23-445a-b34c-5ce00adad266"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--14b8178a-f7d3-4ed3-8dd0-5b2ca45eb129",
            "created_by_ref": "identity--a51ee370-82f5-4711-83be-a8c62e990098",
            "created": "2025-10-12T21:57:22.837602Z",
            "modified": "2025-10-12T21:57:22.837602Z",
            "relationship_type": "uses",
            "source_ref": "malware--513d3a50-f8c6-4558-9bc7-20af50c0870b",
            "target_ref": "attack-pattern--861a15fb-96ba-41f9-86e6-cee69cefe74f"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--70e01985-3b2a-48cb-b22b-c3135fb0a7a1",
            "created_by_ref": "identity--a51ee370-82f5-4711-83be-a8c62e990098",
            "created": "2025-10-12T21:57:22.837881Z",
            "modified": "2025-10-12T21:57:22.837881Z",
            "relationship_type": "uses",
            "source_ref": "malware--513d3a50-f8c6-4558-9bc7-20af50c0870b",
            "target_ref": "attack-pattern--2c38ada1-0f6f-4d74-aa02-eab9d73c76aa"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--06ec85c3-e3e8-44dc-ad1b-7de60e654e2f",
            "created_by_ref": "identity--a51ee370-82f5-4711-83be-a8c62e990098",
            "created": "2025-10-12T21:57:22.838144Z",
            "modified": "2025-10-12T21:57:22.838144Z",
            "relationship_type": "uses",
            "source_ref": "malware--513d3a50-f8c6-4558-9bc7-20af50c0870b",
            "target_ref": "attack-pattern--7c370eb3-2193-4e19-87a3-de0d3e9e35ae"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--8c2e7947-a06a-48ad-a06b-120e6a8245e4",
            "created_by_ref": "identity--a51ee370-82f5-4711-83be-a8c62e990098",
            "created": "2025-10-12T21:57:22.838426Z",
            "modified": "2025-10-12T21:57:22.838426Z",
            "relationship_type": "indicates",
            "source_ref": "indicator--90fe58e1-ec22-4e1b-9348-abb2500cce5d",
            "target_ref": "malware--513d3a50-f8c6-4558-9bc7-20af50c0870b"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--12f4f9b4-9106-4873-93a2-2049bb92e80b",
            "created_by_ref": "identity--a51ee370-82f5-4711-83be-a8c62e990098",
            "created": "2025-10-12T21:57:22.838692Z",
            "modified": "2025-10-12T21:57:22.838692Z",
            "relationship_type": "indicates",
            "source_ref": "indicator--031ffaa3-5254-433b-8b59-4c526031f3ef",
            "target_ref": "malware--513d3a50-f8c6-4558-9bc7-20af50c0870b"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--d4c39ad3-af2a-4ff8-a924-5476995f0b39",
            "created_by_ref": "identity--a51ee370-82f5-4711-83be-a8c62e990098",
            "created": "2025-10-12T21:57:22.83895Z",
            "modified": "2025-10-12T21:57:22.83895Z",
            "relationship_type": "indicates",
            "source_ref": "indicator--c1f3d9e3-574f-4243-b343-003d8536c549",
            "target_ref": "malware--513d3a50-f8c6-4558-9bc7-20af50c0870b"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--a8568f79-cc86-4970-bfd3-2cf216f8fb90",
            "created_by_ref": "identity--a51ee370-82f5-4711-83be-a8c62e990098",
            "created": "2025-10-12T21:57:22.839205Z",
            "modified": "2025-10-12T21:57:22.839205Z",
            "relationship_type": "indicates",
            "source_ref": "indicator--04b9a989-a421-41db-afd7-445f5eb3c06b",
            "target_ref": "malware--513d3a50-f8c6-4558-9bc7-20af50c0870b"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--a9da86b0-d127-4230-9d9f-fb1545dd80a9",
            "created_by_ref": "identity--a51ee370-82f5-4711-83be-a8c62e990098",
            "created": "2025-10-12T21:57:22.839479Z",
            "modified": "2025-10-12T21:57:22.839479Z",
            "relationship_type": "indicates",
            "source_ref": "indicator--e83ef68e-3c24-45a6-83f2-0329c1b920be",
            "target_ref": "malware--513d3a50-f8c6-4558-9bc7-20af50c0870b"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--828e1a93-7a75-46c2-977f-a47796173554",
            "created_by_ref": "identity--a51ee370-82f5-4711-83be-a8c62e990098",
            "created": "2025-10-12T21:57:22.839792Z",
            "modified": "2025-10-12T21:57:22.839792Z",
            "relationship_type": "indicates",
            "source_ref": "indicator--5f879b1d-6e05-4878-a358-e8089e028ea3",
            "target_ref": "malware--513d3a50-f8c6-4558-9bc7-20af50c0870b"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--56b31210-c1c4-42ec-a2eb-8642ccd63cd9",
            "created_by_ref": "identity--a51ee370-82f5-4711-83be-a8c62e990098",
            "created": "2025-10-12T21:57:22.840054Z",
            "modified": "2025-10-12T21:57:22.840054Z",
            "relationship_type": "indicates",
            "source_ref": "indicator--66479db4-339d-4336-8ec6-d33aecb39e61",
            "target_ref": "malware--513d3a50-f8c6-4558-9bc7-20af50c0870b"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--b87f7422-742d-4575-8611-856212477cd8",
            "created_by_ref": "identity--a51ee370-82f5-4711-83be-a8c62e990098",
            "created": "2025-10-12T21:57:22.840552Z",
            "modified": "2025-10-12T21:57:22.840552Z",
            "relationship_type": "indicates",
            "source_ref": "indicator--30eb41fb-ace7-4392-95f1-c35ff78a695c",
            "target_ref": "malware--513d3a50-f8c6-4558-9bc7-20af50c0870b"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--a8dd876c-8616-4699-958b-c7340d833e9a",
            "created_by_ref": "identity--a51ee370-82f5-4711-83be-a8c62e990098",
            "created": "2025-10-12T21:57:22.840874Z",
            "modified": "2025-10-12T21:57:22.840874Z",
            "relationship_type": "derived-from",
            "source_ref": "indicator--30eb41fb-ace7-4392-95f1-c35ff78a695c",
            "target_ref": "indicator--c1f3d9e3-574f-4243-b343-003d8536c549"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--e310622d-2491-4d08-bfa2-a320b2d75383",
            "created_by_ref": "identity--a51ee370-82f5-4711-83be-a8c62e990098",
            "created": "2025-10-12T21:57:22.841179Z",
            "modified": "2025-10-12T21:57:22.841179Z",
            "relationship_type": "indicates",
            "source_ref": "indicator--f608a612-5d8f-4f48-baa1-8581a2a396a6",
            "target_ref": "malware--513d3a50-f8c6-4558-9bc7-20af50c0870b"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--76db8b98-a234-46b7-a783-cb62c6678a16",
            "created_by_ref": "identity--a51ee370-82f5-4711-83be-a8c62e990098",
            "created": "2025-10-12T21:57:22.841473Z",
            "modified": "2025-10-12T21:57:22.841473Z",
            "relationship_type": "derived-from",
            "source_ref": "indicator--f608a612-5d8f-4f48-baa1-8581a2a396a6",
            "target_ref": "indicator--c1f3d9e3-574f-4243-b343-003d8536c549"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--a3fdd697-c9c8-47f4-b438-ccae0d784142",
            "created_by_ref": "identity--a51ee370-82f5-4711-83be-a8c62e990098",
            "created": "2025-10-12T21:57:22.841774Z",
            "modified": "2025-10-12T21:57:22.841774Z",
            "relationship_type": "indicates",
            "source_ref": "indicator--c00bfd62-cdd5-4a13-b277-9b119dee6de0",
            "target_ref": "malware--513d3a50-f8c6-4558-9bc7-20af50c0870b"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--66049c74-1dc7-4b7e-844c-b7d0a4dc5f24",
            "created_by_ref": "identity--a51ee370-82f5-4711-83be-a8c62e990098",
            "created": "2025-10-12T21:57:22.842045Z",
            "modified": "2025-10-12T21:57:22.842045Z",
            "relationship_type": "derived-from",
            "source_ref": "indicator--c00bfd62-cdd5-4a13-b277-9b119dee6de0",
            "target_ref": "indicator--c1f3d9e3-574f-4243-b343-003d8536c549"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--715a507e-1f14-47a8-84e2-37eb7d28f624",
            "created_by_ref": "identity--a51ee370-82f5-4711-83be-a8c62e990098",
            "created": "2025-10-12T21:57:22.842497Z",
            "modified": "2025-10-12T21:57:22.842497Z",
            "relationship_type": "uses",
            "source_ref": "threat-actor--ff7f7720-61e3-4dbd-94c6-43e3b4f36ed8",
            "target_ref": "malware--513d3a50-f8c6-4558-9bc7-20af50c0870b"
        },
        {
            "type": "report",
            "spec_version": "2.1",
            "id": "report--65bc9ebc-881a-4138-afe0-18b67fb55bca",
            "created_by_ref": "identity--a51ee370-82f5-4711-83be-a8c62e990098",
            "created": "2025-10-12T21:57:22.842957Z",
            "modified": "2025-10-12T21:57:22.842957Z",
            "name": "Analisi Malware: Pygmy Goat",
            "description": "This report contains technical analysis and indicators associated with malware. pygmy goat.",
            "report_types": [
                "threat-report"
            ],
            "published": "2025-10-12T21:57:22.842943Z",
            "object_refs": [
                "identity--a51ee370-82f5-4711-83be-a8c62e990098",
                "ipv4-addr--66428526-535a-56a6-aec4-b24a03bb3980",
                "indicator--90fe58e1-ec22-4e1b-9348-abb2500cce5d",
                "indicator--031ffaa3-5254-433b-8b59-4c526031f3ef",
                "indicator--c1f3d9e3-574f-4243-b343-003d8536c549",
                "indicator--04b9a989-a421-41db-afd7-445f5eb3c06b",
                "indicator--e83ef68e-3c24-45a6-83f2-0329c1b920be",
                "indicator--5f879b1d-6e05-4878-a358-e8089e028ea3",
                "indicator--66479db4-339d-4336-8ec6-d33aecb39e61",
                "relationship--b9585aaa-164b-44a3-a05c-3d48133229d4",
                "relationship--0810e246-e8b3-4cbf-853f-ff181dda8ef6",
                "relationship--ff4b2928-1afb-48e9-a49f-72da2b20abff",
                "relationship--fb051299-b1e0-437c-92ce-a0b035a88542",
                "relationship--87c6b92f-437e-4308-a735-c284b6453aa4",
                "relationship--39858bb0-396a-48ed-af44-5d54a0f045ad",
                "malware--513d3a50-f8c6-4558-9bc7-20af50c0870b",
                "identity--08fd3498-1037-4696-b078-7150db062bf7",
                "identity--b730fb96-93d6-4ff6-9667-0110f8cfab83",
                "identity--5f46ae50-88e1-4a9b-8b3a-7863ab7421ff",
                "identity--f20de1ec-3738-4df8-aad3-4bba000861d8",
                "threat-actor--ff7f7720-61e3-4dbd-94c6-43e3b4f36ed8",
                "indicator--30eb41fb-ace7-4392-95f1-c35ff78a695c",
                "indicator--f608a612-5d8f-4f48-baa1-8581a2a396a6",
                "indicator--c00bfd62-cdd5-4a13-b277-9b119dee6de0",
                "attack-pattern--fac6373b-7ee5-4773-a543-2bab23a80028",
                "attack-pattern--ea88f51c-32f6-4dc4-8e55-01e3905c8f91",
                "attack-pattern--f4d8b195-b833-4178-b40b-891214088a24",
                "attack-pattern--6eafe444-78df-4584-80d0-dbf5923a6581",
                "attack-pattern--26922eea-8bda-4923-a527-14311f18241e",
                "attack-pattern--26346e2f-0e26-464c-ba20-79c56dd411b9",
                "attack-pattern--89c15e99-fe0d-4200-a11b-97eed5120945",
                "attack-pattern--68e73c3d-3e23-445a-b34c-5ce00adad266",
                "attack-pattern--861a15fb-96ba-41f9-86e6-cee69cefe74f",
                "attack-pattern--2c38ada1-0f6f-4d74-aa02-eab9d73c76aa",
                "attack-pattern--7c370eb3-2193-4e19-87a3-de0d3e9e35ae",
                "relationship--30450289-def1-45ed-acea-f5be77c9da56",
                "relationship--5156ee07-0e5a-4d7e-9172-9612b976075e",
                "relationship--ceeaedf9-334a-45b7-9ac8-bc70ce8f0476",
                "relationship--ec48557f-e9bd-438f-bb1a-45f0cf304316",
                "relationship--8a0a5e65-f864-4d25-8671-35d114283b4a",
                "relationship--e20dc4e0-3f7a-4634-bc10-3a9c31d90284",
                "relationship--63acc061-2234-4e0f-82d6-3161b41987cc",
                "relationship--13b3f14f-fa57-42be-9cd5-d7f43b5a4c39",
                "relationship--14b8178a-f7d3-4ed3-8dd0-5b2ca45eb129",
                "relationship--70e01985-3b2a-48cb-b22b-c3135fb0a7a1",
                "relationship--06ec85c3-e3e8-44dc-ad1b-7de60e654e2f",
                "relationship--8c2e7947-a06a-48ad-a06b-120e6a8245e4",
                "relationship--12f4f9b4-9106-4873-93a2-2049bb92e80b",
                "relationship--d4c39ad3-af2a-4ff8-a924-5476995f0b39",
                "relationship--a8568f79-cc86-4970-bfd3-2cf216f8fb90",
                "relationship--a9da86b0-d127-4230-9d9f-fb1545dd80a9",
                "relationship--828e1a93-7a75-46c2-977f-a47796173554",
                "relationship--56b31210-c1c4-42ec-a2eb-8642ccd63cd9",
                "relationship--b87f7422-742d-4575-8611-856212477cd8",
                "relationship--a8dd876c-8616-4699-958b-c7340d833e9a",
                "relationship--e310622d-2491-4d08-bfa2-a320b2d75383",
                "relationship--76db8b98-a234-46b7-a783-cb62c6678a16",
                "relationship--a3fdd697-c9c8-47f4-b438-ccae0d784142",
                "relationship--66049c74-1dc7-4b7e-844c-b7d0a4dc5f24",
                "relationship--715a507e-1f14-47a8-84e2-37eb7d28f624"
            ],
            "object_marking_refs": [
                "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
            ]
        }
    ]
}