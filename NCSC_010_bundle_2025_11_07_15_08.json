{
    "type": "bundle",
    "id": "bundle--c5f546fd-bfa3-48ac-9cd2-157e846ae933",
    "objects": [
        {
            "type": "identity",
            "spec_version": "2.1",
            "id": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:32.991695Z",
            "modified": "2025-11-07T15:08:32.991695Z",
            "name": "NCSC",
            "description": "Author and publisher of the report; provided malware analysis, ATT&CK mapping, indicators, and detection rules (YARA and SIGMA).",
            "identity_class": "organization"
        },
        {
            "type": "marking-definition",
            "spec_version": "2.1",
            "id": "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9",
            "created": "2017-01-20T00:00:00.000Z",
            "definition_type": "tlp",
            "name": "TLP:WHITE",
            "definition": {
                "tlp": "white"
            }
        },
        {
            "type": "domain-name",
            "spec_version": "2.1",
            "id": "domain-name--649eaf78-676f-52fe-a165-911319aceda0",
            "value": "cdn181.awsdns-531.com"
        },
        {
            "type": "mutex",
            "spec_version": "2.1",
            "id": "mutex--ba1a71b9-af46-5543-968f-3e18936c35f1",
            "name": "Global\\gup0"
        },
        {
            "type": "directory",
            "spec_version": "2.1",
            "id": "directory--45f7959e-0963-5fca-9127-a9724ff3a0b6",
            "path": "C:\\ProgramData\\Microsoft\\DRM\\"
        },
        {
            "type": "windows-registry-key",
            "spec_version": "2.1",
            "id": "windows-registry-key--863cdf7c-8790-50c9-8a9f-78361d359e13",
            "key": "HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\SearchIndexer"
        },
        {
            "type": "windows-registry-key",
            "spec_version": "2.1",
            "id": "windows-registry-key--5badc5a7-25c4-54d7-b7ec-b27a730ed473",
            "key": "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\SearchIndexer"
        },
        {
            "type": "indicator",
            "spec_version": "2.1",
            "id": "indicator--f2e48931-9bb0-4a83-8bdd-8ccdabdba7d1",
            "created": "2025-11-07T15:01:16.601191Z",
            "modified": "2025-11-07T15:01:16.601191Z",
            "name": "SparrowDoor C2 domain",
            "description": "Configured Command and Control (C2) domain used by SparrowDoor over HTTPS.",
            "pattern": "[domain-name:value = 'cdn181.awsdns-531.com']",
            "pattern_type": "stix",
            "pattern_version": "2.1",
            "valid_from": "2025-11-07T15:01:16.601171Z"
        },
        {
            "type": "indicator",
            "spec_version": "2.1",
            "id": "indicator--d726a4ec-4305-475f-a35d-2dcc05c5890a",
            "created": "2025-11-07T15:01:16.606297Z",
            "modified": "2025-11-07T15:01:16.606297Z",
            "name": "SparrowDoor instance mutex",
            "description": "Mutex created by SparrowDoor to ensure only a single instance runs on a host.",
            "pattern": "[mutex:name = 'Global\\\\gup0']",
            "pattern_type": "stix",
            "pattern_version": "2.1",
            "valid_from": "2025-11-07T15:01:16.606282Z"
        },
        {
            "type": "indicator",
            "spec_version": "2.1",
            "id": "indicator--66534358-7500-4919-8f95-dd8eac4bbc5b",
            "created": "2025-11-07T15:01:16.607579Z",
            "modified": "2025-11-07T15:01:16.607579Z",
            "name": "Malware storage directory",
            "description": "Directory on the victim host where SparrowDoor components were recovered/installed.",
            "pattern": "[directory:path = 'C:\\\\ProgramData\\\\Microsoft\\\\DRM\\\\']",
            "pattern_type": "stix",
            "pattern_version": "2.1",
            "valid_from": "2025-11-07T15:01:16.60757Z"
        },
        {
            "type": "indicator",
            "spec_version": "2.1",
            "id": "indicator--5e867143-f1f9-4520-9eeb-fbbb4a827fef",
            "created": "2025-11-07T15:01:16.608434Z",
            "modified": "2025-11-07T15:01:16.608434Z",
            "name": "SearchIndexer.exe (renamed Notepad++ updater) used to side-load SparrowDoor",
            "description": "Signed Notepad++ updater (GUP.exe) renamed and used to load SparrowDoor as a Windows service.",
            "pattern": "[file:name = 'SearchIndexer.exe' AND file:parent_directory_ref.path LIKE 'C:\\\\ProgramData\\\\Microsoft\\\\DRM']",
            "pattern_type": "stix",
            "pattern_version": "2.1",
            "valid_from": "2025-11-07T15:01:16.608425Z"
        },
        {
            "type": "indicator",
            "spec_version": "2.1",
            "id": "indicator--f7eead85-3478-4cab-bf78-4a59371e568b",
            "created": "2025-11-07T15:01:16.609703Z",
            "modified": "2025-11-07T15:01:16.609703Z",
            "name": "SparrowDoor loader DLL",
            "description": "Malicious loader (named like the legitimate libcurl) side-loaded by SearchIndexer.exe.",
            "pattern": "[file:name = 'libcurl.dll' AND file:parent_directory_ref.path LIKE 'C:\\\\ProgramData\\\\Microsoft\\\\DRM']",
            "pattern_type": "stix",
            "pattern_version": "2.1",
            "valid_from": "2025-11-07T15:01:16.609687Z"
        },
        {
            "type": "indicator",
            "spec_version": "2.1",
            "id": "indicator--0000edc3-cfb2-4629-8b9d-98141cbb24dd",
            "created": "2025-11-07T15:01:16.610791Z",
            "modified": "2025-11-07T15:01:16.610791Z",
            "name": "SparrowDoor backdoor payload container",
            "description": "Obfuscated file containing loader configuration, shellcode, and SparrowDoor backdoor sections.",
            "pattern": "[file:name = 'libhost.dll' AND file:parent_directory_ref.path LIKE 'C:\\\\ProgramData\\\\Microsoft\\\\DRM']",
            "pattern_type": "stix",
            "pattern_version": "2.1",
            "valid_from": "2025-11-07T15:01:16.610782Z"
        },
        {
            "type": "indicator",
            "spec_version": "2.1",
            "id": "indicator--b03d9673-242e-459e-a43d-24a198f25895",
            "created": "2025-11-07T15:01:16.611849Z",
            "modified": "2025-11-07T15:01:16.611849Z",
            "name": "Clipboard logging output file",
            "description": "Log file created by SparrowDoor's clipshot feature, stored alongside libcurl.dll.",
            "pattern": "[file:name = 'libcurl.dll.log' AND file:parent_directory_ref.path LIKE 'C:\\\\ProgramData\\\\Microsoft\\\\DRM']",
            "pattern_type": "stix",
            "pattern_version": "2.1",
            "valid_from": "2025-11-07T15:01:16.611841Z"
        },
        {
            "type": "indicator",
            "spec_version": "2.1",
            "id": "indicator--caf91906-8e03-4964-8f73-3e5253967abb",
            "created": "2025-11-07T15:01:16.613534Z",
            "modified": "2025-11-07T15:01:16.613534Z",
            "name": "Service persistence key",
            "description": "Primary persistence mechanism; malware registers a Windows service under this key.",
            "pattern": "[windows-registry-key:key = 'HKEY_LOCAL_MACHINE\\\\SYSTEM\\\\CurrentControlSet\\\\services\\\\SearchIndexer']",
            "pattern_type": "stix",
            "pattern_version": "2.1",
            "valid_from": "2025-11-07T15:01:16.613525Z"
        },
        {
            "type": "indicator",
            "spec_version": "2.1",
            "id": "indicator--fbb1e016-6ae9-413b-96ef-5208ae15a76f",
            "created": "2025-11-07T15:01:16.615573Z",
            "modified": "2025-11-07T15:01:16.615573Z",
            "name": "Run key persistence value",
            "description": "Backup persistence mechanism; autoruns SearchIndexer.exe from this key.",
            "pattern": "[windows-registry-key:key = 'HKEY_CURRENT_USER\\\\Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\\\\SearchIndexer']",
            "pattern_type": "stix",
            "pattern_version": "2.1",
            "valid_from": "2025-11-07T15:01:16.615563Z"
        },
        {
            "type": "indicator",
            "spec_version": "2.1",
            "id": "indicator--2bac0400-3625-4a55-8e7f-445870e5dd84",
            "created": "2025-11-07T15:01:16.616444Z",
            "modified": "2025-11-07T15:01:16.616444Z",
            "name": "Indicator for libcurl.dll (SparrowDoor loader) (MD5)",
            "description": "MD5 hash of the SparrowDoor loader DLL used in this campaign.",
            "pattern": "[file:hashes.'MD5' = '46077a32e433a56eb8ba64dcbf86bc60']",
            "pattern_type": "stix",
            "pattern_version": "2.1",
            "valid_from": "2025-11-07T15:01:16.616436Z"
        },
        {
            "type": "indicator",
            "spec_version": "2.1",
            "id": "indicator--f75ecb87-fa41-4eaa-8232-3b57c7f26f5d",
            "created": "2025-11-07T15:01:16.617399Z",
            "modified": "2025-11-07T15:01:16.617399Z",
            "name": "Indicator for libcurl.dll (SparrowDoor loader) (SHA1)",
            "description": "SHA-1 hash of the SparrowDoor loader DLL used in this campaign.",
            "pattern": "[file:hashes.'SHA1' = '989b3798841d06e286eb083132242749c80fdd4d']",
            "pattern_type": "stix",
            "pattern_version": "2.1",
            "valid_from": "2025-11-07T15:01:16.61739Z"
        },
        {
            "type": "indicator",
            "spec_version": "2.1",
            "id": "indicator--50698359-0cdf-4edd-8271-9914ecc87f67",
            "created": "2025-11-07T15:01:16.61832Z",
            "modified": "2025-11-07T15:01:16.61832Z",
            "name": "Indicator for libcurl.dll (SparrowDoor loader) (SHA256)",
            "description": "SHA-256 hash of the SparrowDoor loader DLL used in this campaign.",
            "pattern": "[file:hashes.'SHA256' = 'f19bb3b49d548bce4d35e9cf83fba112ef8e087a422b86d1376a395466fdff2d']",
            "pattern_type": "stix",
            "pattern_version": "2.1",
            "valid_from": "2025-11-07T15:01:16.618311Z"
        },
        {
            "type": "indicator",
            "spec_version": "2.1",
            "id": "indicator--3abb6330-a65f-4f71-955a-76d82c649e62",
            "created": "2025-11-07T15:01:16.619167Z",
            "modified": "2025-11-07T15:01:16.619167Z",
            "name": "Indicator for libhost.dll (SparrowDoor backdoor and shellcode) (MD5)",
            "description": "MD5 hash of the obfuscated SparrowDoor backdoor container.",
            "pattern": "[file:hashes.'MD5' = '8ad3f513f48f711d573d33b7419e3ed5']",
            "pattern_type": "stix",
            "pattern_version": "2.1",
            "valid_from": "2025-11-07T15:01:16.619159Z"
        },
        {
            "type": "indicator",
            "spec_version": "2.1",
            "id": "indicator--97a76ff1-5105-4e30-b646-1dd465d7c0e5",
            "created": "2025-11-07T15:01:16.619967Z",
            "modified": "2025-11-07T15:01:16.619967Z",
            "name": "Indicator for libhost.dll (SparrowDoor backdoor and shellcode) (SHA1)",
            "description": "SHA-1 hash of the obfuscated SparrowDoor backdoor container.",
            "pattern": "[file:hashes.'SHA1' = 'c1890a6447c991880467b86a013dbeaa66cc615f']",
            "pattern_type": "stix",
            "pattern_version": "2.1",
            "valid_from": "2025-11-07T15:01:16.619958Z"
        },
        {
            "type": "indicator",
            "spec_version": "2.1",
            "id": "indicator--6194f3b2-3066-41b3-9bdb-a132c36d1a03",
            "created": "2025-11-07T15:01:16.620762Z",
            "modified": "2025-11-07T15:01:16.620762Z",
            "name": "Indicator for libhost.dll (SparrowDoor backdoor and shellcode) (SHA256)",
            "description": "SHA-256 hash of the obfuscated SparrowDoor backdoor container.",
            "pattern": "[file:hashes.'SHA256' = 'e0b107be8034976f6e91cfcc2bbc792b49ea61a071166968fec775af28b1f19c']",
            "pattern_type": "stix",
            "pattern_version": "2.1",
            "valid_from": "2025-11-07T15:01:16.620752Z"
        },
        {
            "type": "indicator",
            "spec_version": "2.1",
            "id": "indicator--46cea1f3-aaba-4244-adcd-8038606372eb",
            "created": "2025-11-07T15:01:16.621562Z",
            "modified": "2025-11-07T15:01:16.621562Z",
            "name": "Indicator for SearchIndexer.exe (renamed Notepad++ updater GUP.exe) (MD5)",
            "description": "MD5 hash of the legitimate Notepad++ updater renamed and used to side-load SparrowDoor.",
            "pattern": "[file:hashes.'MD5' = '5f983177f3f9ce6cb72088f3da96435d']",
            "pattern_type": "stix",
            "pattern_version": "2.1",
            "valid_from": "2025-11-07T15:01:16.621554Z"
        },
        {
            "type": "indicator",
            "spec_version": "2.1",
            "id": "indicator--4e338b49-be37-40f7-8512-8fe25cf20555",
            "created": "2025-11-07T15:01:16.622653Z",
            "modified": "2025-11-07T15:01:16.622653Z",
            "name": "Indicator for SearchIndexer.exe (renamed Notepad++ updater GUP.exe) (SHA1)",
            "description": "SHA-1 hash of the legitimate Notepad++ updater renamed and used to side-load SparrowDoor.",
            "pattern": "[file:hashes.'SHA1' = '1bb8f3f8c67199c36b26115442930d0108dc8e6a']",
            "pattern_type": "stix",
            "pattern_version": "2.1",
            "valid_from": "2025-11-07T15:01:16.622645Z"
        },
        {
            "type": "indicator",
            "spec_version": "2.1",
            "id": "indicator--e72a8160-29b4-4f63-ba6f-fc17dec303b8",
            "created": "2025-11-07T15:01:16.623449Z",
            "modified": "2025-11-07T15:01:16.623449Z",
            "name": "Indicator for SearchIndexer.exe (renamed Notepad++ updater GUP.exe) (SHA256)",
            "description": "SHA-256 hash of the legitimate Notepad++ updater renamed and used to side-load SparrowDoor.",
            "pattern": "[file:hashes.'SHA256' = '9863ac60b92fad160ce88353760c7c4f21f8e9c3190b18b374bdbca3a7d1a3fb']",
            "pattern_type": "stix",
            "pattern_version": "2.1",
            "valid_from": "2025-11-07T15:01:16.62344Z"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--766dd9d3-57db-4eda-bd48-46387ec9e576",
            "created": "2025-11-07T15:01:16.6243Z",
            "modified": "2025-11-07T15:01:16.6243Z",
            "relationship_type": "derived-from",
            "source_ref": "indicator--2bac0400-3625-4a55-8e7f-445870e5dd84",
            "target_ref": "indicator--f75ecb87-fa41-4eaa-8232-3b57c7f26f5d"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--cb5a59bf-701c-4eeb-bae7-f07ea6e221b1",
            "created": "2025-11-07T15:01:16.624612Z",
            "modified": "2025-11-07T15:01:16.624612Z",
            "relationship_type": "derived-from",
            "source_ref": "indicator--2bac0400-3625-4a55-8e7f-445870e5dd84",
            "target_ref": "indicator--50698359-0cdf-4edd-8271-9914ecc87f67"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--4d60e5b8-72a5-46d4-8ddd-35a54f6e1767",
            "created": "2025-11-07T15:01:16.624887Z",
            "modified": "2025-11-07T15:01:16.624887Z",
            "relationship_type": "derived-from",
            "source_ref": "indicator--f75ecb87-fa41-4eaa-8232-3b57c7f26f5d",
            "target_ref": "indicator--50698359-0cdf-4edd-8271-9914ecc87f67"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--b8d9ec77-837f-44d4-a2ca-c90943434b39",
            "created": "2025-11-07T15:01:16.625469Z",
            "modified": "2025-11-07T15:01:16.625469Z",
            "relationship_type": "derived-from",
            "source_ref": "indicator--3abb6330-a65f-4f71-955a-76d82c649e62",
            "target_ref": "indicator--97a76ff1-5105-4e30-b646-1dd465d7c0e5"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--ffab99c2-304f-4a25-8a33-7ea413af37dc",
            "created": "2025-11-07T15:01:16.625792Z",
            "modified": "2025-11-07T15:01:16.625792Z",
            "relationship_type": "derived-from",
            "source_ref": "indicator--3abb6330-a65f-4f71-955a-76d82c649e62",
            "target_ref": "indicator--6194f3b2-3066-41b3-9bdb-a132c36d1a03"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--44d8f9fb-1344-46dc-8f1d-3581620cbb94",
            "created": "2025-11-07T15:01:16.626059Z",
            "modified": "2025-11-07T15:01:16.626059Z",
            "relationship_type": "derived-from",
            "source_ref": "indicator--97a76ff1-5105-4e30-b646-1dd465d7c0e5",
            "target_ref": "indicator--6194f3b2-3066-41b3-9bdb-a132c36d1a03"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--4288e703-b4b3-4393-a8f8-14915383ed25",
            "created": "2025-11-07T15:01:16.626331Z",
            "modified": "2025-11-07T15:01:16.626331Z",
            "relationship_type": "derived-from",
            "source_ref": "indicator--46cea1f3-aaba-4244-adcd-8038606372eb",
            "target_ref": "indicator--4e338b49-be37-40f7-8512-8fe25cf20555"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--c25c993e-2bbd-4a46-b3f5-a8a8a86f7d50",
            "created": "2025-11-07T15:01:16.626592Z",
            "modified": "2025-11-07T15:01:16.626592Z",
            "relationship_type": "derived-from",
            "source_ref": "indicator--46cea1f3-aaba-4244-adcd-8038606372eb",
            "target_ref": "indicator--e72a8160-29b4-4f63-ba6f-fc17dec303b8"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--56714033-4152-4e4e-a421-33e8af0c7c7b",
            "created": "2025-11-07T15:01:16.626899Z",
            "modified": "2025-11-07T15:01:16.626899Z",
            "relationship_type": "derived-from",
            "source_ref": "indicator--4e338b49-be37-40f7-8512-8fe25cf20555",
            "target_ref": "indicator--e72a8160-29b4-4f63-ba6f-fc17dec303b8"
        },
        {
            "type": "malware",
            "spec_version": "2.1",
            "id": "malware--605997e2-5736-4d3d-810b-76ef72341ae7",
            "created_by_ref": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:32.992469Z",
            "modified": "2025-11-07T15:08:32.992469Z",
            "name": "sparrowdoor",
            "description": "SparrowDoor is a persistent 32-bit loader and backdoor targeting Windows. It communicates with C2 over HTTPS (proxy-aware) and XOR-encodes beaconing, tasking, and exfil data. It achieves persistence via a Windows service (SearchIndexer.exe) or the CurrentVersion\\Run key. The malware side-loads a malicious libcurl.dll via a signed Notepad++ updater renamed to SearchIndexer.exe, then injects into a suspended svchost.exe instance. It implements defence-evasion techniques including API inline hooks (e.g., AcquireCredentialsHandleA, socket functions), AV process checks, token impersonation (using the explorer.exe token), masquerading, signed binary proxy execution, and reflective loading. Functionality includes file/directory listing, file read/write/delete/rename, directory creation, reverse shell, clipboard logging (clipshot), and exfiltration over its C2 channel. It uses mutex Global\\gup0, environment variables 111/222/333 to track file paths, and configuration that includes an XOR-obfuscated C2 domain (cdn181.awsdns-531[.]com), port (443), proxy settings, and an AV enforcement flag.",
            "malware_types": [
                "backdoor",
                "remote-access-trojan",
                "spyware"
            ],
            "is_family": true
        },
        {
            "type": "identity",
            "spec_version": "2.1",
            "id": "identity--06ffe6dd-1a16-4b8c-8213-4dc8e927a838",
            "created": "2025-11-07T15:08:32.993128Z",
            "modified": "2025-11-07T15:08:32.993128Z",
            "name": "ESET",
            "description": "Referenced as the organization that reported SparrowDoor in September 2021.",
            "identity_class": "organization"
        },
        {
            "type": "identity",
            "spec_version": "2.1",
            "id": "identity--f274e268-535c-49c1-8b28-54c284f380c8",
            "created": "2025-11-07T15:08:32.993339Z",
            "modified": "2025-11-07T15:08:32.993339Z",
            "name": "Kaspersky",
            "description": "Antivirus vendor whose process name (avp.exe) appears in SparrowDoor's AV detection list.",
            "identity_class": "organization"
        },
        {
            "type": "identity",
            "spec_version": "2.1",
            "id": "identity--d35f8162-cdb6-4f71-8192-c1c0da7deb67",
            "created": "2025-11-07T15:08:32.993511Z",
            "modified": "2025-11-07T15:08:32.993511Z",
            "name": "ESET (AV)",
            "description": "Antivirus vendor whose process name (egui.exe) appears in SparrowDoor's AV detection list.",
            "identity_class": "organization"
        },
        {
            "type": "identity",
            "spec_version": "2.1",
            "id": "identity--a5c5b78b-cc61-48e5-828f-fd25943f20ba",
            "created": "2025-11-07T15:08:32.993801Z",
            "modified": "2025-11-07T15:08:32.993801Z",
            "name": "Symantec",
            "description": "Antivirus vendor whose process names (ccSetMgr.exe, ccSvcHst.exe, ccapp.exe) appear in SparrowDoor's AV detection list.",
            "identity_class": "organization"
        },
        {
            "type": "identity",
            "spec_version": "2.1",
            "id": "identity--8bc6aa90-81dc-4902-bc34-76565f9b49ee",
            "created": "2025-11-07T15:08:32.993984Z",
            "modified": "2025-11-07T15:08:32.993984Z",
            "name": "Trend Micro",
            "description": "Antivirus vendor whose process name (TMBMSRV.exe) appears in SparrowDoor's AV detection list.",
            "identity_class": "organization"
        },
        {
            "type": "identity",
            "spec_version": "2.1",
            "id": "identity--93d32755-f95f-4bb7-9d04-122a2bed1c08",
            "created": "2025-11-07T15:08:32.994141Z",
            "modified": "2025-11-07T15:08:32.994141Z",
            "name": "Comodo Firewall Pro",
            "description": "Security product referenced in SparrowDoor's AV detection list.",
            "identity_class": "organization"
        },
        {
            "type": "identity",
            "spec_version": "2.1",
            "id": "identity--2bee02fa-bd29-4d0c-9845-92b36394b579",
            "created": "2025-11-07T15:08:32.994347Z",
            "modified": "2025-11-07T15:08:32.994347Z",
            "name": "McAfee",
            "description": "Antivirus vendor whose process name (Mcshield.exe) appears in SparrowDoor's AV detection list.",
            "identity_class": "organization"
        },
        {
            "type": "identity",
            "spec_version": "2.1",
            "id": "identity--91ca12e6-ebf0-40e2-b335-e1f919a4c45e",
            "created": "2025-11-07T15:08:32.994543Z",
            "modified": "2025-11-07T15:08:32.994543Z",
            "name": "360.cn",
            "description": "Security vendor associated with the process name ZhuDongFangYu.exe in SparrowDoor's AV detection list.",
            "identity_class": "organization"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--8ad342bf-250a-4ca4-8467-cd430e2e5472",
            "created_by_ref": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:32.994714Z",
            "modified": "2025-11-07T15:08:32.994714Z",
            "name": "Create or Modify System Process: Windows Service",
            "description": "SparrowDoor achieves persistence by installing SearchIndexer.exe as a Windows service, using parameters defined in the malware configuration.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "persistence"
                }
            ],
            "external_references": [
                {
                    "source_name": "mitre-attack",
                    "url": "https://attack.mitre.org/techniques/T1543/003",
                    "external_id": "T1543.003"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--89e9c004-40a8-4ed4-b497-10a82725ef06",
            "created_by_ref": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:32.995209Z",
            "modified": "2025-11-07T15:08:32.995209Z",
            "name": "Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder",
            "description": "If SparrowDoor fails to persist as a Windows Service, it installs SearchIndexer.exe in the CurrentVersion\\Run key.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "persistence"
                }
            ],
            "external_references": [
                {
                    "source_name": "mitre-attack",
                    "url": "https://attack.mitre.org/techniques/T1547/001",
                    "external_id": "T1547.001"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--20ac46b8-6175-4c85-a477-041c3637699f",
            "created_by_ref": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:32.995601Z",
            "modified": "2025-11-07T15:08:32.995601Z",
            "name": "Access Token Manipulation: Token Impersonation/Theft",
            "description": "SparrowDoor impersonates the user account token associated with the explorer.exe process.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "defence-evasion"
                }
            ],
            "external_references": [
                {
                    "source_name": "mitre-attack",
                    "url": "https://attack.mitre.org/techniques/T1134/001",
                    "external_id": "T1134.001"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--deae1c76-6efa-4280-a526-338073142746",
            "created_by_ref": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:32.995998Z",
            "modified": "2025-11-07T15:08:32.995998Z",
            "name": "Deobfuscate/Decode Files or Information",
            "description": "The SparrowDoor malware file libhost.dll is obfuscated with a 4-byte XOR key and the configuration is obfuscated with an 8-byte XOR key.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "defence-evasion"
                }
            ],
            "external_references": [
                {
                    "source_name": "mitre-attack",
                    "url": "https://attack.mitre.org/techniques/T1140",
                    "external_id": "T1140"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--73271dfb-df56-41cc-a6a7-c8e1c1752329",
            "created_by_ref": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:32.996302Z",
            "modified": "2025-11-07T15:08:32.996302Z",
            "name": "Hijack Execution Flow: DLL Side-Loading",
            "description": "The SparrowDoor malware gains execution when the malware file libcurl.dll is side-loaded by SearchIndexer.exe.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "defence-evasion"
                }
            ],
            "external_references": [
                {
                    "source_name": "mitre-attack",
                    "url": "https://attack.mitre.org/techniques/T1574/002",
                    "external_id": "T1574.002"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--9a1d57f1-f0ff-4113-aac2-510aef50b1b4",
            "created_by_ref": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:32.996575Z",
            "modified": "2025-11-07T15:08:32.996575Z",
            "name": "Process Injection: Portable Executable Injection",
            "description": "SparrowDoor injects itself into a spawned and suspended instance of svchost.exe during initialisation.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "defence-evasion"
                }
            ],
            "external_references": [
                {
                    "source_name": "mitre-attack",
                    "url": "https://attack.mitre.org/techniques/T1055/012",
                    "external_id": "T1055.012"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--24043317-4cf9-437b-b638-f7eba93030ab",
            "created_by_ref": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:32.99699Z",
            "modified": "2025-11-07T15:08:32.99699Z",
            "name": "Indicator Removal on Host: File Deletion",
            "description": "SparrowDoor can be tasked to remove arbitrary files from the host. It can also be tasked to delete files specific to the malware execution i.e. a clean-up routine.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "defence-evasion"
                }
            ],
            "external_references": [
                {
                    "source_name": "mitre-attack",
                    "url": "https://attack.mitre.org/techniques/T1070/004",
                    "external_id": "T1070.004"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--3454bcc3-a021-4c74-a1b4-ab177ba83a29",
            "created_by_ref": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:32.997347Z",
            "modified": "2025-11-07T15:08:32.997347Z",
            "name": "Reflective Code Loading",
            "description": "SparrowDoor is loaded by a reflective loader found in libhost.dll.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "defence-evasion"
                }
            ],
            "external_references": [
                {
                    "source_name": "mitre-attack",
                    "url": "https://attack.mitre.org/techniques/T1620",
                    "external_id": "T1620"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--75baa449-08bf-4021-8a1a-d5aca7bacb9d",
            "created_by_ref": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:32.997715Z",
            "modified": "2025-11-07T15:08:32.997715Z",
            "name": "Masquerading: Match Legitimate Name or Location",
            "description": "A legitimate and signed Notepad++ updater has been renamed SearchIndexer.exe, which is the name of a legitimate Windows binary. This file is used to load SparrowDoor. The malware also uses the name libcurl.dll for its loader, libcurl is a legitimate project.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "defence-evasion"
                }
            ],
            "external_references": [
                {
                    "source_name": "mitre-attack",
                    "url": "https://attack.mitre.org/techniques/T1036/005",
                    "external_id": "T1036.005"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--62f7654b-2dba-42af-8902-79b96874a1ba",
            "created_by_ref": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:32.998194Z",
            "modified": "2025-11-07T15:08:32.998194Z",
            "name": "Signed Binary Proxy Execution",
            "description": "SparrowDoor is side-loaded into, and hijacks execution of, a signed Notepad++ updater.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "defence-evasion"
                }
            ],
            "external_references": [
                {
                    "source_name": "mitre-attack",
                    "url": "https://attack.mitre.org/techniques/T1218",
                    "external_id": "T1218"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--563fcd78-f720-411b-90b3-7a1a127e6186",
            "created_by_ref": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:32.99849Z",
            "modified": "2025-11-07T15:08:32.99849Z",
            "name": "Software Discovery: Security Software Discovery",
            "description": "SparrowDoor checks the running processes against a list of hardcoded AV names.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "discovery"
                }
            ],
            "external_references": [
                {
                    "source_name": "mitre-attack",
                    "url": "https://attack.mitre.org/techniques/T1518/001",
                    "external_id": "T1518.001"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--88a88853-38d6-45b2-b7a8-64bb060e2860",
            "created_by_ref": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:32.998847Z",
            "modified": "2025-11-07T15:08:32.998847Z",
            "name": "Application Layer Protocol: Web Protocols",
            "description": "SparrowDoor uses HTTPS as a Command and control (C2) channel and is proxy aware.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "command-and-control"
                }
            ],
            "external_references": [
                {
                    "source_name": "mitre-attack",
                    "url": "https://attack.mitre.org/techniques/T1071/001",
                    "external_id": "T1071.001"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--d986fdc4-e6f6-4e7e-950b-5814888a7790",
            "created_by_ref": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:32.999132Z",
            "modified": "2025-11-07T15:08:32.999132Z",
            "name": "Encrypted Channel: Symmetric Cryptography",
            "description": "SparrowDoor uses static XOR keys to encode data when it is being sent or received over the C2 channel.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "command-and-control"
                }
            ],
            "external_references": [
                {
                    "source_name": "mitre-attack",
                    "url": "https://attack.mitre.org/techniques/T1573/001",
                    "external_id": "T1573.001"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--463363d2-a3e0-4a7e-ad28-1fe4d04676c1",
            "created_by_ref": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:32.999396Z",
            "modified": "2025-11-07T15:08:32.999396Z",
            "name": "Clipboard Data",
            "description": "SparrowDoor can be tasked to launch clipboard logging functionality.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "collection"
                }
            ],
            "external_references": [
                {
                    "source_name": "mitre-attack",
                    "url": "https://attack.mitre.org/techniques/T1115",
                    "external_id": "T1115"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--6e4a38c7-79bd-472c-8f5a-aac9b9ba3332",
            "created_by_ref": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:32.999862Z",
            "modified": "2025-11-07T15:08:32.999862Z",
            "name": "Exfiltration Over C2 Channel",
            "description": "SparrowDoor can be tasked to exfiltrate files from disk.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "exfiltration"
                }
            ],
            "external_references": [
                {
                    "source_name": "mitre-attack",
                    "url": "https://attack.mitre.org/techniques/T1041",
                    "external_id": "T1041"
                }
            ]
        },
        {
            "type": "indicator",
            "spec_version": "2.1",
            "id": "indicator--1c0831e7-cbdd-4203-80e5-a77488de5dcf",
            "created_by_ref": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:33.000404Z",
            "modified": "2025-11-07T15:08:33.000404Z",
            "name": "SparrowDoor_apipatch",
            "description": "YARA rule to detect related activity.",
            "pattern": "rule SparrowDoor_apipatch {\n    meta:\n        author = \"NCSC\"\n\n  description = \"Identifies code segments in SparrowDoor\nresponsible for patching APIs. No MZ/PE match as the backdoor has no\nheader. Targeting in memory.\"\n        date = \"2022-02-28\"\n        hash1 = \"c1890a6447c991880467b86a013dbeaa66cc615f\"\n    strings:\n        $save = {8B 06 89 07 8A 4E 04} // save off first 5 bytes of\nfunction\n\n  $vp_1 = {89 10 8A 4E 04 8B D6 2B D0 88 48 04 83 EA 05 C6 40 05 E9\n\n89 50 06} // calculate long jump\n\n  $vp_2 = {50 8B D6 6A 40 2B D7 88 4F 04 83 EA 05 6A 05 C6 47 05 E9\n\n89 57 06 56} // calculate long jump 2\n\n  $vp_3 = {51 52 2B DE 6A 05 83 EB 05 56 C6 06 E9 89 5E 01} //\n\nrestore memory protections\n\n  $va = {6A 40 68 00 10 00 00 68 00 10 00 00 6A 00} // virtually\n\nalloc set size, allocation and protection\n\n  $s_patch = {50 68 7F FF FF FF 68 FF FF 00 00 56} // socket patch\n\nSO_DONTLINGER\n\n    condition:\n\n    3 of them\n\n}\n",
            "pattern_type": "yara",
            "valid_from": "2025-11-07T15:08:33.00039Z"
        },
        {
            "type": "indicator",
            "spec_version": "2.1",
            "id": "indicator--bd691cdc-d181-45e8-bf3c-e41b59b22fa1",
            "created_by_ref": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:33.000677Z",
            "modified": "2025-11-07T15:08:33.000677Z",
            "name": "SparrowDoor_clipshot",
            "description": "YARA rule to detect related activity.",
            "pattern": "import \"pe\"\nrule SparrowDoor_clipshot {\n    meta:\n        author = \"NCSC\"\n\n  description = \"The SparrowDoor loader contains a feature it calls\n\nclipshot, which logs clipboard data to a file.\"\n        date = \"2022-02-28\"\n        hash1 = \"989b3798841d06e286eb083132242749c80fdd4d\"\n    strings:\n        $exsting_cmp = {8B 1E 3B 19 75 ?? 83 E8 04 83 C1 04 83 C6 04 83\nF8 04} // comparison routine for previous clipboard data\n\n  $time_format_string = \"%d/%d/%d %d:%d\" ascii\n  $cre_fil_args = {6A 00 68 80 00 00 00 6A 04 6A 00 6A 02 68 00 00\n\n00 40 52}\n    condition:\n        (uint16(0) == 0x5A4D) and uint32(uint32(0x3C)) == 0x00004550 and\nall of them and (pe.imports(\"User32.dll\",\"OpenClipboard\") and\npe.imports(\"User32.dll\",\"GetClipboardData\") and\npe.imports(\"Kernel32.dll\",\"GetLocalTime\") and\npe.imports(\"Kernel32.dll\",\"GlobalSize\"))\n\n}\n",
            "pattern_type": "yara",
            "valid_from": "2025-11-07T15:08:33.000671Z"
        },
        {
            "type": "indicator",
            "spec_version": "2.1",
            "id": "indicator--d5ef94f3-3584-4915-ad91-7f35961ec8ad",
            "created_by_ref": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:33.000985Z",
            "modified": "2025-11-07T15:08:33.000985Z",
            "name": "SparrowDoor_config",
            "description": "YARA rule to detect related activity.",
            "pattern": "rule SparrowDoor_config {\n    meta:\n        author = \"NCSC\"\n\n  description = \"Targets the XOR encoded loader config and\nshellcode in the file libhost.dll using the known position of the XOR\nkey.\"\n        date = \"2022-02-28\"\n        hash1 = \"c1890a6447c991880467b86a013dbeaa66cc615f\"\n    condition:\n        (uint16(0) != 0x5A4D) and\n        (uint16(0) != 0x8b55) and\n\n  (uint32(0) ^ uint32(0x4c) ==  0x00) and\n  (uint32(0) ^ uint32(0x34) ==  0x00) and\n  (uint16(0) ^ uint16(0x50) ==  0x8b55)\n\n}\n",
            "pattern_type": "yara",
            "valid_from": "2025-11-07T15:08:33.000978Z"
        },
        {
            "type": "indicator",
            "spec_version": "2.1",
            "id": "indicator--d9a2aa26-6dec-4d95-9962-23ff33596e26",
            "created_by_ref": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:33.001188Z",
            "modified": "2025-11-07T15:08:33.001188Z",
            "name": "SparrowDoor_loader",
            "description": "YARA rule to detect related activity.",
            "pattern": "rule SparrowDoor_loader {\n    meta:\n        author = \"NCSC\"\n\n  description = \"Targets code features of the SparrowDoor loader.\n\nThis rule detects the previous variant and this new variant.\"\n        date = \"2022-02-28\"\n        hash1 = \"989b3798841d06e286eb083132242749c80fdd4d\"\n    strings:\n\n  $xor_algo = {8B D0 83 E2 03 8A 54 14 10 30 14 30 40 3B C1}\n  $rva = {8D B0 [4] 8D 44 24 ?? 50 6A 40 6A 05 56} // load RVA of\n\nprocess exe\n        $lj = {2B CE 83 E9 05 8D [3] 52 C6 06 E9 89 4E 01 8B [3] 50 6A 05\n56} // calculate long jump\n    condition:\n        (uint16(0) == 0x5A4D) and uint32(uint32(0x3C)) == 0x00004550 and\nall of them\n\n}\n",
            "pattern_type": "yara",
            "valid_from": "2025-11-07T15:08:33.001183Z"
        },
        {
            "type": "indicator",
            "spec_version": "2.1",
            "id": "indicator--07a4d320-b460-430f-8f44-9631a0a04de9",
            "created_by_ref": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:33.001477Z",
            "modified": "2025-11-07T15:08:33.001477Z",
            "name": "SparrowDoor_shellcode",
            "description": "YARA rule to detect related activity.",
            "pattern": "rule SparrowDoor_shellcode {\n    meta:\n        author = \"NCSC\"\n\n  description = \"Targets code features of the reflective loader for\n\nSparrowDoor. Targeting in memory.\"\n        date = \"2022-02-28\"\n        hash1 = \"c1890a6447c991880467b86a013dbeaa66cc615f\"\n    strings:\n        $peb = {8B 48 08 89 4D FC 8B 51 3C 8B 54 0A 78 8B 74 0A 20 03 D1\n03 F1 B3 64}\n\n  $getp_match = {8B 06 03 C1 80 38 47 75 34 80 78 01 65 75 2E 80 78\n\n02 74 75 28 80 78 03 50 75 22 80 78 04 72 75 1C 80 78 06 63 75 16 80 78\n05 6F 75 10 80 78 07 41 75 0A}\n        $k_check = {8B 48 20 8A 09 80 F9 6B 74 05 80 F9 4B 75 05}\n        $resolve_load_lib = {C7 45 C4 4C 6F 61 64 C7 45 C8 4C 69 62 72 C7\n45 CC 61 72 79 41 C7 45 D0 00 00 00 00 FF 75 FC FF 55 E4}\n    condition:\n        3 of them\n}\n",
            "pattern_type": "yara",
            "valid_from": "2025-11-07T15:08:33.00147Z"
        },
        {
            "type": "indicator",
            "spec_version": "2.1",
            "id": "indicator--bd30282f-bab1-484c-9283-c0e309a6a742",
            "created_by_ref": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:33.001747Z",
            "modified": "2025-11-07T15:08:33.001747Z",
            "name": "SparrowDoor_sleep_routine",
            "description": "YARA rule to detect related activity.",
            "pattern": "rule SparrowDoor_sleep_routine {\n    meta:\n        author = \"NCSC\"\n        description = \"SparrowDoor implements a Sleep routine with value\nseeded on GetTickCount. This signature detects the previous and this\nvariant of SparrowDoor. No MZ/PE match as the backdoor has no header.\nTargeting in memory.\"\n        date = \"2022-02-28\"\n        hash1 = \"c1890a6447c991880467b86a013dbeaa66cc615f\"\n\n    strings:\n        $sleep = {FF D7 33 D2 B9 [4] F7 F1 81 C2 [4] 8B C2 C1 E0 04 2B C2\n03 C0 03 C0 03 C0 50}\n\n    condition:\n\n  all of them\n\n}\n",
            "pattern_type": "yara",
            "valid_from": "2025-11-07T15:08:33.001718Z"
        },
        {
            "type": "indicator",
            "spec_version": "2.1",
            "id": "indicator--5f9a71e4-c020-4701-9545-78504d43e621",
            "created_by_ref": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:33.001983Z",
            "modified": "2025-11-07T15:08:33.001983Z",
            "name": "SparrowDoor_xor",
            "description": "YARA rule to detect related activity.",
            "pattern": "rule SparrowDoor_xor {\n    meta:\n        author = \"NCSC\"\n\n  description = \"Highlights XOR routines in SparrowDoor. No MZ/PE\n\nmatch as the backdoor has no header. Targeting in memory.\"\n        date = \"2022-02-28\"\n        hash1 = \"c1890a6447c991880467b86a013dbeaa66cc615f\"\n    strings:\n        $xor_routine_outbound = {B8 39 8E E3 38 F7 E1 D1 EA 8D 14 D2 8B\nC1 2B C2 8A [4] 00 30 14 39 41 3B CE}\n\n  $xor_routine_inbound = {B8 25 49 92 24 F7 E1 8B C1 2B C2 D1 E8 03\n\nC2 C1 E8 02 8D 14 C5 [4] 2B D0 8B C1 2B C2}\n        $xor_routine_config = {8B D9 83 E3 07 0F [6] 30 18 8D 1C 07 83 E3\n07 0F [6] 30 58 01 8D 1C 28 83 E3 07 0F [6] 30 58 02 8D 1C 02 83 E3 07 0F\n[6] 30 58 03 8B DE 83 E3 07 0F [6] 30 58 04 83 C6 05 83 C1 05}\n    condition:\n        2 of them\n}\n",
            "pattern_type": "yara",
            "valid_from": "2025-11-07T15:08:33.001977Z"
        },
        {
            "type": "indicator",
            "spec_version": "2.1",
            "id": "indicator--bc4adfcb-841d-4e67-bee2-96ec81062ec3",
            "created_by_ref": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:33.002178Z",
            "modified": "2025-11-07T15:08:33.002178Z",
            "name": "SparrowDoor_strings",
            "description": "YARA rule to detect related activity.",
            "pattern": "rule SparrowDoor_strings {\n    meta:\n        author = \"NCSC\"\n        description = \"Strings that appear in SparrowDoor's backdoor.\nTargeting in memory.\"\n        date = \"2022-02-28\"\n        hash1 = \"c1890a6447c991880467b86a013dbeaa66cc615f\"\n\n    strings:\n        $reg = \"Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\" ascii\n\n$http_headers = {55 73 65 72 2D 41 67 65 6E 74 3A 20 4D 6F 7A 69 6C\n\n6C 61 2F 34 2E 30 20 28 63 6F 6D 70 61 74 69 62 6C 65 3B 20 4D 53 49 45\n 20 35 2E 30 3B 20 57 69 6E 64 6F 77 73 20 4E 54 20 35 2E 30 29 0D 0A 41\n63 63 65 70 74 2D 4C 61 6E 67 75 61 67 65 3A 20 65 6E 2D 55 53 0D 0A 41\n63 63 65 70 74 3A 20 2A 2F 2A 0D 0A}\n\n$http_proxy = \"HTTPS=HTTPS://%s:%d\" ascii\n$debug = \"SeDebugPrivilege\" ascii\n$av1 = \"avp.exe\" ascii // Kaspersky\n$av2 = \"ZhuDongFangYu.exe\" ascii // Qihoo360\n$av3 = \"egui.exe\" ascii // ESET\n$av4 = \"TMBMSRV.exe\" ascii // Trend Micro\n$av5 = \"ccSetMgr.exe\" ascii // Norton\n$clipshot = \"clipshot\" ascii\n$ComSpec =  \"ComSpec\" ascii\n$export = \"curl_easy_init\" ascii\n\n    condition:\n        10 of them\n}\n",
            "pattern_type": "yara",
            "valid_from": "2025-11-07T15:08:33.002171Z"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--eb082c4f-e801-422e-8da1-820e1066e092",
            "created_by_ref": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:33.002596Z",
            "modified": "2025-11-07T15:08:33.002596Z",
            "relationship_type": "uses",
            "source_ref": "malware--605997e2-5736-4d3d-810b-76ef72341ae7",
            "target_ref": "attack-pattern--8ad342bf-250a-4ca4-8467-cd430e2e5472"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--fd925be3-5cde-4133-9aeb-4fd28d3ae8c9",
            "created_by_ref": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:33.00289Z",
            "modified": "2025-11-07T15:08:33.00289Z",
            "relationship_type": "uses",
            "source_ref": "malware--605997e2-5736-4d3d-810b-76ef72341ae7",
            "target_ref": "attack-pattern--89e9c004-40a8-4ed4-b497-10a82725ef06"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--3bd0319d-42e4-42ed-a429-ba40f1b0b824",
            "created_by_ref": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:33.003127Z",
            "modified": "2025-11-07T15:08:33.003127Z",
            "relationship_type": "uses",
            "source_ref": "malware--605997e2-5736-4d3d-810b-76ef72341ae7",
            "target_ref": "attack-pattern--20ac46b8-6175-4c85-a477-041c3637699f"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--7d38cca2-8256-43d5-a486-ee0b07e927a6",
            "created_by_ref": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:33.003338Z",
            "modified": "2025-11-07T15:08:33.003338Z",
            "relationship_type": "uses",
            "source_ref": "malware--605997e2-5736-4d3d-810b-76ef72341ae7",
            "target_ref": "attack-pattern--deae1c76-6efa-4280-a526-338073142746"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--c2c9c239-a8c8-4ef6-b4e9-233539488d47",
            "created_by_ref": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:33.003559Z",
            "modified": "2025-11-07T15:08:33.003559Z",
            "relationship_type": "uses",
            "source_ref": "malware--605997e2-5736-4d3d-810b-76ef72341ae7",
            "target_ref": "attack-pattern--73271dfb-df56-41cc-a6a7-c8e1c1752329"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--55628add-d8da-4a57-bfb9-f17b051f06ae",
            "created_by_ref": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:33.003833Z",
            "modified": "2025-11-07T15:08:33.003833Z",
            "relationship_type": "uses",
            "source_ref": "malware--605997e2-5736-4d3d-810b-76ef72341ae7",
            "target_ref": "attack-pattern--9a1d57f1-f0ff-4113-aac2-510aef50b1b4"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--54e3ae95-ab91-4895-8303-d886a4f5bdd6",
            "created_by_ref": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:33.004034Z",
            "modified": "2025-11-07T15:08:33.004034Z",
            "relationship_type": "uses",
            "source_ref": "malware--605997e2-5736-4d3d-810b-76ef72341ae7",
            "target_ref": "attack-pattern--24043317-4cf9-437b-b638-f7eba93030ab"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--c82b38ef-49bc-482d-8626-8b26d873bc6c",
            "created_by_ref": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:33.004331Z",
            "modified": "2025-11-07T15:08:33.004331Z",
            "relationship_type": "uses",
            "source_ref": "malware--605997e2-5736-4d3d-810b-76ef72341ae7",
            "target_ref": "attack-pattern--3454bcc3-a021-4c74-a1b4-ab177ba83a29"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--7b966133-76cb-45c0-89a1-19f42022033f",
            "created_by_ref": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:33.004613Z",
            "modified": "2025-11-07T15:08:33.004613Z",
            "relationship_type": "uses",
            "source_ref": "malware--605997e2-5736-4d3d-810b-76ef72341ae7",
            "target_ref": "attack-pattern--75baa449-08bf-4021-8a1a-d5aca7bacb9d"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--5abf748d-bbe4-4667-9559-6182aa9f7ce2",
            "created_by_ref": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:33.004889Z",
            "modified": "2025-11-07T15:08:33.004889Z",
            "relationship_type": "uses",
            "source_ref": "malware--605997e2-5736-4d3d-810b-76ef72341ae7",
            "target_ref": "attack-pattern--62f7654b-2dba-42af-8902-79b96874a1ba"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--76b393e1-d69a-42e9-98ec-6727193943a9",
            "created_by_ref": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:33.005081Z",
            "modified": "2025-11-07T15:08:33.005081Z",
            "relationship_type": "uses",
            "source_ref": "malware--605997e2-5736-4d3d-810b-76ef72341ae7",
            "target_ref": "attack-pattern--563fcd78-f720-411b-90b3-7a1a127e6186"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--a590ca19-b998-4866-b349-e8c9b97cb4d9",
            "created_by_ref": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:33.005264Z",
            "modified": "2025-11-07T15:08:33.005264Z",
            "relationship_type": "uses",
            "source_ref": "malware--605997e2-5736-4d3d-810b-76ef72341ae7",
            "target_ref": "attack-pattern--88a88853-38d6-45b2-b7a8-64bb060e2860"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--4d084dbd-d332-4181-93e8-fefbd6ff8701",
            "created_by_ref": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:33.005498Z",
            "modified": "2025-11-07T15:08:33.005498Z",
            "relationship_type": "uses",
            "source_ref": "malware--605997e2-5736-4d3d-810b-76ef72341ae7",
            "target_ref": "attack-pattern--d986fdc4-e6f6-4e7e-950b-5814888a7790"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--7daec25e-8ff7-4241-8ab8-3fd83b9d57b2",
            "created_by_ref": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:33.005684Z",
            "modified": "2025-11-07T15:08:33.005684Z",
            "relationship_type": "uses",
            "source_ref": "malware--605997e2-5736-4d3d-810b-76ef72341ae7",
            "target_ref": "attack-pattern--463363d2-a3e0-4a7e-ad28-1fe4d04676c1"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--bf4118e5-e6ae-4e93-9299-3378024c2302",
            "created_by_ref": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:33.005896Z",
            "modified": "2025-11-07T15:08:33.005896Z",
            "relationship_type": "uses",
            "source_ref": "malware--605997e2-5736-4d3d-810b-76ef72341ae7",
            "target_ref": "attack-pattern--6e4a38c7-79bd-472c-8f5a-aac9b9ba3332"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--4a824306-3a20-44ac-8bdc-f511f3ecaaaf",
            "created_by_ref": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:33.006111Z",
            "modified": "2025-11-07T15:08:33.006111Z",
            "relationship_type": "indicates",
            "source_ref": "indicator--f2e48931-9bb0-4a83-8bdd-8ccdabdba7d1",
            "target_ref": "malware--605997e2-5736-4d3d-810b-76ef72341ae7"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--cc84fdce-dd4e-4549-974a-b705e68c65e6",
            "created_by_ref": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:33.006379Z",
            "modified": "2025-11-07T15:08:33.006379Z",
            "relationship_type": "indicates",
            "source_ref": "indicator--d726a4ec-4305-475f-a35d-2dcc05c5890a",
            "target_ref": "malware--605997e2-5736-4d3d-810b-76ef72341ae7"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--61cf647e-62a7-45ef-9dbc-749852532522",
            "created_by_ref": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:33.006561Z",
            "modified": "2025-11-07T15:08:33.006561Z",
            "relationship_type": "indicates",
            "source_ref": "indicator--66534358-7500-4919-8f95-dd8eac4bbc5b",
            "target_ref": "malware--605997e2-5736-4d3d-810b-76ef72341ae7"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--ce0c353e-7350-41ee-bea8-8141f0dbd140",
            "created_by_ref": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:33.006841Z",
            "modified": "2025-11-07T15:08:33.006841Z",
            "relationship_type": "indicates",
            "source_ref": "indicator--5e867143-f1f9-4520-9eeb-fbbb4a827fef",
            "target_ref": "malware--605997e2-5736-4d3d-810b-76ef72341ae7"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--cb14133d-24cf-431c-bcc6-7660840efc2e",
            "created_by_ref": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:33.007023Z",
            "modified": "2025-11-07T15:08:33.007023Z",
            "relationship_type": "indicates",
            "source_ref": "indicator--f7eead85-3478-4cab-bf78-4a59371e568b",
            "target_ref": "malware--605997e2-5736-4d3d-810b-76ef72341ae7"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--3ea6725b-e5ab-43ec-a2d1-08f363616cb3",
            "created_by_ref": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:33.007263Z",
            "modified": "2025-11-07T15:08:33.007263Z",
            "relationship_type": "indicates",
            "source_ref": "indicator--0000edc3-cfb2-4629-8b9d-98141cbb24dd",
            "target_ref": "malware--605997e2-5736-4d3d-810b-76ef72341ae7"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--1b283de1-1339-46d4-885f-6be26b95709e",
            "created_by_ref": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:33.007446Z",
            "modified": "2025-11-07T15:08:33.007446Z",
            "relationship_type": "indicates",
            "source_ref": "indicator--b03d9673-242e-459e-a43d-24a198f25895",
            "target_ref": "malware--605997e2-5736-4d3d-810b-76ef72341ae7"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--31bb0da7-2cf2-4cba-8bc8-a1e817ec06b1",
            "created_by_ref": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:33.007615Z",
            "modified": "2025-11-07T15:08:33.007615Z",
            "relationship_type": "indicates",
            "source_ref": "indicator--caf91906-8e03-4964-8f73-3e5253967abb",
            "target_ref": "malware--605997e2-5736-4d3d-810b-76ef72341ae7"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--2eb49675-beb1-430c-a4a9-db9ab089a265",
            "created_by_ref": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:33.008088Z",
            "modified": "2025-11-07T15:08:33.008088Z",
            "relationship_type": "indicates",
            "source_ref": "indicator--fbb1e016-6ae9-413b-96ef-5208ae15a76f",
            "target_ref": "malware--605997e2-5736-4d3d-810b-76ef72341ae7"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--f9044636-269c-4e0a-90f2-3c77f5bce2fb",
            "created_by_ref": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:33.008378Z",
            "modified": "2025-11-07T15:08:33.008378Z",
            "relationship_type": "indicates",
            "source_ref": "indicator--2bac0400-3625-4a55-8e7f-445870e5dd84",
            "target_ref": "malware--605997e2-5736-4d3d-810b-76ef72341ae7"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--493f3446-689a-44ce-9a7e-d1f94014b1e3",
            "created_by_ref": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:33.008679Z",
            "modified": "2025-11-07T15:08:33.008679Z",
            "relationship_type": "indicates",
            "source_ref": "indicator--f75ecb87-fa41-4eaa-8232-3b57c7f26f5d",
            "target_ref": "malware--605997e2-5736-4d3d-810b-76ef72341ae7"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--2fa725e4-d20d-4318-9c6a-0891385a5fc7",
            "created_by_ref": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:33.008934Z",
            "modified": "2025-11-07T15:08:33.008934Z",
            "relationship_type": "indicates",
            "source_ref": "indicator--50698359-0cdf-4edd-8271-9914ecc87f67",
            "target_ref": "malware--605997e2-5736-4d3d-810b-76ef72341ae7"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--cfff10db-a2e8-4332-be13-58deb48317a4",
            "created_by_ref": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:33.009451Z",
            "modified": "2025-11-07T15:08:33.009451Z",
            "relationship_type": "indicates",
            "source_ref": "indicator--3abb6330-a65f-4f71-955a-76d82c649e62",
            "target_ref": "malware--605997e2-5736-4d3d-810b-76ef72341ae7"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--f639f500-135d-4213-9516-e29ac608c5bf",
            "created_by_ref": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:33.009719Z",
            "modified": "2025-11-07T15:08:33.009719Z",
            "relationship_type": "indicates",
            "source_ref": "indicator--97a76ff1-5105-4e30-b646-1dd465d7c0e5",
            "target_ref": "malware--605997e2-5736-4d3d-810b-76ef72341ae7"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--edcbd284-29a5-42df-a698-5001236ae3e4",
            "created_by_ref": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:33.009948Z",
            "modified": "2025-11-07T15:08:33.009948Z",
            "relationship_type": "indicates",
            "source_ref": "indicator--6194f3b2-3066-41b3-9bdb-a132c36d1a03",
            "target_ref": "malware--605997e2-5736-4d3d-810b-76ef72341ae7"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--a0af540f-d393-4383-bd90-869f1c7ca642",
            "created_by_ref": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:33.010195Z",
            "modified": "2025-11-07T15:08:33.010195Z",
            "relationship_type": "indicates",
            "source_ref": "indicator--46cea1f3-aaba-4244-adcd-8038606372eb",
            "target_ref": "malware--605997e2-5736-4d3d-810b-76ef72341ae7"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--76f8f3d8-ac57-485b-8a6c-cb0ff651ffbf",
            "created_by_ref": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:33.01038Z",
            "modified": "2025-11-07T15:08:33.01038Z",
            "relationship_type": "indicates",
            "source_ref": "indicator--4e338b49-be37-40f7-8512-8fe25cf20555",
            "target_ref": "malware--605997e2-5736-4d3d-810b-76ef72341ae7"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--4297a0f3-d697-4c77-8e6d-feb1dc447533",
            "created_by_ref": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:33.010601Z",
            "modified": "2025-11-07T15:08:33.010601Z",
            "relationship_type": "indicates",
            "source_ref": "indicator--e72a8160-29b4-4f63-ba6f-fc17dec303b8",
            "target_ref": "malware--605997e2-5736-4d3d-810b-76ef72341ae7"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--71eedee5-1bc4-41c4-9ba4-e84109b1e78f",
            "created_by_ref": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:33.011314Z",
            "modified": "2025-11-07T15:08:33.011314Z",
            "relationship_type": "indicates",
            "source_ref": "indicator--1c0831e7-cbdd-4203-80e5-a77488de5dcf",
            "target_ref": "malware--605997e2-5736-4d3d-810b-76ef72341ae7"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--0c0d164d-8930-4f69-92ac-a4f90239bbdb",
            "created_by_ref": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:33.01161Z",
            "modified": "2025-11-07T15:08:33.01161Z",
            "relationship_type": "derived-from",
            "source_ref": "indicator--1c0831e7-cbdd-4203-80e5-a77488de5dcf",
            "target_ref": "indicator--97a76ff1-5105-4e30-b646-1dd465d7c0e5"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--33db2771-2625-4103-a06b-c0588457fe0c",
            "created_by_ref": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:33.011935Z",
            "modified": "2025-11-07T15:08:33.011935Z",
            "relationship_type": "indicates",
            "source_ref": "indicator--bd691cdc-d181-45e8-bf3c-e41b59b22fa1",
            "target_ref": "malware--605997e2-5736-4d3d-810b-76ef72341ae7"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--b4ceceba-0252-4c0d-8d7c-01997157e5f4",
            "created_by_ref": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:33.012137Z",
            "modified": "2025-11-07T15:08:33.012137Z",
            "relationship_type": "derived-from",
            "source_ref": "indicator--bd691cdc-d181-45e8-bf3c-e41b59b22fa1",
            "target_ref": "indicator--f75ecb87-fa41-4eaa-8232-3b57c7f26f5d"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--883a9908-face-41ca-ac46-ad05e6db26e4",
            "created_by_ref": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:33.012389Z",
            "modified": "2025-11-07T15:08:33.012389Z",
            "relationship_type": "indicates",
            "source_ref": "indicator--d5ef94f3-3584-4915-ad91-7f35961ec8ad",
            "target_ref": "malware--605997e2-5736-4d3d-810b-76ef72341ae7"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--901138fc-aad0-463a-af5b-b4831edef83e",
            "created_by_ref": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:33.012624Z",
            "modified": "2025-11-07T15:08:33.012624Z",
            "relationship_type": "derived-from",
            "source_ref": "indicator--d5ef94f3-3584-4915-ad91-7f35961ec8ad",
            "target_ref": "indicator--97a76ff1-5105-4e30-b646-1dd465d7c0e5"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--ac33c8f8-734c-4aa2-9f2b-77e7f3628ca7",
            "created_by_ref": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:33.012935Z",
            "modified": "2025-11-07T15:08:33.012935Z",
            "relationship_type": "indicates",
            "source_ref": "indicator--d9a2aa26-6dec-4d95-9962-23ff33596e26",
            "target_ref": "malware--605997e2-5736-4d3d-810b-76ef72341ae7"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--8d3036de-f6f4-4986-a49c-affb4f25e664",
            "created_by_ref": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:33.013154Z",
            "modified": "2025-11-07T15:08:33.013154Z",
            "relationship_type": "derived-from",
            "source_ref": "indicator--d9a2aa26-6dec-4d95-9962-23ff33596e26",
            "target_ref": "indicator--f75ecb87-fa41-4eaa-8232-3b57c7f26f5d"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--9c45b03f-6d8f-4ab5-9d76-ae8fba9e9fd0",
            "created_by_ref": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:33.013467Z",
            "modified": "2025-11-07T15:08:33.013467Z",
            "relationship_type": "indicates",
            "source_ref": "indicator--07a4d320-b460-430f-8f44-9631a0a04de9",
            "target_ref": "malware--605997e2-5736-4d3d-810b-76ef72341ae7"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--423c4737-58ec-464a-bcc6-61926f9f29e6",
            "created_by_ref": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:33.01367Z",
            "modified": "2025-11-07T15:08:33.01367Z",
            "relationship_type": "derived-from",
            "source_ref": "indicator--07a4d320-b460-430f-8f44-9631a0a04de9",
            "target_ref": "indicator--97a76ff1-5105-4e30-b646-1dd465d7c0e5"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--35ac0762-36f6-445c-848c-198323f0c0d9",
            "created_by_ref": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:33.014066Z",
            "modified": "2025-11-07T15:08:33.014066Z",
            "relationship_type": "indicates",
            "source_ref": "indicator--bd30282f-bab1-484c-9283-c0e309a6a742",
            "target_ref": "malware--605997e2-5736-4d3d-810b-76ef72341ae7"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--3214926d-90b6-4035-9a85-5cecaad11adc",
            "created_by_ref": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:33.014506Z",
            "modified": "2025-11-07T15:08:33.014506Z",
            "relationship_type": "derived-from",
            "source_ref": "indicator--bd30282f-bab1-484c-9283-c0e309a6a742",
            "target_ref": "indicator--97a76ff1-5105-4e30-b646-1dd465d7c0e5"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--8ea0f355-73de-4a2a-b940-09145f3daf37",
            "created_by_ref": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:33.014836Z",
            "modified": "2025-11-07T15:08:33.014836Z",
            "relationship_type": "indicates",
            "source_ref": "indicator--5f9a71e4-c020-4701-9545-78504d43e621",
            "target_ref": "malware--605997e2-5736-4d3d-810b-76ef72341ae7"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--fe037a65-81da-4408-8ee3-2c7e3d67f709",
            "created_by_ref": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:33.015134Z",
            "modified": "2025-11-07T15:08:33.015134Z",
            "relationship_type": "derived-from",
            "source_ref": "indicator--5f9a71e4-c020-4701-9545-78504d43e621",
            "target_ref": "indicator--97a76ff1-5105-4e30-b646-1dd465d7c0e5"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--16d11330-44b3-407a-8c74-540b315a5f7b",
            "created_by_ref": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:33.015377Z",
            "modified": "2025-11-07T15:08:33.015377Z",
            "relationship_type": "indicates",
            "source_ref": "indicator--bc4adfcb-841d-4e67-bee2-96ec81062ec3",
            "target_ref": "malware--605997e2-5736-4d3d-810b-76ef72341ae7"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--8ac6acdb-a71c-46e9-b98b-937ccd37c4f2",
            "created_by_ref": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:33.015635Z",
            "modified": "2025-11-07T15:08:33.015635Z",
            "relationship_type": "derived-from",
            "source_ref": "indicator--bc4adfcb-841d-4e67-bee2-96ec81062ec3",
            "target_ref": "indicator--97a76ff1-5105-4e30-b646-1dd465d7c0e5"
        },
        {
            "type": "report",
            "spec_version": "2.1",
            "id": "report--39079c2b-c210-4bae-8187-d3d15b71c6c8",
            "created_by_ref": "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
            "created": "2025-11-07T15:08:33.01651Z",
            "modified": "2025-11-07T15:08:33.01651Z",
            "name": "Analisi Malware: Sparrowdoor",
            "description": "This report contains technical analysis and indicators associated with malware. sparrowdoor.",
            "report_types": [
                "threat-report"
            ],
            "published": "2025-11-07T15:08:33.016495Z",
            "object_refs": [
                "identity--afb340f8-edba-4952-8dce-71fdef6ec90e",
                "domain-name--649eaf78-676f-52fe-a165-911319aceda0",
                "mutex--ba1a71b9-af46-5543-968f-3e18936c35f1",
                "directory--45f7959e-0963-5fca-9127-a9724ff3a0b6",
                "windows-registry-key--863cdf7c-8790-50c9-8a9f-78361d359e13",
                "windows-registry-key--5badc5a7-25c4-54d7-b7ec-b27a730ed473",
                "indicator--f2e48931-9bb0-4a83-8bdd-8ccdabdba7d1",
                "indicator--d726a4ec-4305-475f-a35d-2dcc05c5890a",
                "indicator--66534358-7500-4919-8f95-dd8eac4bbc5b",
                "indicator--5e867143-f1f9-4520-9eeb-fbbb4a827fef",
                "indicator--f7eead85-3478-4cab-bf78-4a59371e568b",
                "indicator--0000edc3-cfb2-4629-8b9d-98141cbb24dd",
                "indicator--b03d9673-242e-459e-a43d-24a198f25895",
                "indicator--caf91906-8e03-4964-8f73-3e5253967abb",
                "indicator--fbb1e016-6ae9-413b-96ef-5208ae15a76f",
                "indicator--2bac0400-3625-4a55-8e7f-445870e5dd84",
                "indicator--f75ecb87-fa41-4eaa-8232-3b57c7f26f5d",
                "indicator--50698359-0cdf-4edd-8271-9914ecc87f67",
                "indicator--3abb6330-a65f-4f71-955a-76d82c649e62",
                "indicator--97a76ff1-5105-4e30-b646-1dd465d7c0e5",
                "indicator--6194f3b2-3066-41b3-9bdb-a132c36d1a03",
                "indicator--46cea1f3-aaba-4244-adcd-8038606372eb",
                "indicator--4e338b49-be37-40f7-8512-8fe25cf20555",
                "indicator--e72a8160-29b4-4f63-ba6f-fc17dec303b8",
                "relationship--766dd9d3-57db-4eda-bd48-46387ec9e576",
                "relationship--cb5a59bf-701c-4eeb-bae7-f07ea6e221b1",
                "relationship--4d60e5b8-72a5-46d4-8ddd-35a54f6e1767",
                "relationship--b8d9ec77-837f-44d4-a2ca-c90943434b39",
                "relationship--ffab99c2-304f-4a25-8a33-7ea413af37dc",
                "relationship--44d8f9fb-1344-46dc-8f1d-3581620cbb94",
                "relationship--4288e703-b4b3-4393-a8f8-14915383ed25",
                "relationship--c25c993e-2bbd-4a46-b3f5-a8a8a86f7d50",
                "relationship--56714033-4152-4e4e-a421-33e8af0c7c7b",
                "malware--605997e2-5736-4d3d-810b-76ef72341ae7",
                "identity--06ffe6dd-1a16-4b8c-8213-4dc8e927a838",
                "identity--f274e268-535c-49c1-8b28-54c284f380c8",
                "identity--d35f8162-cdb6-4f71-8192-c1c0da7deb67",
                "identity--a5c5b78b-cc61-48e5-828f-fd25943f20ba",
                "identity--8bc6aa90-81dc-4902-bc34-76565f9b49ee",
                "identity--93d32755-f95f-4bb7-9d04-122a2bed1c08",
                "identity--2bee02fa-bd29-4d0c-9845-92b36394b579",
                "identity--91ca12e6-ebf0-40e2-b335-e1f919a4c45e",
                "attack-pattern--8ad342bf-250a-4ca4-8467-cd430e2e5472",
                "attack-pattern--89e9c004-40a8-4ed4-b497-10a82725ef06",
                "attack-pattern--20ac46b8-6175-4c85-a477-041c3637699f",
                "attack-pattern--deae1c76-6efa-4280-a526-338073142746",
                "attack-pattern--73271dfb-df56-41cc-a6a7-c8e1c1752329",
                "attack-pattern--9a1d57f1-f0ff-4113-aac2-510aef50b1b4",
                "attack-pattern--24043317-4cf9-437b-b638-f7eba93030ab",
                "attack-pattern--3454bcc3-a021-4c74-a1b4-ab177ba83a29",
                "attack-pattern--75baa449-08bf-4021-8a1a-d5aca7bacb9d",
                "attack-pattern--62f7654b-2dba-42af-8902-79b96874a1ba",
                "attack-pattern--563fcd78-f720-411b-90b3-7a1a127e6186",
                "attack-pattern--88a88853-38d6-45b2-b7a8-64bb060e2860",
                "attack-pattern--d986fdc4-e6f6-4e7e-950b-5814888a7790",
                "attack-pattern--463363d2-a3e0-4a7e-ad28-1fe4d04676c1",
                "attack-pattern--6e4a38c7-79bd-472c-8f5a-aac9b9ba3332",
                "indicator--1c0831e7-cbdd-4203-80e5-a77488de5dcf",
                "indicator--bd691cdc-d181-45e8-bf3c-e41b59b22fa1",
                "indicator--d5ef94f3-3584-4915-ad91-7f35961ec8ad",
                "indicator--d9a2aa26-6dec-4d95-9962-23ff33596e26",
                "indicator--07a4d320-b460-430f-8f44-9631a0a04de9",
                "indicator--bd30282f-bab1-484c-9283-c0e309a6a742",
                "indicator--5f9a71e4-c020-4701-9545-78504d43e621",
                "indicator--bc4adfcb-841d-4e67-bee2-96ec81062ec3",
                "relationship--eb082c4f-e801-422e-8da1-820e1066e092",
                "relationship--fd925be3-5cde-4133-9aeb-4fd28d3ae8c9",
                "relationship--3bd0319d-42e4-42ed-a429-ba40f1b0b824",
                "relationship--7d38cca2-8256-43d5-a486-ee0b07e927a6",
                "relationship--c2c9c239-a8c8-4ef6-b4e9-233539488d47",
                "relationship--55628add-d8da-4a57-bfb9-f17b051f06ae",
                "relationship--54e3ae95-ab91-4895-8303-d886a4f5bdd6",
                "relationship--c82b38ef-49bc-482d-8626-8b26d873bc6c",
                "relationship--7b966133-76cb-45c0-89a1-19f42022033f",
                "relationship--5abf748d-bbe4-4667-9559-6182aa9f7ce2",
                "relationship--76b393e1-d69a-42e9-98ec-6727193943a9",
                "relationship--a590ca19-b998-4866-b349-e8c9b97cb4d9",
                "relationship--4d084dbd-d332-4181-93e8-fefbd6ff8701",
                "relationship--7daec25e-8ff7-4241-8ab8-3fd83b9d57b2",
                "relationship--bf4118e5-e6ae-4e93-9299-3378024c2302",
                "relationship--4a824306-3a20-44ac-8bdc-f511f3ecaaaf",
                "relationship--cc84fdce-dd4e-4549-974a-b705e68c65e6",
                "relationship--61cf647e-62a7-45ef-9dbc-749852532522",
                "relationship--ce0c353e-7350-41ee-bea8-8141f0dbd140",
                "relationship--cb14133d-24cf-431c-bcc6-7660840efc2e",
                "relationship--3ea6725b-e5ab-43ec-a2d1-08f363616cb3",
                "relationship--1b283de1-1339-46d4-885f-6be26b95709e",
                "relationship--31bb0da7-2cf2-4cba-8bc8-a1e817ec06b1",
                "relationship--2eb49675-beb1-430c-a4a9-db9ab089a265",
                "relationship--f9044636-269c-4e0a-90f2-3c77f5bce2fb",
                "relationship--493f3446-689a-44ce-9a7e-d1f94014b1e3",
                "relationship--2fa725e4-d20d-4318-9c6a-0891385a5fc7",
                "relationship--cfff10db-a2e8-4332-be13-58deb48317a4",
                "relationship--f639f500-135d-4213-9516-e29ac608c5bf",
                "relationship--edcbd284-29a5-42df-a698-5001236ae3e4",
                "relationship--a0af540f-d393-4383-bd90-869f1c7ca642",
                "relationship--76f8f3d8-ac57-485b-8a6c-cb0ff651ffbf",
                "relationship--4297a0f3-d697-4c77-8e6d-feb1dc447533",
                "relationship--71eedee5-1bc4-41c4-9ba4-e84109b1e78f",
                "relationship--0c0d164d-8930-4f69-92ac-a4f90239bbdb",
                "relationship--33db2771-2625-4103-a06b-c0588457fe0c",
                "relationship--b4ceceba-0252-4c0d-8d7c-01997157e5f4",
                "relationship--883a9908-face-41ca-ac46-ad05e6db26e4",
                "relationship--901138fc-aad0-463a-af5b-b4831edef83e",
                "relationship--ac33c8f8-734c-4aa2-9f2b-77e7f3628ca7",
                "relationship--8d3036de-f6f4-4986-a49c-affb4f25e664",
                "relationship--9c45b03f-6d8f-4ab5-9d76-ae8fba9e9fd0",
                "relationship--423c4737-58ec-464a-bcc6-61926f9f29e6",
                "relationship--35ac0762-36f6-445c-848c-198323f0c0d9",
                "relationship--3214926d-90b6-4035-9a85-5cecaad11adc",
                "relationship--8ea0f355-73de-4a2a-b940-09145f3daf37",
                "relationship--fe037a65-81da-4408-8ee3-2c7e3d67f709",
                "relationship--16d11330-44b3-407a-8c74-540b315a5f7b",
                "relationship--8ac6acdb-a71c-46e9-b98b-937ccd37c4f2"
            ],
            "object_marking_refs": [
                "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
            ]
        }
    ]
}