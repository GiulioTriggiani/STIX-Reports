{
    "type": "bundle",
    "id": "bundle--1b476097-72a7-4b9d-82ad-f7bb9cbf0910",
    "objects": [
        {
            "type": "identity",
            "spec_version": "2.1",
            "id": "identity--2520218d-f2a4-4d5d-81d2-5a8b1fe19667",
            "created": "2025-09-03T17:26:57.633589Z",
            "modified": "2025-09-03T17:26:57.633589Z",
            "name": "NCSC",
            "description": "The UK National Cyber Security Centre (NCSC) is the primary author and publisher of this threat report, providing technical analysis, detection rules, and recommendations regarding SparrowDoor.",
            "identity_class": "organization"
        },
        {
            "type": "marking-definition",
            "spec_version": "2.1",
            "id": "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9",
            "created": "2017-01-20T00:00:00.000Z",
            "definition_type": "tlp",
            "name": "TLP:WHITE",
            "definition": {
                "tlp": "white"
            }
        },
        {
            "type": "mutex",
            "spec_version": "2.1",
            "id": "mutex--ba1a71b9-af46-5543-968f-3e18936c35f1",
            "name": "Global\\gup0"
        },
        {
            "type": "indicator",
            "spec_version": "2.1",
            "id": "indicator--64b5edac-608d-4331-9339-e27c195fc23b",
            "created": "2025-09-03T17:25:11.209267Z",
            "modified": "2025-09-03T17:25:11.209267Z",
            "name": "SparrowDoor mutex",
            "description": "Mutex created by SparrowDoor to ensure only one instance runs.",
            "pattern": "[mutex:name = 'Global\\\\gup0']",
            "pattern_type": "stix",
            "pattern_version": "2.1",
            "valid_from": "2025-09-03T17:25:11.209254Z"
        },
        {
            "type": "indicator",
            "spec_version": "2.1",
            "id": "indicator--43ae7a9d-ec2b-4cea-b4e3-3dc749e97732",
            "created": "2025-09-03T17:25:11.210762Z",
            "modified": "2025-09-03T17:25:11.210762Z",
            "name": "Indicator for libcurl.dll (MD5)",
            "description": "MD5 hash of SparrowDoor loader (libcurl.dll).",
            "pattern": "[file:hashes.'MD5' = '46077a32e433a56eb8ba64dcbf86bc60']",
            "pattern_type": "stix",
            "pattern_version": "2.1",
            "valid_from": "2025-09-03T17:25:11.210754Z"
        },
        {
            "type": "indicator",
            "spec_version": "2.1",
            "id": "indicator--53da57ce-6b0e-4642-b242-ef59b5329461",
            "created": "2025-09-03T17:25:11.211696Z",
            "modified": "2025-09-03T17:25:11.211696Z",
            "name": "Indicator for libcurl.dll (SHA1)",
            "description": "SHA-1 hash of SparrowDoor loader (libcurl.dll).",
            "pattern": "[file:hashes.'SHA1' = '989b3798841d06e286eb083132242749c80fdd4d']",
            "pattern_type": "stix",
            "pattern_version": "2.1",
            "valid_from": "2025-09-03T17:25:11.211687Z"
        },
        {
            "type": "indicator",
            "spec_version": "2.1",
            "id": "indicator--b0937903-631c-4355-be7b-f793df3d092c",
            "created": "2025-09-03T17:25:11.21256Z",
            "modified": "2025-09-03T17:25:11.21256Z",
            "name": "Indicator for libcurl.dll (SHA256)",
            "description": "SHA-256 hash of SparrowDoor loader (libcurl.dll).",
            "pattern": "[file:hashes.'SHA256' = 'f19bb3b49d548bce4d35e9cf83fba112ef8e087a422b86d1376a395466fdff2d']",
            "pattern_type": "stix",
            "pattern_version": "2.1",
            "valid_from": "2025-09-03T17:25:11.212552Z"
        },
        {
            "type": "indicator",
            "spec_version": "2.1",
            "id": "indicator--68a88bd2-3382-4094-8220-a5217ed8e2a2",
            "created": "2025-09-03T17:25:11.213425Z",
            "modified": "2025-09-03T17:25:11.213425Z",
            "name": "Indicator for libhost.dll (MD5)",
            "description": "MD5 hash of SparrowDoor backdoor (libhost.dll).",
            "pattern": "[file:hashes.'MD5' = '8ad3f513f48f711d573d33b7419e3ed5']",
            "pattern_type": "stix",
            "pattern_version": "2.1",
            "valid_from": "2025-09-03T17:25:11.213418Z"
        },
        {
            "type": "indicator",
            "spec_version": "2.1",
            "id": "indicator--b31b03d8-f9d5-4d5b-9d7d-21f43eaaf523",
            "created": "2025-09-03T17:25:11.214225Z",
            "modified": "2025-09-03T17:25:11.214225Z",
            "name": "Indicator for libhost.dll (SHA1)",
            "description": "SHA-1 hash of SparrowDoor backdoor (libhost.dll).",
            "pattern": "[file:hashes.'SHA1' = 'c1890a6447c991880467b86a013dbeaa66cc615f']",
            "pattern_type": "stix",
            "pattern_version": "2.1",
            "valid_from": "2025-09-03T17:25:11.214218Z"
        },
        {
            "type": "indicator",
            "spec_version": "2.1",
            "id": "indicator--22739b69-437f-4b18-83c6-349713f96931",
            "created": "2025-09-03T17:25:11.215033Z",
            "modified": "2025-09-03T17:25:11.215033Z",
            "name": "Indicator for libhost.dll (SHA256)",
            "description": "SHA-256 hash of SparrowDoor backdoor (libhost.dll).",
            "pattern": "[file:hashes.'SHA256' = 'e0b107be8034976f6e91cfcc2bbc792b49ea61a071166968fec775af28b1f19c']",
            "pattern_type": "stix",
            "pattern_version": "2.1",
            "valid_from": "2025-09-03T17:25:11.215026Z"
        },
        {
            "type": "indicator",
            "spec_version": "2.1",
            "id": "indicator--87e33c45-b5ac-42b0-99a1-34a8e275a24e",
            "created": "2025-09-03T17:25:11.215869Z",
            "modified": "2025-09-03T17:25:11.215869Z",
            "name": "Indicator for SearchIndexer.exe (MD5)",
            "description": "MD5 hash of the renamed Notepad++ updater (SearchIndexer.exe) used by SparrowDoor.",
            "pattern": "[file:hashes.'MD5' = '5f983177f3f9ce6cb72088f3da96435d']",
            "pattern_type": "stix",
            "pattern_version": "2.1",
            "valid_from": "2025-09-03T17:25:11.215862Z"
        },
        {
            "type": "indicator",
            "spec_version": "2.1",
            "id": "indicator--f72454d0-1248-46a5-8219-8ba8a49e3aeb",
            "created": "2025-09-03T17:25:11.216867Z",
            "modified": "2025-09-03T17:25:11.216867Z",
            "name": "Indicator for SearchIndexer.exe (SHA1)",
            "description": "SHA-1 hash of the renamed Notepad++ updater (SearchIndexer.exe) used by SparrowDoor.",
            "pattern": "[file:hashes.'SHA1' = '1bb8f3f8c67199c36b26115442930d0108dc8e6a']",
            "pattern_type": "stix",
            "pattern_version": "2.1",
            "valid_from": "2025-09-03T17:25:11.216859Z"
        },
        {
            "type": "indicator",
            "spec_version": "2.1",
            "id": "indicator--5c920bce-4822-4680-996d-01e7cbfe3f1a",
            "created": "2025-09-03T17:25:11.217828Z",
            "modified": "2025-09-03T17:25:11.217828Z",
            "name": "Indicator for SearchIndexer.exe (SHA256)",
            "description": "SHA-256 hash of the renamed Notepad++ updater (SearchIndexer.exe) used by SparrowDoor.",
            "pattern": "[file:hashes.'SHA256' = '9863ac60b92fad160ce88353760c7c4f21f8e9c3190b18b374bdbca3a7d1a3fb']",
            "pattern_type": "stix",
            "pattern_version": "2.1",
            "valid_from": "2025-09-03T17:25:11.217819Z"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--0fdb640d-344d-4f89-ab07-e502c5f7e422",
            "created": "2025-09-03T17:25:11.210407Z",
            "modified": "2025-09-03T17:25:11.210407Z",
            "relationship_type": "based-on",
            "source_ref": "indicator--64b5edac-608d-4331-9339-e27c195fc23b",
            "target_ref": "mutex--ba1a71b9-af46-5543-968f-3e18936c35f1"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--9771ee78-f6f5-4eec-8459-01eaffb8f0d2",
            "created": "2025-09-03T17:25:11.218724Z",
            "modified": "2025-09-03T17:25:11.218724Z",
            "relationship_type": "derived-from",
            "source_ref": "indicator--43ae7a9d-ec2b-4cea-b4e3-3dc749e97732",
            "target_ref": "indicator--53da57ce-6b0e-4642-b242-ef59b5329461"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--ade20abf-1ed5-4ea7-858c-72a0d970617d",
            "created": "2025-09-03T17:25:11.21904Z",
            "modified": "2025-09-03T17:25:11.21904Z",
            "relationship_type": "derived-from",
            "source_ref": "indicator--43ae7a9d-ec2b-4cea-b4e3-3dc749e97732",
            "target_ref": "indicator--b0937903-631c-4355-be7b-f793df3d092c"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--cbe12626-7ee7-4132-9627-a11bbc2e47cf",
            "created": "2025-09-03T17:25:11.219355Z",
            "modified": "2025-09-03T17:25:11.219355Z",
            "relationship_type": "derived-from",
            "source_ref": "indicator--53da57ce-6b0e-4642-b242-ef59b5329461",
            "target_ref": "indicator--b0937903-631c-4355-be7b-f793df3d092c"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--1fa64bdb-746d-4933-bfd8-ff30252ab059",
            "created": "2025-09-03T17:25:11.219629Z",
            "modified": "2025-09-03T17:25:11.219629Z",
            "relationship_type": "derived-from",
            "source_ref": "indicator--68a88bd2-3382-4094-8220-a5217ed8e2a2",
            "target_ref": "indicator--b31b03d8-f9d5-4d5b-9d7d-21f43eaaf523"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--e1e30839-efae-4076-9ec6-8aea0b1bc692",
            "created": "2025-09-03T17:25:11.219888Z",
            "modified": "2025-09-03T17:25:11.219888Z",
            "relationship_type": "derived-from",
            "source_ref": "indicator--68a88bd2-3382-4094-8220-a5217ed8e2a2",
            "target_ref": "indicator--22739b69-437f-4b18-83c6-349713f96931"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--247624be-9b94-43bd-89f9-cad1ae03ef5a",
            "created": "2025-09-03T17:25:11.220421Z",
            "modified": "2025-09-03T17:25:11.220421Z",
            "relationship_type": "derived-from",
            "source_ref": "indicator--b31b03d8-f9d5-4d5b-9d7d-21f43eaaf523",
            "target_ref": "indicator--22739b69-437f-4b18-83c6-349713f96931"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--1a9312b3-05fc-4634-8a05-fe3278daf8c8",
            "created": "2025-09-03T17:25:11.220746Z",
            "modified": "2025-09-03T17:25:11.220746Z",
            "relationship_type": "derived-from",
            "source_ref": "indicator--87e33c45-b5ac-42b0-99a1-34a8e275a24e",
            "target_ref": "indicator--f72454d0-1248-46a5-8219-8ba8a49e3aeb"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--fb3aa721-4630-4ae1-b151-2fea67640b37",
            "created": "2025-09-03T17:25:11.221034Z",
            "modified": "2025-09-03T17:25:11.221034Z",
            "relationship_type": "derived-from",
            "source_ref": "indicator--87e33c45-b5ac-42b0-99a1-34a8e275a24e",
            "target_ref": "indicator--5c920bce-4822-4680-996d-01e7cbfe3f1a"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--a9a94594-50bc-4ae7-820f-e5fd1c2d93e8",
            "created": "2025-09-03T17:25:11.221342Z",
            "modified": "2025-09-03T17:25:11.221342Z",
            "relationship_type": "derived-from",
            "source_ref": "indicator--f72454d0-1248-46a5-8219-8ba8a49e3aeb",
            "target_ref": "indicator--5c920bce-4822-4680-996d-01e7cbfe3f1a"
        },
        {
            "type": "malware",
            "spec_version": "2.1",
            "id": "malware--6a537e99-ca9b-4455-a374-63d2096041ed",
            "created_by_ref": "identity--2520218d-f2a4-4d5d-81d2-5a8b1fe19667",
            "created": "2025-09-03T17:26:57.634076Z",
            "modified": "2025-09-03T17:26:57.634076Z",
            "name": "sparrowdoor",
            "description": "SparrowDoor is a persistent 32-bit loader and backdoor targeting the Windows operating system. It employs reflective loading of a PE payload without headers, implements multiple defence evasion techniques including inline hooks and AV detection, communicates with its command and control (C2) server over HTTPS, and supports various tasking commands such as reading/writing files, opening a reverse shell, clipboard logging, and token impersonation. The malware uses XOR encoding for its C2 channel, hooks several Windows API functions for user impersonation and socket control, and maintains persistence via Windows Service installation or registry Run key. It is designed to evade detection and frustrate analysis, including anti-analysis features like custom file formats and obfuscated configuration.",
            "malware_types": [
                "backdoor",
                "remote-access-trojan"
            ],
            "is_family": true
        },
        {
            "type": "identity",
            "spec_version": "2.1",
            "id": "identity--db097fa0-dee0-4cf1-9556-82a2e0a59c1f",
            "created": "2025-09-03T17:26:57.634446Z",
            "modified": "2025-09-03T17:26:57.634446Z",
            "name": "ESET",
            "description": "ESET is referenced as the organization that previously reported on SparrowDoor in September 2021 and contributed to industry knowledge about the malware family.",
            "identity_class": "organization"
        },
        {
            "type": "indicator",
            "spec_version": "2.1",
            "id": "indicator--fb546e27-275e-4e7c-a283-ffb6b36cf112",
            "created_by_ref": "identity--2520218d-f2a4-4d5d-81d2-5a8b1fe19667",
            "created": "2025-09-03T17:26:57.634719Z",
            "modified": "2025-09-03T17:26:57.634719Z",
            "name": "SparrowDoor_apipatch",
            "description": "YARA rule to detect related activity.",
            "pattern": "rule SparrowDoor_apipatch {\n    meta:\n        author = \"NCSC\"\n        description = \"Identifies code segments in SparrowDoor responsible for patching APIs. No MZ/PE match as the backdoor has no header. Targeting in memory.\"\n        date = \"2022-02-28\"\n        hash1 = \"c1890a6447c991880467b86a013dbeaa66cc615f\"\n    strings:\n        $save = {8B 06 89 07 8A 4E 04}\n        $vp_1 = {89 10 8A 4E 04 8B D6 2B D0 88 48 04 83 EA 05 C6 40 05 E9 89 50 06}\n        $vp_2 = {50 8B D6 6A 40 2B D7 88 4F 04 83 EA 05 6A 05 C6 47 05 E9 89 57 06 56}\n        $vp_3 = {51 52 2B DE 6A 05 83 EB 05 56 C6 06 E9 89 5E 01}\n        $va = {6A 40 68 00 10 00 00 68 00 10 00 00 6A 00}\n        $s_patch = {50 68 7F FF FF FF 68 FF FF 00 00 56}\n    condition:\n        3 of them\n}",
            "pattern_type": "yara",
            "valid_from": "2025-09-03T17:26:57.634708Z"
        },
        {
            "type": "indicator",
            "spec_version": "2.1",
            "id": "indicator--82c316d3-b2ad-4036-be86-8c00dd2dd816",
            "created_by_ref": "identity--2520218d-f2a4-4d5d-81d2-5a8b1fe19667",
            "created": "2025-09-03T17:26:57.635084Z",
            "modified": "2025-09-03T17:26:57.635084Z",
            "name": "SparrowDoor_clipshot",
            "description": "YARA rule to detect related activity.",
            "pattern": "import \"pe\"\nrule SparrowDoor_clipshot {\n    meta:\n        author = \"NCSC\"\n        description = \"The SparrowDoor loader contains a feature it calls clipshot, which logs clipboard data to a file.\"\n        date = \"2022-02-28\"\n        hash1 = \"989b3798841d06e286eb083132242749c80fdd4d\"\n    strings:\n        $exsting_cmp = {8B 1E 3B 19 75 ?? 83 E8 04 83 C1 04 83 C6 04 83 F8 04}\n        $time_format_string = \"%d/%d/%d %d:%d\" ascii\n        $cre_fil_args = {6A 00 68 80 00 00 00 6A 04 6A 00 6A 02 68 00 00 00 40 52}\n    condition:\n        (uint16(0) == 0x5A4D) and uint32(uint32(0x3C)) == 0x00004550 and all of them and (pe.imports(\"User32.dll\",\"OpenClipboard\") and pe.imports(\"User32.dll\",\"GetClipboardData\") and pe.imports(\"Kernel32.dll\",\"GetLocalTime\") and pe.imports(\"Kernel32.dll\",\"GlobalSize\"))\n}",
            "pattern_type": "yara",
            "valid_from": "2025-09-03T17:26:57.635075Z"
        },
        {
            "type": "indicator",
            "spec_version": "2.1",
            "id": "indicator--bed2766f-411c-4a4d-99dd-99de00b4bd26",
            "created_by_ref": "identity--2520218d-f2a4-4d5d-81d2-5a8b1fe19667",
            "created": "2025-09-03T17:26:57.6354Z",
            "modified": "2025-09-03T17:26:57.6354Z",
            "name": "SparrowDoor_config",
            "description": "YARA rule to detect related activity.",
            "pattern": "rule SparrowDoor_config {\n    meta:\n        author = \"NCSC\"\n        description = \"Targets the XOR encoded loader config and shellcode in the file libhost.dll using the known position of the XOR key.\"\n        date = \"2022-02-28\"\n        hash1 = \"c1890a6447c991880467b86a013dbeaa66cc615f\"\n    condition:\n        (uint16(0) != 0x5A4D) and\n        (uint16(0) != 0x8b55) and\n        (uint32(0) ^ uint32(0x4c) ==  0x00) and\n        (uint32(0) ^ uint32(0x34) ==  0x00) and\n        (uint16(0) ^ uint16(0x50) ==  0x8b55)\n}",
            "pattern_type": "yara",
            "valid_from": "2025-09-03T17:26:57.635392Z"
        },
        {
            "type": "indicator",
            "spec_version": "2.1",
            "id": "indicator--4f1c4bbd-765f-4fb9-9cd1-9d9c2e5fb70c",
            "created_by_ref": "identity--2520218d-f2a4-4d5d-81d2-5a8b1fe19667",
            "created": "2025-09-03T17:26:57.635685Z",
            "modified": "2025-09-03T17:26:57.635685Z",
            "name": "SparrowDoor_loader",
            "description": "YARA rule to detect related activity.",
            "pattern": "rule SparrowDoor_loader {\n    meta:\n        author = \"NCSC\"\n        description = \"Targets code features of the SparrowDoor loader. This rule detects the previous variant and this new variant.\"\n        date = \"2022-02-28\"\n        hash1 = \"989b3798841d06e286eb083132242749c80fdd4d\"\n    strings:\n        $xor_algo = {8B D0 83 E2 03 8A 54 14 10 30 14 30 40 3B C1}\n        $rva = {8D B0 [4] 8D 44 24 ?? 50 6A 40 6A 05 56}\n        $lj = {2B CE 83 E9 05 8D [3] 52 C6 06 E9 89 4E 01 8B [3] 50 6A 05 56}\n    condition:\n        (uint16(0) == 0x5A4D) and uint32(uint32(0x3C)) == 0x00004550 and all of them\n}",
            "pattern_type": "yara",
            "valid_from": "2025-09-03T17:26:57.635678Z"
        },
        {
            "type": "indicator",
            "spec_version": "2.1",
            "id": "indicator--e55500d1-3047-460d-953b-94b76cf77175",
            "created_by_ref": "identity--2520218d-f2a4-4d5d-81d2-5a8b1fe19667",
            "created": "2025-09-03T17:26:57.635973Z",
            "modified": "2025-09-03T17:26:57.635973Z",
            "name": "SparrowDoor_shellcode",
            "description": "YARA rule to detect related activity.",
            "pattern": "rule SparrowDoor_shellcode {\n    meta:\n        author = \"NCSC\"\n        description = \"Targets code features of the reflective loader for SparrowDoor. Targeting in memory.\"\n        date = \"2022-02-28\"\n        hash1 = \"c1890a6447c991880467b86a013dbeaa66cc615f\"\n    strings:\n        $peb = {8B 48 08 89 4D FC 8B 51 3C 8B 54 0A 78 8B 74 0A 20 03 D1 03 F1 B3 64}\n        $getp_match = {8B 06 03 C1 80 38 47 75 34 80 78 01 65 75 2E 80 78 02 74 75 28 80 78 03 50 75 22 80 78 04 72 75 1C 80 78 06 63 75 16 80 78 05 6F 75 10 80 78 07 41 75 0A}\n        $k_check = {8B 48 20 8A 09 80 F9 6B 74 05 80 F9 4B 75 05}\n        $resolve_load_lib = {C7 45 C4 4C 6F 61 64 C7 45 C8 4C 69 62 72 C7 45 CC 61 72 79 41 C7 45 D0 00 00 00 00 FF 75 FC FF 55 E4}\n    condition:\n        3 of them\n}",
            "pattern_type": "yara",
            "valid_from": "2025-09-03T17:26:57.635967Z"
        },
        {
            "type": "indicator",
            "spec_version": "2.1",
            "id": "indicator--5d3b10e7-ef4a-47a4-91ce-e815e1f9b411",
            "created_by_ref": "identity--2520218d-f2a4-4d5d-81d2-5a8b1fe19667",
            "created": "2025-09-03T17:26:57.636271Z",
            "modified": "2025-09-03T17:26:57.636271Z",
            "name": "SparrowDoor_sleep_routine",
            "description": "YARA rule to detect related activity.",
            "pattern": "rule SparrowDoor_sleep_routine {\n    meta:\n        author = \"NCSC\"\n        description = \"SparrowDoor implements a Sleep routine with value seeded on GetTickCount. This signature detects the previous and this variant of SparrowDoor. No MZ/PE match as the backdoor has no header. Targeting in memory.\"\n        date = \"2022-02-28\"\n        hash1 = \"c1890a6447c991880467b86a013dbeaa66cc615f\"\n    strings:\n        $sleep = {FF D7 33 D2 B9 [4] F7 F1 81 C2 [4] 8B C2 C1 E0 04 2B C2 03 C0 03 C0 03 C0 50}\n    condition:\n        all of them\n}",
            "pattern_type": "yara",
            "valid_from": "2025-09-03T17:26:57.636264Z"
        },
        {
            "type": "indicator",
            "spec_version": "2.1",
            "id": "indicator--f132ea37-ee66-4557-a8be-d82ad84a94e9",
            "created_by_ref": "identity--2520218d-f2a4-4d5d-81d2-5a8b1fe19667",
            "created": "2025-09-03T17:26:57.636541Z",
            "modified": "2025-09-03T17:26:57.636541Z",
            "name": "SparrowDoor_xor",
            "description": "YARA rule to detect related activity.",
            "pattern": "rule SparrowDoor_xor {\n    meta:\n        author = \"NCSC\"\n        description = \"Highlights XOR routines in SparrowDoor. No MZ/PE match as the backdoor has no header. Targeting in memory.\"\n        date = \"2022-02-28\"\n        hash1 = \"c1890a6447c991880467b86a013dbeaa66cc615f\"\n    strings:\n        $xor_routine_outbound = {B8 39 8E E3 38 F7 E1 D1 EA 8D 14 D2 8B C1 2B C2 8A [4] 00 30 14 39 41 3B CE}\n        $xor_routine_inbound = {B8 25 49 92 24 F7 E1 8B C1 2B C2 D1 E8 03 C2 C1 E8 02 8D 14 C5 [4] 2B D0 8B C1 2B C2}\n        $xor_routine_config = {8B D9 83 E3 07 0F [6] 30 18 8D 1C 07 83 E3 07 0F [6] 30 58 01 8D 1C 28 83 E3 07 0F [6] 30 58 02 8D 1C 02 83 E3 07 0F [6] 30 58 03 8B DE 83 E3 07 0F [6] 30 58 04 83 C6 05 83 C1 05}\n    condition:\n        2 of them\n}",
            "pattern_type": "yara",
            "valid_from": "2025-09-03T17:26:57.636534Z"
        },
        {
            "type": "indicator",
            "spec_version": "2.1",
            "id": "indicator--3a5bc801-0ac7-40ef-af8b-ba3eae0d9cc9",
            "created_by_ref": "identity--2520218d-f2a4-4d5d-81d2-5a8b1fe19667",
            "created": "2025-09-03T17:26:57.636811Z",
            "modified": "2025-09-03T17:26:57.636811Z",
            "name": "SparrowDoor_strings",
            "description": "YARA rule to detect related activity.",
            "pattern": "rule SparrowDoor_strings {\n    meta:\n        author = \"NCSC\"\n        description = \"Strings that appear in SparrowDoor's backdoor. Targeting in memory.\"\n        date = \"2022-02-28\"\n        hash1 = \"c1890a6447c991880467b86a013dbeaa66cc615f\"\n    strings:\n        $reg = \"Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run\" ascii\n        $http_headers = {55 73 65 72 2D 41 67 65 6E 74 3A 20 4D 6F 7A 69 6C 6C 61 2F 34 2E 30 20 28 63 6F 6D 70 61 74 69 62 6C 65 3B 20 4D 53 49 45 20 35 2E 30 3B 20 57 69 6E 64 6F 77 73 20 4E 54 20 35 2E 30 29 0D 0A 41 63 63 65 70 74 2D 4C 61 6E 67 75 61 67 65 3A 20 65 6E 2D 55 53 0D 0A 41 63 63 65 70 74 3A 20 2A 2F 2A 0D 0A}\n        $http_proxy = \"HTTPS=HTTPS://%s:%d\" ascii\n        $debug = \"SeDebugPrivilege\" ascii\n        $av1 = \"avp.exe\" ascii\n        $av2 = \"ZhuDongFangYu.exe\" ascii\n        $av3 = \"egui.exe\" ascii\n        $av4 = \"TMBMSRV.exe\" ascii\n        $av5 = \"ccSetMgr.exe\" ascii\n        $clipshot = \"clipshot\" ascii\n        $ComSpec =  \"ComSpec\" ascii\n        $export = \"curl_easy_init\" ascii\n    condition:\n        10 of them\n}",
            "pattern_type": "yara",
            "valid_from": "2025-09-03T17:26:57.636805Z"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--9794a555-8a0a-4333-8fc5-d85d426679b6",
            "created_by_ref": "identity--2520218d-f2a4-4d5d-81d2-5a8b1fe19667",
            "created": "2025-09-03T17:26:57.637124Z",
            "modified": "2025-09-03T17:26:57.637124Z",
            "name": "Create or Modify System Process: Windows Service",
            "description": "SparrowDoor achieves persistence by installing SearchIndexer.exe as a Windows service, using parameters defined in the malware configuration.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "persistence"
                }
            ],
            "external_references": [
                {
                    "source_name": "mitre-attack",
                    "url": "https://attack.mitre.org/techniques/T1543/003",
                    "external_id": "T1543.003"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--b4e91855-911e-4c10-98de-37c4361f9604",
            "created_by_ref": "identity--2520218d-f2a4-4d5d-81d2-5a8b1fe19667",
            "created": "2025-09-03T17:26:57.637558Z",
            "modified": "2025-09-03T17:26:57.637558Z",
            "name": "Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder",
            "description": "If SparrowDoor fails to persist as a Windows Service, it installs SearchIndexer.exe in the CurrentVersion\\Run key.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "persistence"
                }
            ],
            "external_references": [
                {
                    "source_name": "mitre-attack",
                    "url": "https://attack.mitre.org/techniques/T1547/001",
                    "external_id": "T1547.001"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--0b7c462f-021d-41ff-b243-297232e54b3f",
            "created_by_ref": "identity--2520218d-f2a4-4d5d-81d2-5a8b1fe19667",
            "created": "2025-09-03T17:26:57.637905Z",
            "modified": "2025-09-03T17:26:57.637905Z",
            "name": "Access Token Manipulation: Token Impersonation/Theft",
            "description": "SparrowDoor impersonates the user account token associated with the explorer.exe process.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "defense-evasion"
                }
            ],
            "external_references": [
                {
                    "source_name": "mitre-attack",
                    "url": "https://attack.mitre.org/techniques/T1134/001",
                    "external_id": "T1134.001"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--ce521d44-451e-4441-8ebb-3b291755b1d7",
            "created_by_ref": "identity--2520218d-f2a4-4d5d-81d2-5a8b1fe19667",
            "created": "2025-09-03T17:26:57.638318Z",
            "modified": "2025-09-03T17:26:57.638318Z",
            "name": "Deobfuscate/Decode Files or Information",
            "description": "The SparrowDoor malware file libhost.dll is obfuscated with a 4-byte XOR key and the configuration is obfuscated with an 8-byte XOR key.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "defense-evasion"
                }
            ],
            "external_references": [
                {
                    "source_name": "mitre-attack",
                    "url": "https://attack.mitre.org/techniques/T1140",
                    "external_id": "T1140"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--9c1be1dd-1099-4ed8-9107-216b89b6cd1c",
            "created_by_ref": "identity--2520218d-f2a4-4d5d-81d2-5a8b1fe19667",
            "created": "2025-09-03T17:26:57.638678Z",
            "modified": "2025-09-03T17:26:57.638678Z",
            "name": "Hijack Execution Flow: DLL Side-Loading",
            "description": "The SparrowDoor malware gains execution when the malware file libcurl.dll is side-loaded by SearchIndexer.exe.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "defense-evasion"
                }
            ],
            "external_references": [
                {
                    "source_name": "mitre-attack",
                    "url": "https://attack.mitre.org/techniques/T1574/002",
                    "external_id": "T1574.002"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--82b3f3c0-d641-4e22-b2d7-cba6e1e78a75",
            "created_by_ref": "identity--2520218d-f2a4-4d5d-81d2-5a8b1fe19667",
            "created": "2025-09-03T17:26:57.639034Z",
            "modified": "2025-09-03T17:26:57.639034Z",
            "name": "Process Injection: Portable Executable Injection",
            "description": "SparrowDoor injects itself into a spawned and suspended instance of svchost.exe during initialisation.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "defense-evasion"
                }
            ],
            "external_references": [
                {
                    "source_name": "mitre-attack",
                    "url": "https://attack.mitre.org/techniques/T1055/012",
                    "external_id": "T1055.012"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--d9c2bb8b-f552-4afa-8e6d-9221074e27c4",
            "created_by_ref": "identity--2520218d-f2a4-4d5d-81d2-5a8b1fe19667",
            "created": "2025-09-03T17:26:57.639403Z",
            "modified": "2025-09-03T17:26:57.639403Z",
            "name": "Indicator Removal on Host: File Deletion",
            "description": "SparrowDoor can be tasked to remove arbitrary files from the host. It can also be tasked to delete files specific to the malware execution i.e. a clean-up routine.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "defense-evasion"
                }
            ],
            "external_references": [
                {
                    "source_name": "mitre-attack",
                    "url": "https://attack.mitre.org/techniques/T1070/004",
                    "external_id": "T1070.004"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--c3563b0e-bd88-4462-bf06-8eca52ef94b3",
            "created_by_ref": "identity--2520218d-f2a4-4d5d-81d2-5a8b1fe19667",
            "created": "2025-09-03T17:26:57.639773Z",
            "modified": "2025-09-03T17:26:57.639773Z",
            "name": "Reflective Code Loading",
            "description": "SparrowDoor is loaded by a reflective loader found in libhost.dll.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "defense-evasion"
                }
            ],
            "external_references": [
                {
                    "source_name": "mitre-attack",
                    "url": "https://attack.mitre.org/techniques/T1620",
                    "external_id": "T1620"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--177a3fa9-daaa-4309-8063-b4fecc75e305",
            "created_by_ref": "identity--2520218d-f2a4-4d5d-81d2-5a8b1fe19667",
            "created": "2025-09-03T17:26:57.640158Z",
            "modified": "2025-09-03T17:26:57.640158Z",
            "name": "Masquerading: Match Legitimate Name or Location",
            "description": "A legitimate and signed Notepad++ updater has been renamed SearchIndexer.exe, which is the name of a legitimate Windows binary. This file is used to load SparrowDoor. The malware also uses the name libcurl.dll for its loader, libcurl is a legitimate project.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "defense-evasion"
                }
            ],
            "external_references": [
                {
                    "source_name": "mitre-attack",
                    "url": "https://attack.mitre.org/techniques/T1036/005",
                    "external_id": "T1036.005"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--7309eb80-d725-4073-b6cb-ec7948854b1b",
            "created_by_ref": "identity--2520218d-f2a4-4d5d-81d2-5a8b1fe19667",
            "created": "2025-09-03T17:26:57.640505Z",
            "modified": "2025-09-03T17:26:57.640505Z",
            "name": "Signed Binary Proxy Execution",
            "description": "SparrowDoor is side-loaded into, and hijacks execution of, a signed Notepad++ updater.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "defense-evasion"
                }
            ],
            "external_references": [
                {
                    "source_name": "mitre-attack",
                    "url": "https://attack.mitre.org/techniques/T1218",
                    "external_id": "T1218"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--4ba83f84-e0bc-4c08-9d77-97a0673bd36e",
            "created_by_ref": "identity--2520218d-f2a4-4d5d-81d2-5a8b1fe19667",
            "created": "2025-09-03T17:26:57.640836Z",
            "modified": "2025-09-03T17:26:57.640836Z",
            "name": "Software Discovery: Security Software Discovery",
            "description": "SparrowDoor checks the running processes against a list of hardcoded AV names.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "discovery"
                }
            ],
            "external_references": [
                {
                    "source_name": "mitre-attack",
                    "url": "https://attack.mitre.org/techniques/T1518/001",
                    "external_id": "T1518.001"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--912c4019-7b40-488a-a52a-669766124218",
            "created_by_ref": "identity--2520218d-f2a4-4d5d-81d2-5a8b1fe19667",
            "created": "2025-09-03T17:26:57.641218Z",
            "modified": "2025-09-03T17:26:57.641218Z",
            "name": "Application Layer Protocol: Web Protocols",
            "description": "SparrowDoor uses HTTPS as a Command and control (C2) channel and is proxy aware.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "command-and-control"
                }
            ],
            "external_references": [
                {
                    "source_name": "mitre-attack",
                    "url": "https://attack.mitre.org/techniques/T1071/001",
                    "external_id": "T1071.001"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--c3abd22f-f47b-40c2-a622-36058048191f",
            "created_by_ref": "identity--2520218d-f2a4-4d5d-81d2-5a8b1fe19667",
            "created": "2025-09-03T17:26:57.641568Z",
            "modified": "2025-09-03T17:26:57.641568Z",
            "name": "Encrypted Channel: Symmetric Cryptography",
            "description": "SparrowDoor uses static XOR keys to encode data when it is being sent or received over the C2 channel.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "command-and-control"
                }
            ],
            "external_references": [
                {
                    "source_name": "mitre-attack",
                    "url": "https://attack.mitre.org/techniques/T1573/001",
                    "external_id": "T1573.001"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--09e2f32e-5f85-4760-9bf4-2a3a5b79154d",
            "created_by_ref": "identity--2520218d-f2a4-4d5d-81d2-5a8b1fe19667",
            "created": "2025-09-03T17:26:57.641903Z",
            "modified": "2025-09-03T17:26:57.641903Z",
            "name": "Clipboard Data",
            "description": "SparrowDoor can be tasked to launch clipboard logging functionality.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "collection"
                }
            ],
            "external_references": [
                {
                    "source_name": "mitre-attack",
                    "url": "https://attack.mitre.org/techniques/T1115",
                    "external_id": "T1115"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--f1ae2cc3-1594-46d9-9b3d-f5aa502bb508",
            "created_by_ref": "identity--2520218d-f2a4-4d5d-81d2-5a8b1fe19667",
            "created": "2025-09-03T17:26:57.642283Z",
            "modified": "2025-09-03T17:26:57.642283Z",
            "name": "Exfiltration Over C2 Channel",
            "description": "SparrowDoor can be tasked to exfiltrate files from disk.",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "exfiltration"
                }
            ],
            "external_references": [
                {
                    "source_name": "mitre-attack",
                    "url": "https://attack.mitre.org/techniques/T1041",
                    "external_id": "T1041"
                }
            ]
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--56707e6b-99eb-4dc8-8d79-c1ade6389912",
            "created_by_ref": "identity--2520218d-f2a4-4d5d-81d2-5a8b1fe19667",
            "created": "2025-09-03T17:26:57.642759Z",
            "modified": "2025-09-03T17:26:57.642759Z",
            "relationship_type": "uses",
            "source_ref": "malware--6a537e99-ca9b-4455-a374-63d2096041ed",
            "target_ref": "attack-pattern--9794a555-8a0a-4333-8fc5-d85d426679b6"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--a533e173-9e5b-46e3-b531-439966443100",
            "created_by_ref": "identity--2520218d-f2a4-4d5d-81d2-5a8b1fe19667",
            "created": "2025-09-03T17:26:57.643075Z",
            "modified": "2025-09-03T17:26:57.643075Z",
            "relationship_type": "uses",
            "source_ref": "malware--6a537e99-ca9b-4455-a374-63d2096041ed",
            "target_ref": "attack-pattern--b4e91855-911e-4c10-98de-37c4361f9604"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--57d3b6b4-c1c6-401c-9b3b-860c22947831",
            "created_by_ref": "identity--2520218d-f2a4-4d5d-81d2-5a8b1fe19667",
            "created": "2025-09-03T17:26:57.643568Z",
            "modified": "2025-09-03T17:26:57.643568Z",
            "relationship_type": "uses",
            "source_ref": "malware--6a537e99-ca9b-4455-a374-63d2096041ed",
            "target_ref": "attack-pattern--0b7c462f-021d-41ff-b243-297232e54b3f"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--1a8d1c91-f228-405b-9873-da1ba5381825",
            "created_by_ref": "identity--2520218d-f2a4-4d5d-81d2-5a8b1fe19667",
            "created": "2025-09-03T17:26:57.643897Z",
            "modified": "2025-09-03T17:26:57.643897Z",
            "relationship_type": "uses",
            "source_ref": "malware--6a537e99-ca9b-4455-a374-63d2096041ed",
            "target_ref": "attack-pattern--ce521d44-451e-4441-8ebb-3b291755b1d7"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--ef42b893-9d2a-4697-9e64-96d30ae916cf",
            "created_by_ref": "identity--2520218d-f2a4-4d5d-81d2-5a8b1fe19667",
            "created": "2025-09-03T17:26:57.644321Z",
            "modified": "2025-09-03T17:26:57.644321Z",
            "relationship_type": "uses",
            "source_ref": "malware--6a537e99-ca9b-4455-a374-63d2096041ed",
            "target_ref": "attack-pattern--9c1be1dd-1099-4ed8-9107-216b89b6cd1c"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--b18ae015-def2-4181-aca2-0c74f8dbfa88",
            "created_by_ref": "identity--2520218d-f2a4-4d5d-81d2-5a8b1fe19667",
            "created": "2025-09-03T17:26:57.64459Z",
            "modified": "2025-09-03T17:26:57.64459Z",
            "relationship_type": "uses",
            "source_ref": "malware--6a537e99-ca9b-4455-a374-63d2096041ed",
            "target_ref": "attack-pattern--82b3f3c0-d641-4e22-b2d7-cba6e1e78a75"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--8975e10a-8948-4e75-8273-44e4dbb558dd",
            "created_by_ref": "identity--2520218d-f2a4-4d5d-81d2-5a8b1fe19667",
            "created": "2025-09-03T17:26:57.644853Z",
            "modified": "2025-09-03T17:26:57.644853Z",
            "relationship_type": "uses",
            "source_ref": "malware--6a537e99-ca9b-4455-a374-63d2096041ed",
            "target_ref": "attack-pattern--d9c2bb8b-f552-4afa-8e6d-9221074e27c4"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--c213860d-b163-4444-8c96-923360a0dcbd",
            "created_by_ref": "identity--2520218d-f2a4-4d5d-81d2-5a8b1fe19667",
            "created": "2025-09-03T17:26:57.645157Z",
            "modified": "2025-09-03T17:26:57.645157Z",
            "relationship_type": "uses",
            "source_ref": "malware--6a537e99-ca9b-4455-a374-63d2096041ed",
            "target_ref": "attack-pattern--c3563b0e-bd88-4462-bf06-8eca52ef94b3"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--f8fe649c-8f68-4194-b302-0ee27f685e00",
            "created_by_ref": "identity--2520218d-f2a4-4d5d-81d2-5a8b1fe19667",
            "created": "2025-09-03T17:26:57.645436Z",
            "modified": "2025-09-03T17:26:57.645436Z",
            "relationship_type": "uses",
            "source_ref": "malware--6a537e99-ca9b-4455-a374-63d2096041ed",
            "target_ref": "attack-pattern--177a3fa9-daaa-4309-8063-b4fecc75e305"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--d7ab4c5e-b3ac-4864-a6e3-85978cfc07a0",
            "created_by_ref": "identity--2520218d-f2a4-4d5d-81d2-5a8b1fe19667",
            "created": "2025-09-03T17:26:57.645704Z",
            "modified": "2025-09-03T17:26:57.645704Z",
            "relationship_type": "uses",
            "source_ref": "malware--6a537e99-ca9b-4455-a374-63d2096041ed",
            "target_ref": "attack-pattern--7309eb80-d725-4073-b6cb-ec7948854b1b"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--8a33b929-28bc-483b-ad64-4771ff50ed20",
            "created_by_ref": "identity--2520218d-f2a4-4d5d-81d2-5a8b1fe19667",
            "created": "2025-09-03T17:26:57.645992Z",
            "modified": "2025-09-03T17:26:57.645992Z",
            "relationship_type": "uses",
            "source_ref": "malware--6a537e99-ca9b-4455-a374-63d2096041ed",
            "target_ref": "attack-pattern--4ba83f84-e0bc-4c08-9d77-97a0673bd36e"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--12daa7ef-6e5c-4265-ac47-0f41e2dce5fa",
            "created_by_ref": "identity--2520218d-f2a4-4d5d-81d2-5a8b1fe19667",
            "created": "2025-09-03T17:26:57.646277Z",
            "modified": "2025-09-03T17:26:57.646277Z",
            "relationship_type": "uses",
            "source_ref": "malware--6a537e99-ca9b-4455-a374-63d2096041ed",
            "target_ref": "attack-pattern--912c4019-7b40-488a-a52a-669766124218"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--c613cdea-5be9-45d8-b4e5-5e3e6a385fff",
            "created_by_ref": "identity--2520218d-f2a4-4d5d-81d2-5a8b1fe19667",
            "created": "2025-09-03T17:26:57.646562Z",
            "modified": "2025-09-03T17:26:57.646562Z",
            "relationship_type": "uses",
            "source_ref": "malware--6a537e99-ca9b-4455-a374-63d2096041ed",
            "target_ref": "attack-pattern--c3abd22f-f47b-40c2-a622-36058048191f"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--0a95d5c8-f659-44c5-bbab-034f2e130176",
            "created_by_ref": "identity--2520218d-f2a4-4d5d-81d2-5a8b1fe19667",
            "created": "2025-09-03T17:26:57.646826Z",
            "modified": "2025-09-03T17:26:57.646826Z",
            "relationship_type": "uses",
            "source_ref": "malware--6a537e99-ca9b-4455-a374-63d2096041ed",
            "target_ref": "attack-pattern--09e2f32e-5f85-4760-9bf4-2a3a5b79154d"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--af479201-6044-4c5f-ab1f-91fd637769ad",
            "created_by_ref": "identity--2520218d-f2a4-4d5d-81d2-5a8b1fe19667",
            "created": "2025-09-03T17:26:57.647117Z",
            "modified": "2025-09-03T17:26:57.647117Z",
            "relationship_type": "uses",
            "source_ref": "malware--6a537e99-ca9b-4455-a374-63d2096041ed",
            "target_ref": "attack-pattern--f1ae2cc3-1594-46d9-9b3d-f5aa502bb508"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--d4b24efc-e1ed-4606-bcf8-cf885ec8e4ba",
            "created_by_ref": "identity--2520218d-f2a4-4d5d-81d2-5a8b1fe19667",
            "created": "2025-09-03T17:26:57.64768Z",
            "modified": "2025-09-03T17:26:57.64768Z",
            "relationship_type": "indicates",
            "source_ref": "indicator--64b5edac-608d-4331-9339-e27c195fc23b",
            "target_ref": "malware--6a537e99-ca9b-4455-a374-63d2096041ed"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--ae140722-6e39-4150-a8d6-b6a177283133",
            "created_by_ref": "identity--2520218d-f2a4-4d5d-81d2-5a8b1fe19667",
            "created": "2025-09-03T17:26:57.648097Z",
            "modified": "2025-09-03T17:26:57.648097Z",
            "relationship_type": "indicates",
            "source_ref": "indicator--43ae7a9d-ec2b-4cea-b4e3-3dc749e97732",
            "target_ref": "malware--6a537e99-ca9b-4455-a374-63d2096041ed"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--e1d7b732-44ca-4741-95d7-8793e10c2f71",
            "created_by_ref": "identity--2520218d-f2a4-4d5d-81d2-5a8b1fe19667",
            "created": "2025-09-03T17:26:57.648422Z",
            "modified": "2025-09-03T17:26:57.648422Z",
            "relationship_type": "indicates",
            "source_ref": "indicator--53da57ce-6b0e-4642-b242-ef59b5329461",
            "target_ref": "malware--6a537e99-ca9b-4455-a374-63d2096041ed"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--bfcaa06a-9a4e-4f92-b0d9-31e88c30c789",
            "created_by_ref": "identity--2520218d-f2a4-4d5d-81d2-5a8b1fe19667",
            "created": "2025-09-03T17:26:57.648696Z",
            "modified": "2025-09-03T17:26:57.648696Z",
            "relationship_type": "indicates",
            "source_ref": "indicator--b0937903-631c-4355-be7b-f793df3d092c",
            "target_ref": "malware--6a537e99-ca9b-4455-a374-63d2096041ed"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--d55adc80-51f5-4636-bd0c-2ac08546185b",
            "created_by_ref": "identity--2520218d-f2a4-4d5d-81d2-5a8b1fe19667",
            "created": "2025-09-03T17:26:57.648972Z",
            "modified": "2025-09-03T17:26:57.648972Z",
            "relationship_type": "indicates",
            "source_ref": "indicator--68a88bd2-3382-4094-8220-a5217ed8e2a2",
            "target_ref": "malware--6a537e99-ca9b-4455-a374-63d2096041ed"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--50df0ea5-a8c8-4e48-8d10-02cd6b246c8b",
            "created_by_ref": "identity--2520218d-f2a4-4d5d-81d2-5a8b1fe19667",
            "created": "2025-09-03T17:26:57.649261Z",
            "modified": "2025-09-03T17:26:57.649261Z",
            "relationship_type": "indicates",
            "source_ref": "indicator--b31b03d8-f9d5-4d5b-9d7d-21f43eaaf523",
            "target_ref": "malware--6a537e99-ca9b-4455-a374-63d2096041ed"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--37ecbc47-7de0-4f50-b0bc-d1fd396e59af",
            "created_by_ref": "identity--2520218d-f2a4-4d5d-81d2-5a8b1fe19667",
            "created": "2025-09-03T17:26:57.649531Z",
            "modified": "2025-09-03T17:26:57.649531Z",
            "relationship_type": "indicates",
            "source_ref": "indicator--22739b69-437f-4b18-83c6-349713f96931",
            "target_ref": "malware--6a537e99-ca9b-4455-a374-63d2096041ed"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--a25efff7-ee26-4900-9d2c-6fe3b003f3dd",
            "created_by_ref": "identity--2520218d-f2a4-4d5d-81d2-5a8b1fe19667",
            "created": "2025-09-03T17:26:57.649802Z",
            "modified": "2025-09-03T17:26:57.649802Z",
            "relationship_type": "indicates",
            "source_ref": "indicator--87e33c45-b5ac-42b0-99a1-34a8e275a24e",
            "target_ref": "malware--6a537e99-ca9b-4455-a374-63d2096041ed"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--10246852-3e41-4579-a8f1-9fe0f7b09577",
            "created_by_ref": "identity--2520218d-f2a4-4d5d-81d2-5a8b1fe19667",
            "created": "2025-09-03T17:26:57.650099Z",
            "modified": "2025-09-03T17:26:57.650099Z",
            "relationship_type": "indicates",
            "source_ref": "indicator--f72454d0-1248-46a5-8219-8ba8a49e3aeb",
            "target_ref": "malware--6a537e99-ca9b-4455-a374-63d2096041ed"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--8da7cd17-0766-4bed-84f1-87b5387db137",
            "created_by_ref": "identity--2520218d-f2a4-4d5d-81d2-5a8b1fe19667",
            "created": "2025-09-03T17:26:57.650389Z",
            "modified": "2025-09-03T17:26:57.650389Z",
            "relationship_type": "indicates",
            "source_ref": "indicator--5c920bce-4822-4680-996d-01e7cbfe3f1a",
            "target_ref": "malware--6a537e99-ca9b-4455-a374-63d2096041ed"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--dd1d0617-3299-4e65-a39a-1461e8581846",
            "created_by_ref": "identity--2520218d-f2a4-4d5d-81d2-5a8b1fe19667",
            "created": "2025-09-03T17:26:57.65085Z",
            "modified": "2025-09-03T17:26:57.65085Z",
            "relationship_type": "indicates",
            "source_ref": "indicator--fb546e27-275e-4e7c-a283-ffb6b36cf112",
            "target_ref": "malware--6a537e99-ca9b-4455-a374-63d2096041ed"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--f04963b1-8ff5-4a16-a2b1-6803ed6b51fa",
            "created_by_ref": "identity--2520218d-f2a4-4d5d-81d2-5a8b1fe19667",
            "created": "2025-09-03T17:26:57.651164Z",
            "modified": "2025-09-03T17:26:57.651164Z",
            "relationship_type": "derived-from",
            "source_ref": "indicator--fb546e27-275e-4e7c-a283-ffb6b36cf112",
            "target_ref": "indicator--b31b03d8-f9d5-4d5b-9d7d-21f43eaaf523"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--f63033e7-242f-426f-bf5f-07ddda8b68d6",
            "created_by_ref": "identity--2520218d-f2a4-4d5d-81d2-5a8b1fe19667",
            "created": "2025-09-03T17:26:57.651473Z",
            "modified": "2025-09-03T17:26:57.651473Z",
            "relationship_type": "indicates",
            "source_ref": "indicator--82c316d3-b2ad-4036-be86-8c00dd2dd816",
            "target_ref": "malware--6a537e99-ca9b-4455-a374-63d2096041ed"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--8aa3d620-cb5d-4ba3-b3a1-4f011016a103",
            "created_by_ref": "identity--2520218d-f2a4-4d5d-81d2-5a8b1fe19667",
            "created": "2025-09-03T17:26:57.651759Z",
            "modified": "2025-09-03T17:26:57.651759Z",
            "relationship_type": "derived-from",
            "source_ref": "indicator--82c316d3-b2ad-4036-be86-8c00dd2dd816",
            "target_ref": "indicator--53da57ce-6b0e-4642-b242-ef59b5329461"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--d89e1164-59d2-4414-bbb0-ea6691f9664f",
            "created_by_ref": "identity--2520218d-f2a4-4d5d-81d2-5a8b1fe19667",
            "created": "2025-09-03T17:26:57.652111Z",
            "modified": "2025-09-03T17:26:57.652111Z",
            "relationship_type": "indicates",
            "source_ref": "indicator--bed2766f-411c-4a4d-99dd-99de00b4bd26",
            "target_ref": "malware--6a537e99-ca9b-4455-a374-63d2096041ed"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--9ea8f05d-d5e1-4962-9b92-1b93b3f6c90f",
            "created_by_ref": "identity--2520218d-f2a4-4d5d-81d2-5a8b1fe19667",
            "created": "2025-09-03T17:26:57.652412Z",
            "modified": "2025-09-03T17:26:57.652412Z",
            "relationship_type": "derived-from",
            "source_ref": "indicator--bed2766f-411c-4a4d-99dd-99de00b4bd26",
            "target_ref": "indicator--b31b03d8-f9d5-4d5b-9d7d-21f43eaaf523"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--bbdc0749-9f71-45a5-bccf-de94139b998d",
            "created_by_ref": "identity--2520218d-f2a4-4d5d-81d2-5a8b1fe19667",
            "created": "2025-09-03T17:26:57.652748Z",
            "modified": "2025-09-03T17:26:57.652748Z",
            "relationship_type": "indicates",
            "source_ref": "indicator--4f1c4bbd-765f-4fb9-9cd1-9d9c2e5fb70c",
            "target_ref": "malware--6a537e99-ca9b-4455-a374-63d2096041ed"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--bd84e10a-2aec-4ffb-b5af-2387136705d1",
            "created_by_ref": "identity--2520218d-f2a4-4d5d-81d2-5a8b1fe19667",
            "created": "2025-09-03T17:26:57.653042Z",
            "modified": "2025-09-03T17:26:57.653042Z",
            "relationship_type": "derived-from",
            "source_ref": "indicator--4f1c4bbd-765f-4fb9-9cd1-9d9c2e5fb70c",
            "target_ref": "indicator--53da57ce-6b0e-4642-b242-ef59b5329461"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--922ff61e-e4e8-4df5-8260-62dc9ce57d7c",
            "created_by_ref": "identity--2520218d-f2a4-4d5d-81d2-5a8b1fe19667",
            "created": "2025-09-03T17:26:57.653579Z",
            "modified": "2025-09-03T17:26:57.653579Z",
            "relationship_type": "indicates",
            "source_ref": "indicator--e55500d1-3047-460d-953b-94b76cf77175",
            "target_ref": "malware--6a537e99-ca9b-4455-a374-63d2096041ed"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--e37f0eaf-f3e9-4047-a2e4-025450b7f67a",
            "created_by_ref": "identity--2520218d-f2a4-4d5d-81d2-5a8b1fe19667",
            "created": "2025-09-03T17:26:57.65404Z",
            "modified": "2025-09-03T17:26:57.65404Z",
            "relationship_type": "derived-from",
            "source_ref": "indicator--e55500d1-3047-460d-953b-94b76cf77175",
            "target_ref": "indicator--b31b03d8-f9d5-4d5b-9d7d-21f43eaaf523"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--b7d55de9-bd8d-4ce5-a19c-6f08de499c2a",
            "created_by_ref": "identity--2520218d-f2a4-4d5d-81d2-5a8b1fe19667",
            "created": "2025-09-03T17:26:57.654418Z",
            "modified": "2025-09-03T17:26:57.654418Z",
            "relationship_type": "indicates",
            "source_ref": "indicator--5d3b10e7-ef4a-47a4-91ce-e815e1f9b411",
            "target_ref": "malware--6a537e99-ca9b-4455-a374-63d2096041ed"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--82dad78a-ba3e-4a35-b852-8b4788cfc06d",
            "created_by_ref": "identity--2520218d-f2a4-4d5d-81d2-5a8b1fe19667",
            "created": "2025-09-03T17:26:57.654722Z",
            "modified": "2025-09-03T17:26:57.654722Z",
            "relationship_type": "derived-from",
            "source_ref": "indicator--5d3b10e7-ef4a-47a4-91ce-e815e1f9b411",
            "target_ref": "indicator--b31b03d8-f9d5-4d5b-9d7d-21f43eaaf523"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--8799f41b-724a-423b-b9ba-d675dfdfc575",
            "created_by_ref": "identity--2520218d-f2a4-4d5d-81d2-5a8b1fe19667",
            "created": "2025-09-03T17:26:57.655082Z",
            "modified": "2025-09-03T17:26:57.655082Z",
            "relationship_type": "indicates",
            "source_ref": "indicator--f132ea37-ee66-4557-a8be-d82ad84a94e9",
            "target_ref": "malware--6a537e99-ca9b-4455-a374-63d2096041ed"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--ea2cbb3f-4a2c-40ed-97f4-1d6da93f36d8",
            "created_by_ref": "identity--2520218d-f2a4-4d5d-81d2-5a8b1fe19667",
            "created": "2025-09-03T17:26:57.655414Z",
            "modified": "2025-09-03T17:26:57.655414Z",
            "relationship_type": "derived-from",
            "source_ref": "indicator--f132ea37-ee66-4557-a8be-d82ad84a94e9",
            "target_ref": "indicator--b31b03d8-f9d5-4d5b-9d7d-21f43eaaf523"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--116daeab-20d0-400d-a9ee-07a9b9589823",
            "created_by_ref": "identity--2520218d-f2a4-4d5d-81d2-5a8b1fe19667",
            "created": "2025-09-03T17:26:57.655725Z",
            "modified": "2025-09-03T17:26:57.655725Z",
            "relationship_type": "indicates",
            "source_ref": "indicator--3a5bc801-0ac7-40ef-af8b-ba3eae0d9cc9",
            "target_ref": "malware--6a537e99-ca9b-4455-a374-63d2096041ed"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--20a44218-97b6-4b04-adfe-fdaef2440d12",
            "created_by_ref": "identity--2520218d-f2a4-4d5d-81d2-5a8b1fe19667",
            "created": "2025-09-03T17:26:57.656024Z",
            "modified": "2025-09-03T17:26:57.656024Z",
            "relationship_type": "derived-from",
            "source_ref": "indicator--3a5bc801-0ac7-40ef-af8b-ba3eae0d9cc9",
            "target_ref": "indicator--b31b03d8-f9d5-4d5b-9d7d-21f43eaaf523"
        },
        {
            "type": "report",
            "spec_version": "2.1",
            "id": "report--5944d61e-fef6-4a38-b03f-7d26b7efc46a",
            "created_by_ref": "identity--2520218d-f2a4-4d5d-81d2-5a8b1fe19667",
            "created": "2025-09-03T17:26:57.656493Z",
            "modified": "2025-09-03T17:26:57.656493Z",
            "name": "Analisi Malware: Sparrowdoor",
            "description": "This report contains technical analysis and indicators associated with malware. sparrowdoor.",
            "report_types": [
                "malware-analysis"
            ],
            "published": "2025-09-03T17:26:57.656481Z",
            "object_refs": [
                "identity--2520218d-f2a4-4d5d-81d2-5a8b1fe19667",
                "mutex--ba1a71b9-af46-5543-968f-3e18936c35f1",
                "indicator--64b5edac-608d-4331-9339-e27c195fc23b",
                "indicator--43ae7a9d-ec2b-4cea-b4e3-3dc749e97732",
                "indicator--53da57ce-6b0e-4642-b242-ef59b5329461",
                "indicator--b0937903-631c-4355-be7b-f793df3d092c",
                "indicator--68a88bd2-3382-4094-8220-a5217ed8e2a2",
                "indicator--b31b03d8-f9d5-4d5b-9d7d-21f43eaaf523",
                "indicator--22739b69-437f-4b18-83c6-349713f96931",
                "indicator--87e33c45-b5ac-42b0-99a1-34a8e275a24e",
                "indicator--f72454d0-1248-46a5-8219-8ba8a49e3aeb",
                "indicator--5c920bce-4822-4680-996d-01e7cbfe3f1a",
                "relationship--0fdb640d-344d-4f89-ab07-e502c5f7e422",
                "relationship--9771ee78-f6f5-4eec-8459-01eaffb8f0d2",
                "relationship--ade20abf-1ed5-4ea7-858c-72a0d970617d",
                "relationship--cbe12626-7ee7-4132-9627-a11bbc2e47cf",
                "relationship--1fa64bdb-746d-4933-bfd8-ff30252ab059",
                "relationship--e1e30839-efae-4076-9ec6-8aea0b1bc692",
                "relationship--247624be-9b94-43bd-89f9-cad1ae03ef5a",
                "relationship--1a9312b3-05fc-4634-8a05-fe3278daf8c8",
                "relationship--fb3aa721-4630-4ae1-b151-2fea67640b37",
                "relationship--a9a94594-50bc-4ae7-820f-e5fd1c2d93e8",
                "malware--6a537e99-ca9b-4455-a374-63d2096041ed",
                "identity--db097fa0-dee0-4cf1-9556-82a2e0a59c1f",
                "indicator--fb546e27-275e-4e7c-a283-ffb6b36cf112",
                "indicator--82c316d3-b2ad-4036-be86-8c00dd2dd816",
                "indicator--bed2766f-411c-4a4d-99dd-99de00b4bd26",
                "indicator--4f1c4bbd-765f-4fb9-9cd1-9d9c2e5fb70c",
                "indicator--e55500d1-3047-460d-953b-94b76cf77175",
                "indicator--5d3b10e7-ef4a-47a4-91ce-e815e1f9b411",
                "indicator--f132ea37-ee66-4557-a8be-d82ad84a94e9",
                "indicator--3a5bc801-0ac7-40ef-af8b-ba3eae0d9cc9",
                "attack-pattern--9794a555-8a0a-4333-8fc5-d85d426679b6",
                "attack-pattern--b4e91855-911e-4c10-98de-37c4361f9604",
                "attack-pattern--0b7c462f-021d-41ff-b243-297232e54b3f",
                "attack-pattern--ce521d44-451e-4441-8ebb-3b291755b1d7",
                "attack-pattern--9c1be1dd-1099-4ed8-9107-216b89b6cd1c",
                "attack-pattern--82b3f3c0-d641-4e22-b2d7-cba6e1e78a75",
                "attack-pattern--d9c2bb8b-f552-4afa-8e6d-9221074e27c4",
                "attack-pattern--c3563b0e-bd88-4462-bf06-8eca52ef94b3",
                "attack-pattern--177a3fa9-daaa-4309-8063-b4fecc75e305",
                "attack-pattern--7309eb80-d725-4073-b6cb-ec7948854b1b",
                "attack-pattern--4ba83f84-e0bc-4c08-9d77-97a0673bd36e",
                "attack-pattern--912c4019-7b40-488a-a52a-669766124218",
                "attack-pattern--c3abd22f-f47b-40c2-a622-36058048191f",
                "attack-pattern--09e2f32e-5f85-4760-9bf4-2a3a5b79154d",
                "attack-pattern--f1ae2cc3-1594-46d9-9b3d-f5aa502bb508",
                "relationship--56707e6b-99eb-4dc8-8d79-c1ade6389912",
                "relationship--a533e173-9e5b-46e3-b531-439966443100",
                "relationship--57d3b6b4-c1c6-401c-9b3b-860c22947831",
                "relationship--1a8d1c91-f228-405b-9873-da1ba5381825",
                "relationship--ef42b893-9d2a-4697-9e64-96d30ae916cf",
                "relationship--b18ae015-def2-4181-aca2-0c74f8dbfa88",
                "relationship--8975e10a-8948-4e75-8273-44e4dbb558dd",
                "relationship--c213860d-b163-4444-8c96-923360a0dcbd",
                "relationship--f8fe649c-8f68-4194-b302-0ee27f685e00",
                "relationship--d7ab4c5e-b3ac-4864-a6e3-85978cfc07a0",
                "relationship--8a33b929-28bc-483b-ad64-4771ff50ed20",
                "relationship--12daa7ef-6e5c-4265-ac47-0f41e2dce5fa",
                "relationship--c613cdea-5be9-45d8-b4e5-5e3e6a385fff",
                "relationship--0a95d5c8-f659-44c5-bbab-034f2e130176",
                "relationship--af479201-6044-4c5f-ab1f-91fd637769ad",
                "relationship--d4b24efc-e1ed-4606-bcf8-cf885ec8e4ba",
                "relationship--ae140722-6e39-4150-a8d6-b6a177283133",
                "relationship--e1d7b732-44ca-4741-95d7-8793e10c2f71",
                "relationship--bfcaa06a-9a4e-4f92-b0d9-31e88c30c789",
                "relationship--d55adc80-51f5-4636-bd0c-2ac08546185b",
                "relationship--50df0ea5-a8c8-4e48-8d10-02cd6b246c8b",
                "relationship--37ecbc47-7de0-4f50-b0bc-d1fd396e59af",
                "relationship--a25efff7-ee26-4900-9d2c-6fe3b003f3dd",
                "relationship--10246852-3e41-4579-a8f1-9fe0f7b09577",
                "relationship--8da7cd17-0766-4bed-84f1-87b5387db137",
                "relationship--dd1d0617-3299-4e65-a39a-1461e8581846",
                "relationship--f04963b1-8ff5-4a16-a2b1-6803ed6b51fa",
                "relationship--f63033e7-242f-426f-bf5f-07ddda8b68d6",
                "relationship--8aa3d620-cb5d-4ba3-b3a1-4f011016a103",
                "relationship--d89e1164-59d2-4414-bbb0-ea6691f9664f",
                "relationship--9ea8f05d-d5e1-4962-9b92-1b93b3f6c90f",
                "relationship--bbdc0749-9f71-45a5-bccf-de94139b998d",
                "relationship--bd84e10a-2aec-4ffb-b5af-2387136705d1",
                "relationship--922ff61e-e4e8-4df5-8260-62dc9ce57d7c",
                "relationship--e37f0eaf-f3e9-4047-a2e4-025450b7f67a",
                "relationship--b7d55de9-bd8d-4ce5-a19c-6f08de499c2a",
                "relationship--82dad78a-ba3e-4a35-b852-8b4788cfc06d",
                "relationship--8799f41b-724a-423b-b9ba-d675dfdfc575",
                "relationship--ea2cbb3f-4a2c-40ed-97f4-1d6da93f36d8",
                "relationship--116daeab-20d0-400d-a9ee-07a9b9589823",
                "relationship--20a44218-97b6-4b04-adfe-fdaef2440d12"
            ],
            "object_marking_refs": [
                "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
            ]
        }
    ]
}