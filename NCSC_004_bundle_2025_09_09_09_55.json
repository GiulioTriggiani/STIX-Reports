{
    "type": "bundle",
    "id": "bundle--fb667b2a-0d84-42ec-9139-6b81ad237ede",
    "objects": [
        {
            "type": "identity",
            "spec_version": "2.1",
            "id": "identity--1162c330-09ca-44f2-a4b5-f083919d61c4",
            "created": "2025-09-09T09:55:40.114955Z",
            "modified": "2025-09-09T09:55:40.114955Z",
            "name": "NCSC",
            "description": "The UK National Cyber Security Centre (NCSC) is the author and publisher of this threat report, providing analysis and detection guidance for Pygmy Goat.",
            "identity_class": "organization"
        },
        {
            "type": "marking-definition",
            "spec_version": "2.1",
            "id": "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9",
            "created": "2017-01-20T00:00:00.000Z",
            "definition_type": "tlp",
            "name": "TLP:WHITE",
            "definition": {
                "tlp": "white"
            }
        },
        {
            "type": "mutex",
            "spec_version": "2.1",
            "id": "mutex--3ef58740-1f43-51b5-8014-63f12621f42f",
            "name": "LD_PRELOAD"
        },
        {
            "type": "indicator",
            "spec_version": "2.1",
            "id": "indicator--67f22ea1-d506-4c2b-909a-5a2ddc6d8dbe",
            "created": "2025-09-09T09:54:39.740611Z",
            "modified": "2025-09-09T09:54:39.740611Z",
            "name": "LD_PRELOAD environment variable",
            "description": "Persistence mechanism: LD_PRELOAD set to load malicious shared object",
            "pattern": "[mutex:name = 'LD_PRELOAD']",
            "pattern_type": "stix",
            "pattern_version": "2.1",
            "valid_from": "2025-09-09T09:54:39.740581Z"
        },
        {
            "type": "indicator",
            "spec_version": "2.1",
            "id": "indicator--7e0b52dd-f177-4b42-a513-dba6b9c67f4d",
            "created": "2025-09-09T09:54:39.742439Z",
            "modified": "2025-09-09T09:54:39.742439Z",
            "name": "Indicator for libsophos.so (MD5)",
            "description": "MD5 hash of malicious shared object (current variant)",
            "pattern": "[file:hashes.'MD5' = 'c71cd27efcdb8c44ab8c29d51f033a22']",
            "pattern_type": "stix",
            "pattern_version": "2.1",
            "valid_from": "2025-09-09T09:54:39.742432Z"
        },
        {
            "type": "indicator",
            "spec_version": "2.1",
            "id": "indicator--e4b9d855-3b46-41fd-a75a-de3699c2f25e",
            "created": "2025-09-09T09:54:39.743356Z",
            "modified": "2025-09-09T09:54:39.743356Z",
            "name": "Indicator for libsophos.so (SHA1)",
            "description": "SHA-1 hash of malicious shared object (current variant)",
            "pattern": "[file:hashes.'SHA1' = '71f70d61af00542b2e9ad64abd2dda7e437536ff']",
            "pattern_type": "stix",
            "pattern_version": "2.1",
            "valid_from": "2025-09-09T09:54:39.743348Z"
        },
        {
            "type": "indicator",
            "spec_version": "2.1",
            "id": "indicator--afec19fc-958e-4378-bd7b-04224ad9ba8a",
            "created": "2025-09-09T09:54:39.744236Z",
            "modified": "2025-09-09T09:54:39.744236Z",
            "name": "Indicator for libsophos.so (SHA256)",
            "description": "SHA-256 hash of malicious shared object (current variant)",
            "pattern": "[file:hashes.'SHA256' = '6455de74ae15071fa98f18cdbc3148c967755e69df7dee747bc31d0387751162']",
            "pattern_type": "stix",
            "pattern_version": "2.1",
            "valid_from": "2025-09-09T09:54:39.744228Z"
        },
        {
            "type": "indicator",
            "spec_version": "2.1",
            "id": "indicator--3f7d415f-13bb-4e76-b7d4-6a0e698cf4ad",
            "created": "2025-09-09T09:54:39.745086Z",
            "modified": "2025-09-09T09:54:39.745086Z",
            "name": "Indicator for libsophos.so (earlier variant) (MD5)",
            "description": "MD5 hash of earlier variant of malicious shared object",
            "pattern": "[file:hashes.'MD5' = '3f28196675dc8cb20cf5b5f80ea29310']",
            "pattern_type": "stix",
            "pattern_version": "2.1",
            "valid_from": "2025-09-09T09:54:39.745078Z"
        },
        {
            "type": "indicator",
            "spec_version": "2.1",
            "id": "indicator--b89a9598-589d-4e5a-829b-8f7c8b27188f",
            "created": "2025-09-09T09:54:39.745871Z",
            "modified": "2025-09-09T09:54:39.745871Z",
            "name": "Indicator for libsophos.so (earlier variant) (SHA1)",
            "description": "SHA-1 hash of earlier variant of malicious shared object",
            "pattern": "[file:hashes.'SHA1' = '7ace663c22b3e800fc17c1477d54b533f7002833']",
            "pattern_type": "stix",
            "pattern_version": "2.1",
            "valid_from": "2025-09-09T09:54:39.745862Z"
        },
        {
            "type": "indicator",
            "spec_version": "2.1",
            "id": "indicator--5d7ba1dd-ae69-4b49-9cc1-141157b6ea49",
            "created": "2025-09-09T09:54:39.746673Z",
            "modified": "2025-09-09T09:54:39.746673Z",
            "name": "Indicator for libsophos.so (earlier variant) (SHA256)",
            "description": "SHA-256 hash of earlier variant of malicious shared object",
            "pattern": "[file:hashes.'SHA256' = '823b079c75f4e6a5905d9eea9a60c62e1f0995bfc25764d1ba0407a5bd78c962']",
            "pattern_type": "stix",
            "pattern_version": "2.1",
            "valid_from": "2025-09-09T09:54:39.746665Z"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--b79872e1-130f-497f-9976-4c541ab9b375",
            "created": "2025-09-09T09:54:39.742094Z",
            "modified": "2025-09-09T09:54:39.742094Z",
            "relationship_type": "based-on",
            "source_ref": "indicator--67f22ea1-d506-4c2b-909a-5a2ddc6d8dbe",
            "target_ref": "mutex--3ef58740-1f43-51b5-8014-63f12621f42f"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--7d41ef8e-c2a5-4e00-b587-0ba852b0444c",
            "created": "2025-09-09T09:54:39.747477Z",
            "modified": "2025-09-09T09:54:39.747477Z",
            "relationship_type": "derived-from",
            "source_ref": "indicator--7e0b52dd-f177-4b42-a513-dba6b9c67f4d",
            "target_ref": "indicator--e4b9d855-3b46-41fd-a75a-de3699c2f25e"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--6e7cac20-2e37-489c-a2b0-08f7bfd5bc47",
            "created": "2025-09-09T09:54:39.747802Z",
            "modified": "2025-09-09T09:54:39.747802Z",
            "relationship_type": "derived-from",
            "source_ref": "indicator--7e0b52dd-f177-4b42-a513-dba6b9c67f4d",
            "target_ref": "indicator--afec19fc-958e-4378-bd7b-04224ad9ba8a"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--1e0eb0fd-d6b3-4dc8-ad49-ba9062264ade",
            "created": "2025-09-09T09:54:39.748052Z",
            "modified": "2025-09-09T09:54:39.748052Z",
            "relationship_type": "derived-from",
            "source_ref": "indicator--e4b9d855-3b46-41fd-a75a-de3699c2f25e",
            "target_ref": "indicator--afec19fc-958e-4378-bd7b-04224ad9ba8a"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--6b54fc5c-8e57-433b-b7bf-56ea23260fda",
            "created": "2025-09-09T09:54:39.748297Z",
            "modified": "2025-09-09T09:54:39.748297Z",
            "relationship_type": "derived-from",
            "source_ref": "indicator--3f7d415f-13bb-4e76-b7d4-6a0e698cf4ad",
            "target_ref": "indicator--b89a9598-589d-4e5a-829b-8f7c8b27188f"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--541b5967-a55f-41b9-9564-6ba0d1c7ee1e",
            "created": "2025-09-09T09:54:39.748536Z",
            "modified": "2025-09-09T09:54:39.748536Z",
            "relationship_type": "derived-from",
            "source_ref": "indicator--3f7d415f-13bb-4e76-b7d4-6a0e698cf4ad",
            "target_ref": "indicator--5d7ba1dd-ae69-4b49-9cc1-141157b6ea49"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--a61ec850-2704-434b-92a6-c08fce462583",
            "created": "2025-09-09T09:54:39.748841Z",
            "modified": "2025-09-09T09:54:39.748841Z",
            "relationship_type": "derived-from",
            "source_ref": "indicator--b89a9598-589d-4e5a-829b-8f7c8b27188f",
            "target_ref": "indicator--5d7ba1dd-ae69-4b49-9cc1-141157b6ea49"
        },
        {
            "type": "malware",
            "spec_version": "2.1",
            "id": "malware--4d9a54d9-a542-43c6-92a2-f25e332fad50",
            "created_by_ref": "identity--1162c330-09ca-44f2-a4b5-f083919d61c4",
            "created": "2025-09-09T09:55:40.115418Z",
            "modified": "2025-09-09T09:55:40.115418Z",
            "name": "pygmy goat",
            "description": "Pygmy Goat is a native x86-32 ELF shared object discovered on Sophos XG firewall devices, providing backdoor access to the device. It uses the LD_PRELOAD environment variable to inject itself into the /bin/sshd process, hooking the accept function to monitor incoming SSH connections for magic bytes or listening on a raw ICMP socket for encrypted C2 instructions. The malware supports remote shell access, packet capture, cron task creation, and reverse SOCKS proxying via EarthWorm. It uses an embedded CA certificate masquerading as Fortinet to establish TLS connections with its C2. Pygmy Goat is designed for stealth and persistence, unsetting LD_PRELOAD after loading and using Unix sockets for inter-process communication.",
            "malware_types": [
                "backdoor"
            ],
            "is_family": true
        },
        {
            "type": "malware",
            "spec_version": "2.1",
            "id": "malware--ed0edd54-f19f-4607-94cd-0d0e5568925b",
            "created_by_ref": "identity--1162c330-09ca-44f2-a4b5-f083919d61c4",
            "created": "2025-09-09T09:55:40.115777Z",
            "modified": "2025-09-09T09:55:40.115777Z",
            "name": "libsophos.so",
            "description": "libsophos.so is the malicious shared object file loaded into /bin/sshd by Pygmy Goat via LD_PRELOAD. It contains the core backdoor functionality, including the ability to hook the accept function, listen for ICMP packets, and execute C2 commands. An earlier variant lacked the reverse proxy feature and used VMProtect for obfuscation.",
            "malware_types": [
                "backdoor"
            ],
            "is_family": true
        },
        {
            "type": "identity",
            "spec_version": "2.1",
            "id": "identity--73f71934-ce90-4457-b87f-6c696fb1ba14",
            "created": "2025-09-09T09:55:40.116082Z",
            "modified": "2025-09-09T09:55:40.116082Z",
            "name": "Fortinet Ltd.",
            "description": "Fortinet Ltd. is referenced as the purported issuer of the embedded Root CA certificate used by Pygmy Goat to masquerade as a legitimate certificate authority for TLS connections.",
            "identity_class": "organization"
        },
        {
            "type": "identity",
            "spec_version": "2.1",
            "id": "identity--57ad8018-8644-437b-9cec-2f2fc7bfcd09",
            "created": "2025-09-09T09:55:40.116328Z",
            "modified": "2025-09-09T09:55:40.116328Z",
            "name": "Sophos",
            "description": "Sophos is the vendor of the XG firewall devices on which Pygmy Goat was discovered. The malware targets these devices for initial infection.",
            "identity_class": "organization"
        },
        {
            "type": "identity",
            "spec_version": "2.1",
            "id": "identity--fd3e8b65-89eb-4426-bfb3-16bf13ea5582",
            "created": "2025-09-09T09:55:40.116573Z",
            "modified": "2025-09-09T09:55:40.116573Z",
            "name": "Mandiant",
            "description": "Mandiant is referenced as an industry source reporting on similar attacks against FortiGate devices and the CASTLETAP malware, which shares TTPs with Pygmy Goat.",
            "identity_class": "organization"
        },
        {
            "type": "identity",
            "spec_version": "2.1",
            "id": "identity--57ece42e-6ae6-4666-aa3f-a26284b13373",
            "created": "2025-09-09T09:55:40.117047Z",
            "modified": "2025-09-09T09:55:40.117047Z",
            "name": "CrowdStrike",
            "description": "CrowdStrike is referenced as an industry source noting previous threat actor use of EarthWorm for offensive operations.",
            "identity_class": "organization"
        },
        {
            "type": "indicator",
            "spec_version": "2.1",
            "id": "indicator--0c27168b-291c-464b-9b4f-f328ae0fa357",
            "created_by_ref": "identity--1162c330-09ca-44f2-a4b5-f083919d61c4",
            "created": "2025-09-09T09:55:40.117316Z",
            "modified": "2025-09-09T09:55:40.117316Z",
            "name": "pygmy_goat_aes_key",
            "description": "YARA rule to detect related activity.",
            "pattern": "rule pygmy_goat_aes_key\n{\n\nmeta:\n\n        author = \"NCSC\"\n        description = \"Pygmy Goat AES key built on the stack or in data\"\n        date = \"2024-11-07\"\n        hash1 = \"71f70d61af00542b2e9ad64abd2dda7e437536ff\"\n\nstrings:\n\n$dword_1 = { 59 4b 6e 77 }\n$dword_2 = { 51 6a 6d 41 }\n$dword_3 = { 54 62 41 6e }\n$dword_4 = { 52 6f 5a 6d }\n$dword_5 = { 30 66 47 37 }\n$dword_6 = { 55 5a 57 62 }\n$dword_7 = { 32 59 55 78 }\n$dword_8 = { 55 51 50 77 }\n\ncondition:\n\n(uint32(0) == 0x464c457f) and filesize < 5MB and all of them\n\n}",
            "pattern_type": "yara",
            "valid_from": "2025-09-09T09:55:40.117302Z"
        },
        {
            "type": "indicator",
            "spec_version": "2.1",
            "id": "indicator--687dfff1-4c8e-4caf-a8d3-df3b61a5b8c0",
            "created_by_ref": "identity--1162c330-09ca-44f2-a4b5-f083919d61c4",
            "created": "2025-09-09T09:55:40.117668Z",
            "modified": "2025-09-09T09:55:40.117668Z",
            "name": "pygmy_goat_magic_strings",
            "description": "YARA rule to detect related activity.",
            "pattern": "rule pygmy_goat_magic_strings\n{\n\nmeta:\n\n        author = \"NCSC\"\n        description = \"Pygmy Goat magic byte sequences used in C2 comms\"\n        date = \"2024-10-22\"\n        hash1 = \"71f70d61af00542b2e9ad64abd2dda7e437536ff\"\n\nstrings:\n\n$c2_magic_handshake = \",bEB3?=o\"\n$fake_ssh_banner = \"SSH-2.0-D8pjE\"\n$fake_ed25519_key = { 29 cc f0 cc 16 c5 46 6e 52 19 82 8e 86\n\n65 42 8c 1f 1a d4 c3 a5 b1 cb fc c0 26 6c 31 3c 5c 90 3a 24 7d e4 d3 57\n6d da 8e cb f4 66 d1 cb 81 4f 63 fd 4a fa 06 e4 7e 4c a0 95 91 bd cb 97\na4 b3 0f }\n\ncondition:\n\n(uint32(0) == 0x464c457f) and any of them\n\n}",
            "pattern_type": "yara",
            "valid_from": "2025-09-09T09:55:40.117661Z"
        },
        {
            "type": "indicator",
            "spec_version": "2.1",
            "id": "indicator--42d7f7dd-032e-4a91-a0b4-dccc0c5afd85",
            "created_by_ref": "identity--1162c330-09ca-44f2-a4b5-f083919d61c4",
            "created": "2025-09-09T09:55:40.118276Z",
            "modified": "2025-09-09T09:55:40.118276Z",
            "name": "earthworm_id_generation_x86",
            "description": "YARA rule to detect related activity.",
            "pattern": "rule earthworm_id_generation_x86\n{\n\nmeta:\n\n        author = \"NCSC\"\n        description = \"EarthWorm pool num generation x86 assembly\"\n        date = \"2024-10-22\"\n        hash1 = \"71f70d61af00542b2e9ad64abd2dda7e437536ff\"\n\nstrings:\n\n$chartoi = {\n\n8b 45 ??        // MOV\nc1 e0 07        // SHL\n89 c1           // MOV\n8b 55 ??        // MOV\n8b 45 ??        // MOV\n01 d0           // ADD\n0f b6 00        // MOVZX\n0f be c0        // MOVSX\n01 c8           // ADD\n89 45 ??        // MOV\n83 6d ?? 01     // SUB\n\nEAX,dword ptr [EBP + ??]\nEAX,0x7\nECX,EAX\nEDX,dword ptr [EBP + ??]\nEAX,dword ptr [EBP + ??]\nEAX,EDX\nEAX,byte ptr [EAX]\nEAX,AL\nEAX,ECX\ndword ptr [EBP + ??],EAX\ndword ptr [EBP + ??],0x1\n\n}\n\ncondition:\n\n}\n\n(uint32(0) == 0x464c457f) and all of them\n",
            "pattern_type": "yara",
            "valid_from": "2025-09-09T09:55:40.118267Z"
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--29a211d2-92d8-4eda-be33-5f1475fad52e",
            "created_by_ref": "identity--1162c330-09ca-44f2-a4b5-f083919d61c4",
            "created": "2025-09-09T09:55:40.118672Z",
            "modified": "2025-09-09T09:55:40.118672Z",
            "name": "Dynamic Linker Hijacking",
            "description": "Pygmy Goat uses the LD_PRELOAD environment variable to inject into sshd",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "persistence"
                }
            ],
            "external_references": [
                {
                    "source_name": "mitre-attack",
                    "url": "https://attack.mitre.org/techniques/T1574/006",
                    "external_id": "T1574.006"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--bb03f171-5c54-46fd-862b-743115da4d48",
            "created_by_ref": "identity--1162c330-09ca-44f2-a4b5-f083919d61c4",
            "created": "2025-09-09T09:55:40.119239Z",
            "modified": "2025-09-09T09:55:40.119239Z",
            "name": "Command and Scripting Interpreter: Unix Shell",
            "description": "Pygmy Goat can create a /bin/sh or /bin/csh remote shell",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "execution"
                }
            ],
            "external_references": [
                {
                    "source_name": "mitre-attack",
                    "url": "https://attack.mitre.org/techniques/T1059/004",
                    "external_id": "T1059.004"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--b2425ce1-2504-42f8-8006-66cc56cc12ea",
            "created_by_ref": "identity--1162c330-09ca-44f2-a4b5-f083919d61c4",
            "created": "2025-09-09T09:55:40.119777Z",
            "modified": "2025-09-09T09:55:40.119777Z",
            "name": "Scheduled Task/Job: Cron",
            "description": "Pygmy Goat can create arbitrary cron tasks using crontab",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "execution"
                }
            ],
            "external_references": [
                {
                    "source_name": "mitre-attack",
                    "url": "https://attack.mitre.org/techniques/T1053/003",
                    "external_id": "T1053.003"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--8de6ed53-e61c-41db-8f2d-f44741d48557",
            "created_by_ref": "identity--1162c330-09ca-44f2-a4b5-f083919d61c4",
            "created": "2025-09-09T09:55:40.120284Z",
            "modified": "2025-09-09T09:55:40.120284Z",
            "name": "Inter-Process Communication",
            "description": "Pygmy Goat uses Unix sockets for inter-process communication between parent and forked child processes",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "execution"
                }
            ],
            "external_references": [
                {
                    "source_name": "mitre-attack",
                    "url": "https://attack.mitre.org/techniques/T1559",
                    "external_id": "T1559"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--86a87e20-5768-4353-bd69-4ce97179ac81",
            "created_by_ref": "identity--1162c330-09ca-44f2-a4b5-f083919d61c4",
            "created": "2025-09-09T09:55:40.12078Z",
            "modified": "2025-09-09T09:55:40.12078Z",
            "name": "Network Sniffing",
            "description": "Pygmy Goat can use libpcap to sniff network traffic according to a BPF filter and exfiltrate it to the C2",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "discovery"
                }
            ],
            "external_references": [
                {
                    "source_name": "mitre-attack",
                    "url": "https://attack.mitre.org/techniques/T1040",
                    "external_id": "T1040"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--e44b1925-4d01-4434-ac36-c09bbb213b79",
            "created_by_ref": "identity--1162c330-09ca-44f2-a4b5-f083919d61c4",
            "created": "2025-09-09T09:55:40.121193Z",
            "modified": "2025-09-09T09:55:40.121193Z",
            "name": "Traffic Signaling: Port Knocking",
            "description": "Pygmy Goat listens on an ICMP raw socket for encrypted packets containing magic bytes and the C2 address to connect back to",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "command-and-control"
                }
            ],
            "external_references": [
                {
                    "source_name": "mitre-attack",
                    "url": "https://attack.mitre.org/techniques/T1205/001",
                    "external_id": "T1205.001"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--aaf62a8f-1665-4d74-bf3c-5fb955b0bded",
            "created_by_ref": "identity--1162c330-09ca-44f2-a4b5-f083919d61c4",
            "created": "2025-09-09T09:55:40.121481Z",
            "modified": "2025-09-09T09:55:40.121481Z",
            "name": "Data Obfuscation: Protocol Impersonation",
            "description": "Pygmy Goat responds to an SSH connection that sends magic bytes with a fake SSH handshake",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "command-and-control"
                }
            ],
            "external_references": [
                {
                    "source_name": "mitre-attack",
                    "url": "https://attack.mitre.org/techniques/T1001/003",
                    "external_id": "T1001.003"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--2c1647b4-2f1d-4f73-8ac1-5f492f9a1539",
            "created_by_ref": "identity--1162c330-09ca-44f2-a4b5-f083919d61c4",
            "created": "2025-09-09T09:55:40.121815Z",
            "modified": "2025-09-09T09:55:40.121815Z",
            "name": "Encrypted Channel: Asymmetric Cryptography",
            "description": "Pygmy Goat encrypts C2 communications with TLS",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "command-and-control"
                }
            ],
            "external_references": [
                {
                    "source_name": "mitre-attack",
                    "url": "https://attack.mitre.org/techniques/T1573/002",
                    "external_id": "T1573.002"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--2e0cd7ea-d882-45a5-a144-b57d0ca3c708",
            "created_by_ref": "identity--1162c330-09ca-44f2-a4b5-f083919d61c4",
            "created": "2025-09-09T09:55:40.122088Z",
            "modified": "2025-09-09T09:55:40.122088Z",
            "name": "Protocol Tunneling",
            "description": "Pygmy Goat can create a reverse SOCKS5 proxy server to tunnel traffic through it",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "command-and-control"
                }
            ],
            "external_references": [
                {
                    "source_name": "mitre-attack",
                    "url": "https://attack.mitre.org/techniques/T1572",
                    "external_id": "T1572"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--85807d92-d2b9-4490-8cda-bdde3addf086",
            "created_by_ref": "identity--1162c330-09ca-44f2-a4b5-f083919d61c4",
            "created": "2025-09-09T09:55:40.122344Z",
            "modified": "2025-09-09T09:55:40.122344Z",
            "name": "Archive Collected Data: Archive via Library",
            "description": "Pygmy Goat compresses its C2 communications with LZO1X",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "collection"
                }
            ],
            "external_references": [
                {
                    "source_name": "mitre-attack",
                    "url": "https://attack.mitre.org/techniques/T1560/002",
                    "external_id": "T1560.002"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "spec_version": "2.1",
            "id": "attack-pattern--bea94ebc-887c-4e2e-8a35-54be9d21bdde",
            "created_by_ref": "identity--1162c330-09ca-44f2-a4b5-f083919d61c4",
            "created": "2025-09-09T09:55:40.122647Z",
            "modified": "2025-09-09T09:55:40.122647Z",
            "name": "Exfiltration Over C2 Channel",
            "description": "Pygmy Goat exfiltrates its result data over its C2 channel",
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack",
                    "phase_name": "exfiltration"
                }
            ],
            "external_references": [
                {
                    "source_name": "mitre-attack",
                    "url": "https://attack.mitre.org/techniques/T1041",
                    "external_id": "T1041"
                }
            ]
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--11e1658b-ff4e-4c35-a411-4f799963a303",
            "created_by_ref": "identity--1162c330-09ca-44f2-a4b5-f083919d61c4",
            "created": "2025-09-09T09:55:40.123022Z",
            "modified": "2025-09-09T09:55:40.123022Z",
            "relationship_type": "uses",
            "source_ref": "malware--4d9a54d9-a542-43c6-92a2-f25e332fad50",
            "target_ref": "attack-pattern--29a211d2-92d8-4eda-be33-5f1475fad52e"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--362ae58c-41a5-4d71-b219-f7c42ac7b478",
            "created_by_ref": "identity--1162c330-09ca-44f2-a4b5-f083919d61c4",
            "created": "2025-09-09T09:55:40.123234Z",
            "modified": "2025-09-09T09:55:40.123234Z",
            "relationship_type": "uses",
            "source_ref": "malware--4d9a54d9-a542-43c6-92a2-f25e332fad50",
            "target_ref": "attack-pattern--bb03f171-5c54-46fd-862b-743115da4d48"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--73fd23c2-64f8-45cf-ae1f-024ab4cfe215",
            "created_by_ref": "identity--1162c330-09ca-44f2-a4b5-f083919d61c4",
            "created": "2025-09-09T09:55:40.123413Z",
            "modified": "2025-09-09T09:55:40.123413Z",
            "relationship_type": "uses",
            "source_ref": "malware--4d9a54d9-a542-43c6-92a2-f25e332fad50",
            "target_ref": "attack-pattern--b2425ce1-2504-42f8-8006-66cc56cc12ea"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--3499276a-4bb7-4d30-8b5e-fddd71844187",
            "created_by_ref": "identity--1162c330-09ca-44f2-a4b5-f083919d61c4",
            "created": "2025-09-09T09:55:40.123635Z",
            "modified": "2025-09-09T09:55:40.123635Z",
            "relationship_type": "uses",
            "source_ref": "malware--4d9a54d9-a542-43c6-92a2-f25e332fad50",
            "target_ref": "attack-pattern--8de6ed53-e61c-41db-8f2d-f44741d48557"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--092d38c0-b58c-4052-9bb8-970214547c89",
            "created_by_ref": "identity--1162c330-09ca-44f2-a4b5-f083919d61c4",
            "created": "2025-09-09T09:55:40.123822Z",
            "modified": "2025-09-09T09:55:40.123822Z",
            "relationship_type": "uses",
            "source_ref": "malware--4d9a54d9-a542-43c6-92a2-f25e332fad50",
            "target_ref": "attack-pattern--86a87e20-5768-4353-bd69-4ce97179ac81"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--2b946dba-2443-41f3-86f3-7eabfc0df1d7",
            "created_by_ref": "identity--1162c330-09ca-44f2-a4b5-f083919d61c4",
            "created": "2025-09-09T09:55:40.124012Z",
            "modified": "2025-09-09T09:55:40.124012Z",
            "relationship_type": "uses",
            "source_ref": "malware--4d9a54d9-a542-43c6-92a2-f25e332fad50",
            "target_ref": "attack-pattern--e44b1925-4d01-4434-ac36-c09bbb213b79"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--0587249f-27ee-4d61-a029-f14d87e80ee1",
            "created_by_ref": "identity--1162c330-09ca-44f2-a4b5-f083919d61c4",
            "created": "2025-09-09T09:55:40.124191Z",
            "modified": "2025-09-09T09:55:40.124191Z",
            "relationship_type": "uses",
            "source_ref": "malware--4d9a54d9-a542-43c6-92a2-f25e332fad50",
            "target_ref": "attack-pattern--aaf62a8f-1665-4d74-bf3c-5fb955b0bded"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--48007271-2396-463c-9c1e-c07dfd47371a",
            "created_by_ref": "identity--1162c330-09ca-44f2-a4b5-f083919d61c4",
            "created": "2025-09-09T09:55:40.124358Z",
            "modified": "2025-09-09T09:55:40.124358Z",
            "relationship_type": "uses",
            "source_ref": "malware--4d9a54d9-a542-43c6-92a2-f25e332fad50",
            "target_ref": "attack-pattern--2c1647b4-2f1d-4f73-8ac1-5f492f9a1539"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--339dfbf5-9332-4ac9-a6c9-1a4e6bb4ef13",
            "created_by_ref": "identity--1162c330-09ca-44f2-a4b5-f083919d61c4",
            "created": "2025-09-09T09:55:40.124526Z",
            "modified": "2025-09-09T09:55:40.124526Z",
            "relationship_type": "uses",
            "source_ref": "malware--4d9a54d9-a542-43c6-92a2-f25e332fad50",
            "target_ref": "attack-pattern--2e0cd7ea-d882-45a5-a144-b57d0ca3c708"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--aea6487c-c078-4700-aa86-c9c9be250396",
            "created_by_ref": "identity--1162c330-09ca-44f2-a4b5-f083919d61c4",
            "created": "2025-09-09T09:55:40.124755Z",
            "modified": "2025-09-09T09:55:40.124755Z",
            "relationship_type": "uses",
            "source_ref": "malware--4d9a54d9-a542-43c6-92a2-f25e332fad50",
            "target_ref": "attack-pattern--85807d92-d2b9-4490-8cda-bdde3addf086"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--9ca34a99-1c2e-40e2-b387-19a849c79555",
            "created_by_ref": "identity--1162c330-09ca-44f2-a4b5-f083919d61c4",
            "created": "2025-09-09T09:55:40.124925Z",
            "modified": "2025-09-09T09:55:40.124925Z",
            "relationship_type": "uses",
            "source_ref": "malware--4d9a54d9-a542-43c6-92a2-f25e332fad50",
            "target_ref": "attack-pattern--bea94ebc-887c-4e2e-8a35-54be9d21bdde"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--fa57bb8f-7ea1-4cd1-b454-7c7902530980",
            "created_by_ref": "identity--1162c330-09ca-44f2-a4b5-f083919d61c4",
            "created": "2025-09-09T09:55:40.125096Z",
            "modified": "2025-09-09T09:55:40.125096Z",
            "relationship_type": "indicates",
            "source_ref": "indicator--67f22ea1-d506-4c2b-909a-5a2ddc6d8dbe",
            "target_ref": "malware--4d9a54d9-a542-43c6-92a2-f25e332fad50"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--21eebb7b-b126-4901-b216-9717d122f22f",
            "created_by_ref": "identity--1162c330-09ca-44f2-a4b5-f083919d61c4",
            "created": "2025-09-09T09:55:40.125262Z",
            "modified": "2025-09-09T09:55:40.125262Z",
            "relationship_type": "indicates",
            "source_ref": "indicator--7e0b52dd-f177-4b42-a513-dba6b9c67f4d",
            "target_ref": "malware--4d9a54d9-a542-43c6-92a2-f25e332fad50"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--098a1444-fcf3-4e20-8184-77f445b3a2c8",
            "created_by_ref": "identity--1162c330-09ca-44f2-a4b5-f083919d61c4",
            "created": "2025-09-09T09:55:40.125424Z",
            "modified": "2025-09-09T09:55:40.125424Z",
            "relationship_type": "indicates",
            "source_ref": "indicator--e4b9d855-3b46-41fd-a75a-de3699c2f25e",
            "target_ref": "malware--4d9a54d9-a542-43c6-92a2-f25e332fad50"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--5724d8bf-4571-4efa-9874-1450035aad10",
            "created_by_ref": "identity--1162c330-09ca-44f2-a4b5-f083919d61c4",
            "created": "2025-09-09T09:55:40.12562Z",
            "modified": "2025-09-09T09:55:40.12562Z",
            "relationship_type": "indicates",
            "source_ref": "indicator--afec19fc-958e-4378-bd7b-04224ad9ba8a",
            "target_ref": "malware--4d9a54d9-a542-43c6-92a2-f25e332fad50"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--0dafedec-d6e5-44a9-a19e-69d06d6cf5a8",
            "created_by_ref": "identity--1162c330-09ca-44f2-a4b5-f083919d61c4",
            "created": "2025-09-09T09:55:40.125868Z",
            "modified": "2025-09-09T09:55:40.125868Z",
            "relationship_type": "indicates",
            "source_ref": "indicator--3f7d415f-13bb-4e76-b7d4-6a0e698cf4ad",
            "target_ref": "malware--4d9a54d9-a542-43c6-92a2-f25e332fad50"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--6da9371a-f74c-4d6c-bd08-d5c0c7efe502",
            "created_by_ref": "identity--1162c330-09ca-44f2-a4b5-f083919d61c4",
            "created": "2025-09-09T09:55:40.126043Z",
            "modified": "2025-09-09T09:55:40.126043Z",
            "relationship_type": "indicates",
            "source_ref": "indicator--b89a9598-589d-4e5a-829b-8f7c8b27188f",
            "target_ref": "malware--4d9a54d9-a542-43c6-92a2-f25e332fad50"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--fcc18a66-16c7-42a2-911d-309b3eeedb29",
            "created_by_ref": "identity--1162c330-09ca-44f2-a4b5-f083919d61c4",
            "created": "2025-09-09T09:55:40.126207Z",
            "modified": "2025-09-09T09:55:40.126207Z",
            "relationship_type": "indicates",
            "source_ref": "indicator--5d7ba1dd-ae69-4b49-9cc1-141157b6ea49",
            "target_ref": "malware--4d9a54d9-a542-43c6-92a2-f25e332fad50"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--27980426-a257-4c81-89e8-ff90427e94d2",
            "created_by_ref": "identity--1162c330-09ca-44f2-a4b5-f083919d61c4",
            "created": "2025-09-09T09:55:40.126508Z",
            "modified": "2025-09-09T09:55:40.126508Z",
            "relationship_type": "indicates",
            "source_ref": "indicator--0c27168b-291c-464b-9b4f-f328ae0fa357",
            "target_ref": "malware--4d9a54d9-a542-43c6-92a2-f25e332fad50"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--310867b4-912e-468a-9969-f54afe13f792",
            "created_by_ref": "identity--1162c330-09ca-44f2-a4b5-f083919d61c4",
            "created": "2025-09-09T09:55:40.126986Z",
            "modified": "2025-09-09T09:55:40.126986Z",
            "relationship_type": "derived-from",
            "source_ref": "indicator--0c27168b-291c-464b-9b4f-f328ae0fa357",
            "target_ref": "indicator--e4b9d855-3b46-41fd-a75a-de3699c2f25e"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--c4ac07af-eaee-40e6-b9a2-98d730aff4ab",
            "created_by_ref": "identity--1162c330-09ca-44f2-a4b5-f083919d61c4",
            "created": "2025-09-09T09:55:40.127232Z",
            "modified": "2025-09-09T09:55:40.127232Z",
            "relationship_type": "indicates",
            "source_ref": "indicator--687dfff1-4c8e-4caf-a8d3-df3b61a5b8c0",
            "target_ref": "malware--4d9a54d9-a542-43c6-92a2-f25e332fad50"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--fbb76ac5-6329-4bf9-a114-c31c47c9b81a",
            "created_by_ref": "identity--1162c330-09ca-44f2-a4b5-f083919d61c4",
            "created": "2025-09-09T09:55:40.127424Z",
            "modified": "2025-09-09T09:55:40.127424Z",
            "relationship_type": "derived-from",
            "source_ref": "indicator--687dfff1-4c8e-4caf-a8d3-df3b61a5b8c0",
            "target_ref": "indicator--e4b9d855-3b46-41fd-a75a-de3699c2f25e"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--eb6998cc-fdbd-4df5-86a3-d240ca0a0bd7",
            "created_by_ref": "identity--1162c330-09ca-44f2-a4b5-f083919d61c4",
            "created": "2025-09-09T09:55:40.127679Z",
            "modified": "2025-09-09T09:55:40.127679Z",
            "relationship_type": "indicates",
            "source_ref": "indicator--42d7f7dd-032e-4a91-a0b4-dccc0c5afd85",
            "target_ref": "malware--4d9a54d9-a542-43c6-92a2-f25e332fad50"
        },
        {
            "type": "relationship",
            "spec_version": "2.1",
            "id": "relationship--4b7c8d23-6099-4e4e-a9bc-31a402a1524b",
            "created_by_ref": "identity--1162c330-09ca-44f2-a4b5-f083919d61c4",
            "created": "2025-09-09T09:55:40.127903Z",
            "modified": "2025-09-09T09:55:40.127903Z",
            "relationship_type": "derived-from",
            "source_ref": "indicator--42d7f7dd-032e-4a91-a0b4-dccc0c5afd85",
            "target_ref": "indicator--e4b9d855-3b46-41fd-a75a-de3699c2f25e"
        },
        {
            "type": "report",
            "spec_version": "2.1",
            "id": "report--96169fad-3c15-402a-a9a7-637cba5fc200",
            "created_by_ref": "identity--1162c330-09ca-44f2-a4b5-f083919d61c4",
            "created": "2025-09-09T09:55:40.128329Z",
            "modified": "2025-09-09T09:55:40.128329Z",
            "name": "Analisi Malware: Pygmy Goat",
            "description": "This report contains technical analysis and indicators associated with malware. pygmy goat.",
            "report_types": [
                "malware-analysis"
            ],
            "published": "2025-09-09T09:55:40.128315Z",
            "object_refs": [
                "identity--1162c330-09ca-44f2-a4b5-f083919d61c4",
                "mutex--3ef58740-1f43-51b5-8014-63f12621f42f",
                "indicator--67f22ea1-d506-4c2b-909a-5a2ddc6d8dbe",
                "indicator--7e0b52dd-f177-4b42-a513-dba6b9c67f4d",
                "indicator--e4b9d855-3b46-41fd-a75a-de3699c2f25e",
                "indicator--afec19fc-958e-4378-bd7b-04224ad9ba8a",
                "indicator--3f7d415f-13bb-4e76-b7d4-6a0e698cf4ad",
                "indicator--b89a9598-589d-4e5a-829b-8f7c8b27188f",
                "indicator--5d7ba1dd-ae69-4b49-9cc1-141157b6ea49",
                "relationship--b79872e1-130f-497f-9976-4c541ab9b375",
                "relationship--7d41ef8e-c2a5-4e00-b587-0ba852b0444c",
                "relationship--6e7cac20-2e37-489c-a2b0-08f7bfd5bc47",
                "relationship--1e0eb0fd-d6b3-4dc8-ad49-ba9062264ade",
                "relationship--6b54fc5c-8e57-433b-b7bf-56ea23260fda",
                "relationship--541b5967-a55f-41b9-9564-6ba0d1c7ee1e",
                "relationship--a61ec850-2704-434b-92a6-c08fce462583",
                "malware--4d9a54d9-a542-43c6-92a2-f25e332fad50",
                "malware--ed0edd54-f19f-4607-94cd-0d0e5568925b",
                "identity--73f71934-ce90-4457-b87f-6c696fb1ba14",
                "identity--57ad8018-8644-437b-9cec-2f2fc7bfcd09",
                "identity--fd3e8b65-89eb-4426-bfb3-16bf13ea5582",
                "identity--57ece42e-6ae6-4666-aa3f-a26284b13373",
                "indicator--0c27168b-291c-464b-9b4f-f328ae0fa357",
                "indicator--687dfff1-4c8e-4caf-a8d3-df3b61a5b8c0",
                "indicator--42d7f7dd-032e-4a91-a0b4-dccc0c5afd85",
                "attack-pattern--29a211d2-92d8-4eda-be33-5f1475fad52e",
                "attack-pattern--bb03f171-5c54-46fd-862b-743115da4d48",
                "attack-pattern--b2425ce1-2504-42f8-8006-66cc56cc12ea",
                "attack-pattern--8de6ed53-e61c-41db-8f2d-f44741d48557",
                "attack-pattern--86a87e20-5768-4353-bd69-4ce97179ac81",
                "attack-pattern--e44b1925-4d01-4434-ac36-c09bbb213b79",
                "attack-pattern--aaf62a8f-1665-4d74-bf3c-5fb955b0bded",
                "attack-pattern--2c1647b4-2f1d-4f73-8ac1-5f492f9a1539",
                "attack-pattern--2e0cd7ea-d882-45a5-a144-b57d0ca3c708",
                "attack-pattern--85807d92-d2b9-4490-8cda-bdde3addf086",
                "attack-pattern--bea94ebc-887c-4e2e-8a35-54be9d21bdde",
                "relationship--11e1658b-ff4e-4c35-a411-4f799963a303",
                "relationship--362ae58c-41a5-4d71-b219-f7c42ac7b478",
                "relationship--73fd23c2-64f8-45cf-ae1f-024ab4cfe215",
                "relationship--3499276a-4bb7-4d30-8b5e-fddd71844187",
                "relationship--092d38c0-b58c-4052-9bb8-970214547c89",
                "relationship--2b946dba-2443-41f3-86f3-7eabfc0df1d7",
                "relationship--0587249f-27ee-4d61-a029-f14d87e80ee1",
                "relationship--48007271-2396-463c-9c1e-c07dfd47371a",
                "relationship--339dfbf5-9332-4ac9-a6c9-1a4e6bb4ef13",
                "relationship--aea6487c-c078-4700-aa86-c9c9be250396",
                "relationship--9ca34a99-1c2e-40e2-b387-19a849c79555",
                "relationship--fa57bb8f-7ea1-4cd1-b454-7c7902530980",
                "relationship--21eebb7b-b126-4901-b216-9717d122f22f",
                "relationship--098a1444-fcf3-4e20-8184-77f445b3a2c8",
                "relationship--5724d8bf-4571-4efa-9874-1450035aad10",
                "relationship--0dafedec-d6e5-44a9-a19e-69d06d6cf5a8",
                "relationship--6da9371a-f74c-4d6c-bd08-d5c0c7efe502",
                "relationship--fcc18a66-16c7-42a2-911d-309b3eeedb29",
                "relationship--27980426-a257-4c81-89e8-ff90427e94d2",
                "relationship--310867b4-912e-468a-9969-f54afe13f792",
                "relationship--c4ac07af-eaee-40e6-b9a2-98d730aff4ab",
                "relationship--fbb76ac5-6329-4bf9-a114-c31c47c9b81a",
                "relationship--eb6998cc-fdbd-4df5-86a3-d240ca0a0bd7",
                "relationship--4b7c8d23-6099-4e4e-a9bc-31a402a1524b"
            ],
            "object_marking_refs": [
                "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"
            ]
        }
    ]
}