{
    "type": "bundle",
    "id": "bundle--5708c434-a3f3-4e73-805a-7cf6fea411ed",
    "objects": [
        {
            "type": "malware",
            "id": "malware--db545202-7a39-4ea0-9c92-ed944752cd11",
            "name": "Goofy Guineapig",
            "description": "Goofy Guineapig is a persistent Windows backdoor distributed as a trojanised NSIS Firefox installer, masquerading as a Google update component. It maintains persistence as a Windows service, supports multiple communication methods (HTTPS, HTTP, KCP/UDP, and raw TCP), uses embedded configuration, and implements various defense evasion techniques such as masquerading, anti-analysis, and sandbox detection. It enables plugin loading, system information collection, exfiltration, and process hollowing.",
            "created": "2022-12-13T00:00:00Z",
            "modified": "2022-12-13T00:00:00Z",
            "is_family": "true",
            "labels": [
                "backdoor",
                "trojan",
                "windows",
                "upx-packed",
                "loader",
                "defense-evasion"
            ],
            "malware_types": [
                "backdoor"
            ],
            "architecture_execution_envs": [
                "x86-32"
            ],
            "operating_system_refs": [
                "windows"
            ],
            "external_references": [
                {
                    "source_name": "NCSC Goofy Guineapig Malware Analysis",
                    "description": "Malware Analysis Report Version 1.0, UK NCSC, 2022-12-13"
                }
            ]
        },
        {
            "type": "infrastructure",
            "id": "infrastructure--e3717c9c-7ad8-45e9-85e5-efd8f9dbe827",
            "name": "Goofy Guineapig C2 Infrastructure",
            "description": "Command and control infrastructure used by Goofy Guineapig malware, operating over HTTPS (port 4443) with fallback to HTTP, UDP (KCP), or raw TCP socket communications.",
            "created": "2022-12-13T00:00:00Z",
            "modified": "2022-12-13T00:00:00Z",
            "infrastructure_types": [
                "command-and-control"
            ],
            "aliases": [
                "static.tcplog.com"
            ],
            "external_references": [
                {
                    "source_name": "NCSC Goofy Guineapig Malware Analysis",
                    "description": "Malware Analysis Report Version 1.0, UK NCSC, 2022-12-13"
                }
            ]
        },
        {
            "type": "indicator",
            "id": "indicator--d5c59cb6-0e8c-49f6-bead-719a25f85e76",
            "labels": [
                "domain",
                "c2"
            ],
            "pattern": "[domain-name:value = 'static.tcplog.com']",
            "valid_from": "2022-12-13T00:00:00Z",
            "created": "2022-12-13T00:00:00Z",
            "modified": "2022-12-13T00:00:00Z",
            "description": "Goofy Guineapig C2 domain.",
            "external_references": [
                {
                    "source_name": "NCSC Goofy Guineapig Malware Analysis",
                    "description": "Malware Analysis Report Version 1.0, UK NCSC, 2022-12-13"
                }
            ]
        },
        {
            "type": "indicator",
            "id": "indicator--033ea113-2833-4bff-8d45-fa56488f56cd",
            "labels": [
                "file",
                "malicious-batch"
            ],
            "pattern": "[file:path = 'C:\\\\ProgramData\\\\GoogleUpdate\\\\GoogleUpdate\\\\tmp.bat']",
            "valid_from": "2022-12-13T00:00:00Z",
            "created": "2022-12-13T00:00:00Z",
            "modified": "2022-12-13T00:00:00Z",
            "description": "Malicious batch file created and executed by Goofy Guineapig.",
            "external_references": [
                {
                    "source_name": "NCSC Goofy Guineapig Malware Analysis",
                    "description": "Malware Analysis Report Version 1.0, UK NCSC, 2022-12-13"
                }
            ]
        },
        {
            "type": "indicator",
            "id": "indicator--d8f8d76a-d80f-462a-8385-00afdef0918a",
            "labels": [
                "user-agent",
                "malware"
            ],
            "pattern": "[network-traffic:user_agent = 'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/54.0.2840.71 Safari/537.36']",
            "valid_from": "2022-12-13T00:00:00Z",
            "created": "2022-12-13T00:00:00Z",
            "modified": "2022-12-13T00:00:00Z",
            "description": "Hard coded Goofy Guineapig User Agent string.",
            "external_references": [
                {
                    "source_name": "NCSC Goofy Guineapig Malware Analysis",
                    "description": "Malware Analysis Report Version 1.0, UK NCSC, 2022-12-13"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "id": "attack-pattern--2e2d05c5-cd7d-4371-a40f-5b03b6b3cdfc",
            "name": "Create or Modify System Process: Windows Service",
            "description": "Goofy Guineapig maintains persistence as a Windows service named 'GoogleUpdate' with auto start, executing the malware via rundll32.exe and url.dll.",
            "created": "2022-12-13T00:00:00Z",
            "modified": "2022-12-13T00:00:00Z",
            "external_references": [
                {
                    "source_name": "mitre-attack",
                    "external_id": "T1543.003",
                    "url": "https://attack.mitre.org/techniques/T1543/003/"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "id": "attack-pattern--e8fe1d27-c147-4600-b3da-3281fd2ff5a0",
            "name": "Masquerading: Match Legitimate Name or Location",
            "description": "Goofy Guineapig masquerades as a Firefox installer and Google updater.",
            "created": "2022-12-13T00:00:00Z",
            "modified": "2022-12-13T00:00:00Z",
            "external_references": [
                {
                    "source_name": "mitre-attack",
                    "external_id": "T1036.005",
                    "url": "https://attack.mitre.org/techniques/T1036/005/"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "id": "attack-pattern--b04ff78c-88eb-4c5b-b48b-2400086e2c13",
            "name": "Process Injection: Process Hollowing",
            "description": "Goofy Guineapig can perform process hollowing on the dllhost.exe binary, injecting content downloaded by the C2.",
            "created": "2022-12-13T00:00:00Z",
            "modified": "2022-12-13T00:00:00Z",
            "external_references": [
                {
                    "source_name": "mitre-attack",
                    "external_id": "T1055.012",
                    "url": "https://attack.mitre.org/techniques/T1055/012/"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "id": "attack-pattern--c671acb4-ff7a-4dad-9735-34849475f00b",
            "name": "System Binary Proxy Execution: Rundll32",
            "description": "Goofy Guineapig persistence mechanism utilises rundll32.exe and url.dll to execute the legitimate binary which will load the malicious DLL.",
            "created": "2022-12-13T00:00:00Z",
            "modified": "2022-12-13T00:00:00Z",
            "external_references": [
                {
                    "source_name": "mitre-attack",
                    "external_id": "T1218.011",
                    "url": "https://attack.mitre.org/techniques/T1218/011/"
                }
            ]
        },
        {
            "type": "attack-pattern",
            "id": "attack-pattern--6194a88a-4e52-4579-a9fb-ce4a96c9b939",
            "name": "Application Layer Protocol: Web Protocols",
            "description": "Goofy Guineapig uses HTTPS for its C2 communications, with fallback to HTTP, UDP/KCP, or raw TCP based on configuration.",
            "created": "2022-12-13T00:00:00Z",
            "modified": "2022-12-13T00:00:00Z",
            "external_references": [
                {
                    "source_name": "mitre-attack",
                    "external_id": "T1071.001",
                    "url": "https://attack.mitre.org/techniques/T1071/001/"
                }
            ]
        },
        {
            "type": "file",
            "id": "file--4a61c595-deae-47f3-83ae-d9b6cdbf9ea5",
            "name": "Firefox-latest.exe",
            "size": 505864,
            "hashes": {
                "MD5": "a21dec89611368313e138480b3c94835",
                "SHA-1": "2b8aab068ef15cb05789da320b7099932a0a4166",
                "SHA-256": "19cef7f32e42cc674f7c76be3a5c691c543f4e018486c29153e7dde1a48af34c"
            }
        },
        {
            "type": "file",
            "id": "file--b094da98-9629-463a-ab58-724249d5f784",
            "name": "setup-stub.exe",
            "size": 840048,
            "hashes": {
                "MD5": "180e0bb4b570c215bfe7abdf209402aa",
                "SHA-1": "6f5c07c50ce4976ddb3879ce65d3b2f96693dc4c",
                "SHA-256": "97f66bcdd73917a8b59d9a1dcac21a58936bcaf91e757a9dfb8e5c320af40f56"
            }
        },
        {
            "type": "file",
            "id": "file--248d4cbc-aaca-4fa9-b927-d9154b752ccd",
            "name": "Goopdate.dll",
            "size": 88064,
            "hashes": {
                "MD5": "f98537517212068d0c57968876fc8204",
                "SHA-1": "7961930d13cb8d5056db64b6749356915fb4c272",
                "SHA-256": "12a29373c1f493f7757b755099bde4770c310af3fde376176b6d792cd1c5e150"
            }
        },
        {
            "type": "file",
            "id": "file--71b3d6f0-2045-420a-8a31-1cb2f6602fe6",
            "name": "Config.dat",
            "size": 131354,
            "hashes": {
                "MD5": "3dc1096e73db4886fb66ed9413ca994c",
                "SHA-1": "628ce6721b97fa12590356712fbfc5ae030781ce",
                "SHA-256": "3a1af09a0250c602569d458e79db90a45e305b76d8423b81eeca14c69847b81c"
            }
        },
        {
            "type": "file",
            "id": "file--4083c68f-47cf-4ded-849e-02c1dd43525b",
            "name": "Decoded shellcode from config.dat",
            "size": 131328,
            "hashes": {
                "MD5": "06e1992e6c52af33117d142bdbeef74d",
                "SHA-1": "231ac2c5f3c9a833836be65f7443e3525eb1e7a3",
                "SHA-256": "13c27a686f863a388cbc40661e6fda602ab14af9454421b08229cadb54d7b000"
            }
        },
        {
            "type": "file",
            "id": "file--a4d9c035-af90-48b1-8ad7-5e53c4c8208c",
            "name": "Decoded binary extracted from shellcode",
            "size": 129536,
            "hashes": {
                "MD5": "abbe7d13b13ea4315543bdad187f14b3",
                "SHA-1": "11b82826ec01aeec44e5e2504935b6aaccf51cac",
                "SHA-256": "4ffc7f65e16ce59ff9e6a504f88e0cf56b225c0eb2cf8ec578b3e9d40d9bd898"
            }
        },
        {
            "type": "file",
            "id": "file--0d728faf-dd4e-4d91-8a87-aa8eaf08d323",
            "name": "GoogleUpdate.exe",
            "parent_directory_ref": "directory--44d71e25-3b4f-4346-8a3b-65b8b5a7c1c3"
        },
        {
            "type": "directory",
            "id": "directory--f1cc0ca4-d133-400a-8ca0-374a132bd571",
            "path": "C:\\ProgramData\\GoogleUpdate"
        },
        {
            "type": "directory",
            "id": "directory--fd71a23f-ab54-48ad-a299-0fca829c2809",
            "path": "C:\\ProgramData\\GoogleUpdate\\GoogleUpdate"
        },
        {
            "type": "file",
            "id": "file--b7b784c6-0c3c-4a85-bc22-65ab24f779a2",
            "name": "tmp.bat",
            "parent_directory_ref": "directory--7f5e1fd7-c2d9-4c9c-8b30-6e8e9c0781f6"
        },
        {
            "type": "domain-name",
            "id": "domain-name--f7e7909f-7753-4874-b846-d388575b9643",
            "value": "static.tcplog.com"
        },
        {
            "type": "url",
            "id": "url--07fd0238-419a-4785-8b4b-a44abc25be9e",
            "value": "https://static.tcplog.com:4443/"
        },
        {
            "type": "mutex",
            "id": "mutex--eebc038e-170b-4116-b116-4282d2a472e7",
            "name": "MD5(MD5(MD5(MD5(ComputerName))))"
        },
        {
            "type": "software",
            "id": "software--ce5cd02a-343f-4614-b669-8fb02488c85a",
            "name": "Goofy Guineapig"
        },
        {
            "type": "software",
            "id": "software--1ff19685-fd68-4395-b2a4-522c02f5fa5b",
            "name": "GoogleUpdate.exe"
        },
        {
            "type": "software",
            "id": "software--d287351d-1501-4269-a317-f9511394eeaa",
            "name": "dllhost.exe"
        },
        {
            "type": "process",
            "id": "process--dd2e23e7-43e7-41bd-9851-432e81d09c2d",
            "command_line": "C:\\windows\\system32\\cmd.exe /c C:\\windows\\system32\\rundll32.exe url.dll,FileProtocolHandler C:\\ProgramData\\GoogleUpdate\\GoogleUpdate.exe"
        },
        {
            "type": "user-account",
            "id": "user-account--e079dc90-bded-49ce-8925-636146002c39",
            "user_id": "user"
        },
        {
            "type": "process",
            "id": "process--722d5716-feb5-4351-bd40-7abddcb7fa3b",
            "command_line": "cmd /c call C:\\<path>\\tmp.bat"
        },
        {
            "type": "file",
            "id": "file--276fed3c-0a0c-426d-8757-162b3c28a1d7",
            "name": "url.dll"
        },
        {
            "type": "file",
            "id": "file--f089afde-fedc-4a1b-aaf5-ec42e80ffc6d",
            "name": "rundll32.exe"
        },
        {
            "type": "relationship",
            "id": "relationship--75ce3359-2964-405d-be9b-5986695319dd",
            "relationship_type": "uses",
            "created": "2022-12-13T00:00:00Z",
            "modified": "2022-12-13T00:00:00Z",
            "source_ref": "malware--db545202-7a39-4ea0-9c92-ed944752cd11",
            "target_ref": "infrastructure--e3717c9c-7ad8-45e9-85e5-efd8f9dbe827",
            "description": "Goofy Guineapig malware uses command and control infrastructure for C2 communications."
        },
        {
            "type": "relationship",
            "id": "relationship--752f6b5d-f60a-46db-8872-73e45b8577f3",
            "relationship_type": "communicates-with",
            "created": "2022-12-13T00:00:00Z",
            "modified": "2022-12-13T00:00:00Z",
            "source_ref": "malware--db545202-7a39-4ea0-9c92-ed944752cd11",
            "target_ref": "domain-name--f7e7909f-7753-4874-b846-d388575b9643",
            "description": "Goofy Guineapig communicates with the C2 domain static.tcplog.com."
        },
        {
            "type": "relationship",
            "id": "relationship--50d4e4c4-4712-4f39-9a89-48ba5a2307d4",
            "relationship_type": "communicates-with",
            "created": "2022-12-13T00:00:00Z",
            "modified": "2022-12-13T00:00:00Z",
            "source_ref": "malware--db545202-7a39-4ea0-9c92-ed944752cd11",
            "target_ref": "url--07fd0238-419a-4785-8b4b-a44abc25be9e",
            "description": "Goofy Guineapig communicates with C2 over HTTPS using https://static.tcplog.com:4443/."
        },
        {
            "type": "relationship",
            "id": "relationship--9719d1bb-f661-4db5-a80a-20b662103bbc",
            "relationship_type": "drops",
            "created": "2022-12-13T00:00:00Z",
            "modified": "2022-12-13T00:00:00Z",
            "source_ref": "malware--db545202-7a39-4ea0-9c92-ed944752cd11",
            "target_ref": "file--248d4cbc-aaca-4fa9-b927-d9154b752ccd",
            "description": "Goofy Guineapig drops Goopdate.dll, the malicious DLL."
        },
        {
            "type": "relationship",
            "id": "relationship--c733f513-7333-46ac-aa7f-900d1ba11519",
            "relationship_type": "drops",
            "created": "2022-12-13T00:00:00Z",
            "modified": "2022-12-13T00:00:00Z",
            "source_ref": "malware--db545202-7a39-4ea0-9c92-ed944752cd11",
            "target_ref": "file--b094da98-9629-463a-ab58-724249d5f784",
            "description": "Goofy Guineapig drops setup-stub.exe, the trojanised NSIS installer."
        },
        {
            "type": "relationship",
            "id": "relationship--f19584c5-84a8-4e90-83ce-55a33dd2834c",
            "relationship_type": "drops",
            "created": "2022-12-13T00:00:00Z",
            "modified": "2022-12-13T00:00:00Z",
            "source_ref": "malware--db545202-7a39-4ea0-9c92-ed944752cd11",
            "target_ref": "file--71b3d6f0-2045-420a-8a31-1cb2f6602fe6",
            "description": "Goofy Guineapig drops Config.dat, an encoded shellcode file."
        },
        {
            "type": "relationship",
            "id": "relationship--fc282305-cb9d-4095-8db4-d569aaf0b658",
            "relationship_type": "drops",
            "created": "2022-12-13T00:00:00Z",
            "modified": "2022-12-13T00:00:00Z",
            "source_ref": "malware--db545202-7a39-4ea0-9c92-ed944752cd11",
            "target_ref": "file--4083c68f-47cf-4ded-849e-02c1dd43525b",
            "description": "Goofy Guineapig decodes and loads shellcode from Config.dat."
        },
        {
            "type": "relationship",
            "id": "relationship--a50a41c1-03a5-4832-b544-7c16c67b2e6d",
            "relationship_type": "drops",
            "created": "2022-12-13T00:00:00Z",
            "modified": "2022-12-13T00:00:00Z",
            "source_ref": "malware--db545202-7a39-4ea0-9c92-ed944752cd11",
            "target_ref": "file--a4d9c035-af90-48b1-8ad7-5e53c4c8208c",
            "description": "Goofy Guineapig decodes and loads binary from shellcode."
        },
        {
            "type": "relationship",
            "id": "relationship--854f6217-29ab-4a0f-a8b6-abd13a6758bc",
            "relationship_type": "drops",
            "created": "2022-12-13T00:00:00Z",
            "modified": "2022-12-13T00:00:00Z",
            "source_ref": "malware--db545202-7a39-4ea0-9c92-ed944752cd11",
            "target_ref": "file--b7b784c6-0c3c-4a85-bc22-65ab24f779a2",
            "description": "Goofy Guineapig creates temp.bat for installation/persistence tasks."
        },
        {
            "type": "relationship",
            "id": "relationship--12a62503-8575-4056-8c5e-3736803237da",
            "relationship_type": "uses",
            "created": "2022-12-13T00:00:00Z",
            "modified": "2022-12-13T00:00:00Z",
            "source_ref": "malware--db545202-7a39-4ea0-9c92-ed944752cd11",
            "target_ref": "software--1ff19685-fd68-4395-b2a4-522c02f5fa5b",
            "description": "Goofy Guineapig uses GoogleUpdate.exe for DLL sideloading and persistence."
        },
        {
            "type": "relationship",
            "id": "relationship--41cb5e8b-8b85-47f5-a852-8ff5df20d198",
            "relationship_type": "uses",
            "created": "2022-12-13T00:00:00Z",
            "modified": "2022-12-13T00:00:00Z",
            "source_ref": "malware--db545202-7a39-4ea0-9c92-ed944752cd11",
            "target_ref": "file--276fed3c-0a0c-426d-8757-162b3c28a1d7",
            "description": "Goofy Guineapig persistence leverages legitimate url.dll via rundll32.exe."
        },
        {
            "type": "relationship",
            "id": "relationship--3581a19d-36d5-400f-9c07-2998a25f988d",
            "relationship_type": "uses",
            "created": "2022-12-13T00:00:00Z",
            "modified": "2022-12-13T00:00:00Z",
            "source_ref": "malware--db545202-7a39-4ea0-9c92-ed944752cd11",
            "target_ref": "file--f089afde-fedc-4a1b-aaf5-ec42e80ffc6d",
            "description": "Goofy Guineapig persistence leverages rundll32.exe for execution."
        },
        {
            "type": "relationship",
            "id": "relationship--f14d3b60-0dd4-4633-977c-fdf0e5726ca1",
            "relationship_type": "uses",
            "created": "2022-12-13T00:00:00Z",
            "modified": "2022-12-13T00:00:00Z",
            "source_ref": "malware--db545202-7a39-4ea0-9c92-ed944752cd11",
            "target_ref": "software--d287351d-1501-4269-a317-f9511394eeaa",
            "description": "Goofy Guineapig can hollow dllhost.exe for execution of payloads."
        },
        {
            "type": "relationship",
            "id": "relationship--8b2c351a-7add-4bf9-a5b2-7c4ef4449a9f",
            "relationship_type": "uses",
            "created": "2022-12-13T00:00:00Z",
            "modified": "2022-12-13T00:00:00Z",
            "source_ref": "malware--db545202-7a39-4ea0-9c92-ed944752cd11",
            "target_ref": "mutex--eebc038e-170b-4116-b116-4282d2a472e7",
            "description": "Goofy Guineapig creates a mutex based on MD5 hashes of computer name for single-instance execution."
        },
        {
            "type": "relationship",
            "id": "relationship--f95b2c29-5694-41fb-8e0b-826670845830",
            "relationship_type": "located-at",
            "created": "2022-12-13T00:00:00Z",
            "modified": "2022-12-13T00:00:00Z",
            "source_ref": "file--248d4cbc-aaca-4fa9-b927-d9154b752ccd",
            "target_ref": "directory--f1cc0ca4-d133-400a-8ca0-374a132bd571",
            "description": "Goopdate.dll is located in C:\\ProgramData\\GoogleUpdate."
        },
        {
            "type": "relationship",
            "id": "relationship--25d0854a-e287-4732-b2ed-c5c1c6b25c36",
            "relationship_type": "located-at",
            "created": "2022-12-13T00:00:00Z",
            "modified": "2022-12-13T00:00:00Z",
            "source_ref": "file--0d728faf-dd4e-4d91-8a87-aa8eaf08d323",
            "target_ref": "directory--f1cc0ca4-d133-400a-8ca0-374a132bd571",
            "description": "GoogleUpdate.exe is located in C:\\ProgramData\\GoogleUpdate."
        },
        {
            "type": "relationship",
            "id": "relationship--7b443a34-7eff-4289-a626-ee944fbe6bad",
            "relationship_type": "located-at",
            "created": "2022-12-13T00:00:00Z",
            "modified": "2022-12-13T00:00:00Z",
            "source_ref": "file--b7b784c6-0c3c-4a85-bc22-65ab24f779a2",
            "target_ref": "directory--fd71a23f-ab54-48ad-a299-0fca829c2809",
            "description": "tmp.bat is located in C:\\ProgramData\\GoogleUpdate\\GoogleUpdate."
        },
        {
            "type": "relationship",
            "id": "relationship--d86c35c5-192b-438a-b368-6557aaf30964",
            "relationship_type": "uses",
            "created": "2022-12-13T00:00:00Z",
            "modified": "2022-12-13T00:00:00Z",
            "source_ref": "malware--db545202-7a39-4ea0-9c92-ed944752cd11",
            "target_ref": "process--dd2e23e7-43e7-41bd-9851-432e81d09c2d",
            "description": "Goofy Guineapig persists using Windows service executing GoogleUpdate.exe via rundll32.exe and url.dll."
        },
        {
            "type": "relationship",
            "id": "relationship--fff99c51-96ff-4583-8031-2a2d8c52bb1b",
            "relationship_type": "uses",
            "created": "2022-12-13T00:00:00Z",
            "modified": "2022-12-13T00:00:00Z",
            "source_ref": "malware--db545202-7a39-4ea0-9c92-ed944752cd11",
            "target_ref": "process--722d5716-feb5-4351-bd40-7abddcb7fa3b",
            "description": "Goofy Guineapig executes commands via cmd calling tmp.bat for installation and cleanup tasks."
        },
        {
            "type": "relationship",
            "id": "relationship--61cadab6-b5bc-4eb3-a775-391cae6f5717",
            "relationship_type": "uses",
            "created": "2022-12-13T00:00:00Z",
            "modified": "2022-12-13T00:00:00Z",
            "source_ref": "malware--db545202-7a39-4ea0-9c92-ed944752cd11",
            "target_ref": "user-account--e079dc90-bded-49ce-8925-636146002c39",
            "description": "Goofy Guineapig collects and processes user account information from the infected host."
        }
    ]
}